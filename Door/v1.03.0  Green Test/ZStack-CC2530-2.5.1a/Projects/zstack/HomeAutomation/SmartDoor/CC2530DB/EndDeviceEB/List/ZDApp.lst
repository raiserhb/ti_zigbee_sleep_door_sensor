###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         08/Aug/2017  09:57:15 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\work space\Smart Product\Two YHY\Door\v1.03.0   #
#                          Green\ZStack-CC2530-2.5.1a\COMPONENTS\stack\zdo\ZD #
#                          App.c                                              #
#    Command line       =  -f "D:\work space\Smart Product\Two                #
#                          YHY\Door\v1.03.0  Green\ZStack-CC2530-2.5.1a\Proje #
#                          cts\zstack\HomeAutomation\SmartDoor\CC2530DB\..\To #
#                          ols\CC2530DB\f8wEndev.cfg" (-DCPU32MHZ             #
#                          -DROOT=__near_func -DMAC_CFG_TX_DATA_MAX=3         #
#                          -DMAC_CFG_TX_MAX=6 -DMAC_CFG_RX_MAX=3              #
#                          -DHAL_KEY=FALSE -DHAL_LED=FALSE -DHAL_LCD=FALSE    #
#                          -DHAL_ADC=FALSE -DNV_RESTORE -DNV_INIT             #
#                          -DPOWER_SAVING -DTC_LINKKEY_JOIN) -f "D:\work      #
#                          space\Smart Product\Two YHY\Door\v1.03.0           #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\Tools\CC2530DB\f8wCo #
#                          nfig.cfg" (-DZIGBEEPRO -DSECURE=1                  #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x06108800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4                        #
#                          -DDEFAULT_KEY={0x58,0x69,0x6E,0x67,0x48,0x75,0x6F, #
#                          0x59,0x75,0x61,0x6E,0x53,0x6D,0x61,0x72,0x74}      #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=0           #
#                          -DQUEUED_POLL_RATE=0 -DRESPONSE_POLL_RATE=0        #
#                          -DREJOIN_POLL_RATE=440) -f "D:\work space\Smart    #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\Tools\CC2530DB\f8wZC #
#                          L.cfg" (-DZCL_READ -DZCL_WRITE -DZCL_REPORT        #
#                          -DZCL_BASIC -DZCL_IDENTIFY -DZCL_ON_OFF            #
#                          -DZCL_KEY_ESTABLISH -DZCL_KEY_ESTABLISHMENT_KEY_GE #
#                          NERATE_TIMEOUT=4 -DZCL_KEY_ESTABLISHMENT_MAC_GENER #
#                          ATE_TIMEOUT=10 -DZCL_KEY_ESTABLISHMENT_EKEY_GENERA #
#                          TE_TIMEOUT=10 -DZCL_LOAD_CONTROL                   #
#                          -DZCL_SIMPLE_METERING -DZCL_PRICING -DZCL_MESSAGE  #
#                          -DZCL_TUNNELING -DZCL_TOU) -DZCL_DEVICE_MGMT       #
#                          "D:\work space\Smart Product\Two YHY\Door\v1.03.0  #
#                           Green\ZStack-CC2530-2.5.1a\COMPONENTS\stack\zdo\Z #
#                          DApp.c" -lC "D:\work space\Smart Product\Two       #
#                          YHY\Door\v1.03.0  Green\ZStack-CC2530-2.5.1a\Proje #
#                          cts\zstack\HomeAutomation\SmartDoor\CC2530DB\EndDe #
#                          viceEB\List\" -lA "D:\work space\Smart             #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\EndDeviceEB\List\"      #
#                          --diag_suppress Pe001,Pa010 -o "D:\work            #
#                          space\Smart Product\Two YHY\Door\v1.03.0           #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\EndDeviceEB\Obj\" -e    #
#                          --debug --core=plain --dptr=16,1                   #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I "D:\work space\Smart Product\Two                #
#                          YHY\Door\v1.03.0  Green\ZStack-CC2530-2.5.1a\Proje #
#                          cts\zstack\HomeAutomation\SmartDoor\CC2530DB\" -I  #
#                          "D:\work space\Smart Product\Two YHY\Door\v1.03.0  #
#                           Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAu #
#                          tomation\SmartDoor\CC2530DB\..\Source\" -I         #
#                          "D:\work space\Smart Product\Two YHY\Door\v1.03.0  #
#                           Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAu #
#                          tomation\SmartDoor\CC2530DB\..\..\Source\" -I      #
#                          "D:\work space\Smart Product\Two YHY\Door\v1.03.0  #
#                           Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAu #
#                          tomation\SmartDoor\CC2530DB\..\..\..\ZMain\TI2530D #
#                          B\" -I "D:\work space\Smart Product\Two            #
#                          YHY\Door\v1.03.0  Green\ZStack-CC2530-2.5.1a\Proje #
#                          cts\zstack\HomeAutomation\SmartDoor\CC2530DB\..\.. #
#                          \..\..\..\Components\hal\include\" -I "D:\work     #
#                          space\Smart Product\Two YHY\Door\v1.03.0           #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\hal\target\CC2530EB\" -I "D:\work space\Smart   #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\mac\include\" -I "D:\work space\Smart           #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\mac\high_level\" -I "D:\work space\Smart        #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\mac\low_level\srf04\" -I "D:\work space\Smart   #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\mac\low_level\srf04\single_chip\" -I "D:\work   #
#                          space\Smart Product\Two YHY\Door\v1.03.0           #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\mt\" -I "D:\work space\Smart Product\Two        #
#                          YHY\Door\v1.03.0  Green\ZStack-CC2530-2.5.1a\Proje #
#                          cts\zstack\HomeAutomation\SmartDoor\CC2530DB\..\.. #
#                          \..\..\..\Components\osal\include\" -I "D:\work    #
#                          space\Smart Product\Two YHY\Door\v1.03.0           #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\services\saddr\" -I "D:\work space\Smart        #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\services\sdata\" -I "D:\work space\Smart        #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\stack\af\" -I "D:\work space\Smart Product\Two  #
#                          YHY\Door\v1.03.0  Green\ZStack-CC2530-2.5.1a\Proje #
#                          cts\zstack\HomeAutomation\SmartDoor\CC2530DB\..\.. #
#                          \..\..\..\Components\stack\nwk\" -I "D:\work       #
#                          space\Smart Product\Two YHY\Door\v1.03.0           #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\stack\sapi\" -I "D:\work space\Smart            #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\stack\sec\" -I "D:\work space\Smart             #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\stack\sys\" -I "D:\work space\Smart             #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\stack\zcl\" -I "D:\work space\Smart             #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\stack\zdo\" -I "D:\work space\Smart             #
#                          Product\Two YHY\Door\v1.03.0                       #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\..\..\..\..\..\Componen #
#                          ts\zmac\" -I "D:\work space\Smart Product\Two      #
#                          YHY\Door\v1.03.0  Green\ZStack-CC2530-2.5.1a\Proje #
#                          cts\zstack\HomeAutomation\SmartDoor\CC2530DB\..\.. #
#                          \..\..\..\Components\zmac\f8w\" -Oh                #
#                          --require_prototypes                               #
#    List file          =  D:\work space\Smart Product\Two YHY\Door\v1.03.0   #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\EndDeviceEB\List\ZDApp. #
#                          lst                                                #
#    Object file        =  D:\work space\Smart Product\Two YHY\Door\v1.03.0   #
#                          Green\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAut #
#                          omation\SmartDoor\CC2530DB\EndDeviceEB\Obj\ZDApp.r #
#                          51                                                 #
#                                                                             #
#                                                                             #
###############################################################################

D:\work space\Smart Product\Two YHY\Door\v1.03.0  Green\ZStack-CC2530-2.5.1a\COMPONENTS\stack\zdo\ZDApp.c
      1          /**************************************************************************************************
      2            Filename:       ZDApp.c
      3            Revised:        $Date: 2012-02-16 16:04:32 -0800 (Thu, 16 Feb 2012) $
      4            Revision:       $Revision: 29348 $
      5          
      6            Description:    This file contains the interface to the Zigbee Device Application. This is the
      7                            Application part that the user can change. This also contains the Task functions.
      8          
      9          
     10            Copyright 2004-2012 Texas Instruments Incorporated. All rights reserved.
     11          
     12            IMPORTANT: Your use of this Software is limited to those specific rights
     13            granted under the terms of a software license agreement between the user
     14            who downloaded the software, his/her employer (which must be your employer)
     15            and Texas Instruments Incorporated (the "License").  You may not use this
     16            Software unless you agree to abide by the terms of the License. The License
     17            limits your use, and you acknowledge, that the Software may not be modified,
     18            copied or distributed unless embedded on a Texas Instruments microcontroller
     19            or used solely and exclusively in conjunction with a Texas Instruments radio
     20            frequency transceiver, which is integrated into your product.  Other than for
     21            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     22            works of, modify, distribute, perform, display or sell this Software and/or
     23            its documentation for any purpose.
     24          
     25            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     26            PROVIDED “AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     27            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     28            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     29            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     30            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     31            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     32            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     33            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     34            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     35            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     36          
     37            Should you have any questions regarding your right to use this Software,
     38            contact Texas Instruments Incorporated at www.TI.com.
     39          **************************************************************************************************/
     40          
     41          /*********************************************************************
     42           * INCLUDES
     43           */
     44          
     45          #include "ZComDef.h"
     46          #include "ZMac.h"
     47          #include "OSAL.h"
     48          #include "OSAL_Tasks.h"
     49          #include "OSAL_PwrMgr.h"
     50          #include "OSAL_Nv.h"
     51          #include "AF.h"
     52          #include "APSMEDE.h"
     53          #include "NLMEDE.h"
     54          #include "AddrMgr.h"
     55          #include "ZDProfile.h"
     56          #include "ZDObject.h"
     57          #include "ZDConfig.h"
     58          #include "ZDSecMgr.h"
     59          #include "ZDApp.h"
     60          #include "DebugTrace.h"
     61          #include "nwk_util.h"
     62          #include "OnBoard.h"
     63          #include "ZGlobals.h"
     64          #include "ZDNwkMgr.h"
     65          #include "rtg.h"
     66          
     67          #include "ssp.h"
     68          
     69          /* HAL */
     70          #include "hal_led.h"
     71          #include "hal_lcd.h"
     72          #include "hal_key.h"
     73          
     74          #if defined( MT_MAC_FUNC ) || defined( MT_MAC_CB_FUNC )
     75            #error "ERROR! MT_MAC functionalities should be disabled on ZDO devices"
     76          #endif
     77          
     78          /*********************************************************************
     79           * CONSTANTS
     80           */
     81          
     82          #if !defined( NWK_START_DELAY )
     83            #define NWK_START_DELAY             100   // in milliseconds
     84          #endif
     85          
     86          #if !defined( LEAVE_RESET_DELAY )
     87            #define LEAVE_RESET_DELAY           5000  // in milliseconds
     88          #endif
     89          
     90          // Init ZDO, but hold and wait for application to start the joining or
     91          // forming network
     92          #define ZDO_INIT_HOLD_NWK_START       0xFFFF
     93          
     94          #if !defined( EXTENDED_JOINING_RANDOM_MASK )
     95            #define EXTENDED_JOINING_RANDOM_MASK 0x007F
     96          #endif
     97          
     98          #if !defined( BEACON_REQUEST_DELAY )
     99            #define BEACON_REQUEST_DELAY        100   // in milliseconds
    100          #endif
    101          
    102          #if !defined( BEACON_REQ_DELAY_MASK )
    103            #define BEACON_REQ_DELAY_MASK       0x007F
    104          #endif
    105          
    106          #define MAX_RESUME_RETRY            3
    107          
    108          #define MAX_DEVICE_UNAUTH_TIMEOUT   5000  // 5 seconds
    109          
    110          // Beacon Order Settings (see NLMEDE.h)
    111          #define DEFAULT_BEACON_ORDER        BEACON_ORDER_NO_BEACONS
    112          #define DEFAULT_SUPERFRAME_ORDER    DEFAULT_BEACON_ORDER
    113          
    114          #if !defined( MAX_NWK_FRAMECOUNTER_CHANGES )
    115            // The number of times the frame counter can change before
    116            // saving to NV
    117            #define MAX_NWK_FRAMECOUNTER_CHANGES    1000
    118          #endif
    119          
    120          // Leave control bits
    121          #define ZDAPP_LEAVE_CTRL_INIT 0
    122          #define ZDAPP_LEAVE_CTRL_SET  1
    123          #define ZDAPP_LEAVE_CTRL_RA   2
    124          
    125          // Address Manager Stub Implementation
    126          #define ZDApp_NwkWriteNVRequest AddrMgrWriteNVRequest
    127          
    128          
    129          #if !defined ZDO_NV_SAVE_RFDs
    130          #define ZDO_NV_SAVE_RFDs  TRUE
    131          #endif
    132          
    133          // Delay time before updating NWK NV data to force fewer writes during high activity.
    134          #if ZDO_NV_SAVE_RFDs
    135          #define ZDAPP_UPDATE_NWK_NV_TIME 700
    136          #else
    137          #define ZDAPP_UPDATE_NWK_NV_TIME 65000
    138          #endif
    139          
    140          /*********************************************************************
    141           * GLOBAL VARIABLES
    142           */
    143          
    144          #if defined( LCD_SUPPORTED )
    145            uint8 MatchRsps = 0;
    146          #endif
    147          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    148          uint8 zdoDiscCounter = 1;
   \                     zdoDiscCounter:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for zdoDiscCounter>`
   \   000001                REQUIRE __INIT_XDATA_I
    149          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    150          zAddrType_t ZDAppNwkAddr;
   \                     ZDAppNwkAddr:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z
    151          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    152          uint8 zdappMgmtNwkDiscRspTransSeq;
   \                     zdappMgmtNwkDiscRspTransSeq:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    153          uint8 zdappMgmtNwkDiscReqInProgress = FALSE;
   \                     zdappMgmtNwkDiscReqInProgress:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    154          zAddrType_t zdappMgmtNwkDiscRspAddr;
   \                     zdappMgmtNwkDiscRspAddr:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    155          uint8 zdappMgmtNwkDiscStartIndex;
   \                     zdappMgmtNwkDiscStartIndex:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    156          uint8 zdappMgmtSavedNwkState;
   \                     zdappMgmtSavedNwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    157          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    158          uint16 nwkFrameCounterChanges = 0;
   \                     nwkFrameCounterChanges:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
    159          uint8 continueJoining = TRUE;
   \                     continueJoining:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for continueJoining>`
   \   000001                REQUIRE __INIT_XDATA_I
    160          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    161          uint8  _tmpRejoinState;
   \                     _tmpRejoinState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    162          
    163          // The extended PanID used in ZDO layer for rejoin.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    164          uint8 ZDO_UseExtendedPANID[Z_EXTADDR_LEN];
   \                     ZDO_UseExtendedPANID:
   \   000000                DS 8
   \   000008                REQUIRE __INIT_XDATA_Z
    165          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    166          pfnZdoCb zdoCBFunc[MAX_ZDO_CB_FUNC];
   \                     zdoCBFunc:
   \   000000                DS 14
   \   00000E                REQUIRE __INIT_XDATA_Z
    167          
    168          /*********************************************************************
    169           * EXTERNAL VARIABLES
    170           */
    171          
    172          /*********************************************************************
    173           * EXTERNAL FUNCTIONS
    174           */
    175          
    176          /*********************************************************************
    177           * LOCAL FUNCTIONS
    178           */
    179          
    180          void ZDApp_NetworkStartEvt( void );
    181          void ZDApp_DeviceAuthEvt( void );
    182          void ZDApp_SaveNetworkStateEvt( void );
    183          
    184          uint8 ZDApp_ReadNetworkRestoreState( void );
    185          uint8 ZDApp_RestoreNetworkState( void );
    186          void ZDAppDetermineDeviceType( void );
    187          void ZDApp_InitUserDesc( void );
    188          void ZDAppCheckForHoldKey( void );
    189          void ZDApp_ProcessOSALMsg( osal_event_hdr_t *msgPtr );
    190          void ZDApp_ProcessNetworkJoin( void );
    191          void ZDApp_SetCoordAddress( uint8 endPoint, uint8 dstEP );
    192          uint8 ZDApp_RestoreNwkKey( void );
    193          networkDesc_t* ZDApp_NwkDescListProcessing(void);
    194          
    195          void ZDApp_SecInit( uint8 state );
    196          UINT16 ZDApp_ProcessSecEvent( uint8 task_id, UINT16 events );
    197          void ZDApp_ProcessSecMsg( osal_event_hdr_t *msgPtr );
    198          
    199          void ZDApp_SendMsg( uint8 taskID, uint8 cmd, uint8 len, uint8 *buf );
    200          
    201          void ZDApp_ResetTimerStart( uint16 delay );
    202          void ZDApp_ResetTimerCancel( void );
    203          void ZDApp_LeaveCtrlInit( void );
    204          void ZDApp_LeaveCtrlSet( uint8 ra );
    205          uint8 ZDApp_LeaveCtrlBypass( void );
    206          void ZDApp_LeaveCtrlStartup( devStates_t* state, uint16* startDelay );
    207          void ZDApp_LeaveUpdate( uint16 nwkAddr, uint8* extAddr,
    208                                  uint8 removeChildren );
    209          void ZDApp_NodeProfileSync( uint8 stackProfile );
    210          void ZDApp_ProcessMsgCBs( zdoIncomingMsg_t *inMsg );
    211          void ZDApp_RegisterCBs( void );
    212          void ZDApp_InitZdoCBFunc(void);
    213          
    214          /*********************************************************************
    215           * LOCAL VARIABLES
    216           */
    217          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    218          uint8 ZDAppTaskID;
   \                     ZDAppTaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    219          uint8 nwkStatus;
   \                     nwkStatus:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    220          endPointDesc_t *ZDApp_AutoFindMode_epDesc = (endPointDesc_t *)NULL;
   \                     ZDApp_AutoFindMode_epDesc:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    221          uint8 ZDApp_LeaveCtrl;
   \                     ZDApp_LeaveCtrl:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    222          
    223          #if defined( HOLD_AUTO_START )
    224            devStates_t devState = DEV_HOLD;
    225          #else

   \                                 In  segment XDATA_I, align 1, keep-with-next
    226            devStates_t devState = DEV_INIT;
   \                     devState:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for devState>`
   \   000001                REQUIRE __INIT_XDATA_I
    227          #endif
    228          
    229          #if ( ZG_BUILD_RTRONLY_TYPE ) || ( ZG_BUILD_ENDDEVICE_TYPE )

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    230            devStartModes_t devStartMode = MODE_JOIN;     // Assume joining
   \                     devStartMode:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    231            //devStartModes_t devStartMode = MODE_RESUME; // if already "directly joined"
    232                                  // to parent. Set to make the device do an Orphan scan.
    233          #else
    234            // Set the default to coodinator
    235            devStartModes_t devStartMode = MODE_HARD;
    236          #endif
    237          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    238          uint8 retryCnt;
   \                     retryCnt:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    239          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    240          endPointDesc_t ZDApp_epDesc =
   \                     ZDApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE `?<Initializer for ZDApp_epDesc>`
   \   000006                REQUIRE __INIT_XDATA_I
    241          {
    242            ZDO_EP,
    243            &ZDAppTaskID,
    244            (SimpleDescriptionFormat_t *)NULL,  // No Simple description for ZDO
    245            (afNetworkLatencyReq_t)0            // No Network Latency req
    246          };
    247          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    248          uint16 ZDApp_SavedPollRate = POLL_RATE;
   \                     ZDApp_SavedPollRate:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    249          
    250          /*********************************************************************
    251           * @fn      ZDApp_Init
    252           *
    253           * @brief   ZDApp Initialization function.
    254           *
    255           * @param   task_id - ZDApp Task ID
    256           *
    257           * @return  None
    258           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    259          void ZDApp_Init( uint8 task_id )
   \                     ZDApp_Init:
    260          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    261            // Save the task ID
    262            ZDAppTaskID = task_id;
   \   000006   90....       MOV     DPTR,#ZDAppTaskID
   \   000009   F0           MOVX    @DPTR,A
    263          
    264            // Initialize the ZDO global device short address storage
    265            ZDAppNwkAddr.addrMode = Addr16Bit;
   \   00000A   90....       MOV     DPTR,#ZDAppNwkAddr + 8
   \   00000D   7402         MOV     A,#0x2
   \   00000F   F0           MOVX    @DPTR,A
    266            ZDAppNwkAddr.addr.shortAddr = INVALID_NODE_ADDR;
   \   000010   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000013   74FE         MOV     A,#-0x2
   \   000015   F0           MOVX    @DPTR,A
   \   000016   A3           INC     DPTR
   \   000017   04           INC     A
   \   000018   F0           MOVX    @DPTR,A
    267            (void)NLME_GetExtAddr();  // Load the saveExtAddr pointer.
   \   000019                ; Setup parameters for call to function NLME_GetExtAddr
   \   000019   12....       LCALL   ??NLME_GetExtAddr?relay
    268          
    269            // Check for manual "Hold Auto Start"
    270            ZDAppCheckForHoldKey();
    271          
    272            // Initialize ZDO items and setup the device - type of device to create.
    273            ZDO_Init();
   \   00001C                ; Setup parameters for call to function ZDO_Init
   \   00001C   12....       LCALL   ??ZDO_Init?relay
    274          
    275            // Register the endpoint description with the AF
    276            // This task doesn't have a Simple description, but we still need
    277            // to register the endpoint.
    278            afRegister( (endPointDesc_t *)&ZDApp_epDesc );
   \   00001F                ; Setup parameters for call to function afRegister
   \   00001F   7A..         MOV     R2,#ZDApp_epDesc & 0xff
   \   000021   7B..         MOV     R3,#(ZDApp_epDesc >> 8) & 0xff
   \   000023   12....       LCALL   ??afRegister?relay
    279          
    280          #if defined( ZDO_USERDESC_RESPONSE )
    281            ZDApp_InitUserDesc();
    282          #endif // ZDO_USERDESC_RESPONSE
    283            
    284            // Start the device?
    285            if ( devState != DEV_HOLD )//
   \   000026   90....       MOV     DPTR,#devState
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   6009         JZ      ??ZDApp_Init_0
    286            {
    287              ZDOInitDevice( 0 );
   \   00002C                ; Setup parameters for call to function ZDOInitDevice
   \   00002C   7A00         MOV     R2,#0x0
   \   00002E   7B00         MOV     R3,#0x0
   \   000030   12....       LCALL   ??ZDOInitDevice?relay
   \   000033   8014         SJMP    ??ZDApp_Init_1
    288            }
    289            else
    290            {
    291              ZDOInitDevice( ZDO_INIT_HOLD_NWK_START );
   \                     ??ZDApp_Init_0:
   \   000035                ; Setup parameters for call to function ZDOInitDevice
   \   000035   7AFF         MOV     R2,#-0x1
   \   000037   7BFF         MOV     R3,#-0x1
   \   000039   12....       LCALL   ??ZDOInitDevice?relay
    292              // Blink LED to indicate HOLD_START
    293              HalLedBlink ( HAL_LED_4, 0, 50, 500 );
   \   00003C                ; Setup parameters for call to function HalLedBlink
   \   00003C   7CF4         MOV     R4,#-0xc
   \   00003E   7D01         MOV     R5,#0x1
   \   000040   7B32         MOV     R3,#0x32
   \   000042   7A00         MOV     R2,#0x0
   \   000044   7908         MOV     R1,#0x8
   \   000046   12....       LCALL   ??HalLedBlink?relay
    294            }
    295          
    296            // Initialize the ZDO callback function pointers zdoCBFunc[]
    297            ZDApp_InitZdoCBFunc();
   \                     ??ZDApp_Init_1:
   \   000049                ; Setup parameters for call to function ZDApp_InitZdoCBFunc
   \   000049   12....       LCALL   ??ZDApp_InitZdoCBFunc?relay
    298          
    299            ZDApp_RegisterCBs();
   \   00004C                ; Setup parameters for call to function ZDApp_RegisterCBs
   \   00004C   12....       LCALL   ??ZDApp_RegisterCBs?relay
    300          } /* ZDApp_Init() */
   \   00004F   02....       LJMP    ??Subroutine51_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine51_0:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    301          
    302          /*********************************************************************
    303           * @fn          ZDApp_SecInit
    304           *
    305           * @brief       ZDApp initialize security.
    306           *
    307           * @param       state - device initialization state
    308           *
    309           * @return      none
    310           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    311          void ZDApp_SecInit( uint8 state )
   \                     ZDApp_SecInit:
    312          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 16
   \   000005   74F0         MOV     A,#-0x10
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
    313            uint8 zgPreConfigKey[SEC_KEY_LEN];
    314          
    315            if ( ZG_SECURE_ENABLED && ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    316            {
    317              // Set the Trust Center bit
    318              ZDO_Config_Node_Descriptor.ServerMask |= PRIM_TRUST_CENTER;
    319            }
    320          
    321            if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
    322            {
    323              ZDO_Config_Node_Descriptor.CapabilityFlags |= CAPINFO_SECURITY_CAPABLE;
    324            }
    325          
    326            // Initialize ZigBee Device Security Manager
    327            ZDSecMgrInit(state);
   \   00000C                ; Setup parameters for call to function ZDSecMgrInit
   \   00000C   12....       LCALL   ??ZDSecMgrInit?relay
    328          
    329            if ( ZG_SECURE_ENABLED )
    330            {
    331              if ( state != ZDO_INITDEV_RESTORED_NETWORK_STATE )
   \   00000F   EE           MOV     A,R6
   \   000010   6058         JZ      ??ZDApp_SecInit_0
    332              {
    333                nwkFrameCounter = 0;
   \   000012   90....       MOV     DPTR,#__Constant_0
   \   000015   12....       LCALL   ?XLOAD_R2345
   \   000018   90....       MOV     DPTR,#nwkFrameCounter
   \   00001B   12....       LCALL   ?XSTORE_R2345
    334          
    335                if( _NIB.nwkKeyLoaded == FALSE )
   \   00001E   90....       MOV     DPTR,#_NIB + 61
   \   000021   E0           MOVX    A,@DPTR
   \   000022   7046         JNZ     ??ZDApp_SecInit_0
    336                {
    337                  if ( ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE          ) ||
    338                       ( ( zgSecurityMode == ZG_SECURITY_RESIDENTIAL ) && zgPreConfigKeys )    )
   \   000024   90....       MOV     DPTR,#zgSecurityMode
   \   000027   E0           MOVX    A,@DPTR
   \   000028   6401         XRL     A,#0x1
   \   00002A   703E         JNZ     ??ZDApp_SecInit_0
   \   00002C   90....       MOV     DPTR,#zgPreConfigKeys
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   6038         JZ      ??ZDApp_SecInit_0
    339                  {
    340                      ZDSecMgrReadKeyFromNv(ZCD_NV_PRECFGKEY, zgPreConfigKey);
   \   000032                ; Setup parameters for call to function ZDSecMgrReadKeyFromNv
   \   000032   85..82       MOV     DPL,?XSP + 0
   \   000035   85..83       MOV     DPH,?XSP + 1
   \   000038   AC82         MOV     R4,DPL
   \   00003A   AD83         MOV     R5,DPH
   \   00003C   7A62         MOV     R2,#0x62
   \   00003E   7B00         MOV     R3,#0x0
   \   000040   12....       LCALL   ??ZDSecMgrReadKeyFromNv?relay
    341                      SSP_UpdateNwkKey( zgPreConfigKey, 0);
   \   000043                ; Setup parameters for call to function SSP_UpdateNwkKey
   \   000043   7900         MOV     R1,#0x0
   \   000045   85..82       MOV     DPL,?XSP + 0
   \   000048   85..83       MOV     DPH,?XSP + 1
   \   00004B   AA82         MOV     R2,DPL
   \   00004D   AB83         MOV     R3,DPH
   \   00004F   12....       LCALL   ??SSP_UpdateNwkKey?relay
    342                      SSP_SwitchNwkKey( 0 );
   \   000052                ; Setup parameters for call to function SSP_SwitchNwkKey
   \   000052   7900         MOV     R1,#0x0
   \   000054   12....       LCALL   ??SSP_SwitchNwkKey?relay
    343          
    344                      // clear local copy of key
    345                      osal_memset(zgPreConfigKey, 0x00, SEC_KEY_LEN);
   \   000057                ; Setup parameters for call to function osal_memset
   \   000057   7C10         MOV     R4,#0x10
   \   000059   7D00         MOV     R5,#0x0
   \   00005B   7900         MOV     R1,#0x0
   \   00005D   85..82       MOV     DPL,?XSP + 0
   \   000060   85..83       MOV     DPH,?XSP + 1
   \   000063   AA82         MOV     R2,DPL
   \   000065   AB83         MOV     R3,DPH
   \   000067   12....       LCALL   ??osal_memset?relay
    346                  }
    347                }
    348              }
    349            }
    350          }
   \                     ??ZDApp_SecInit_0:
   \   00006A   7410         MOV     A,#0x10
   \   00006C   02....       LJMP    ??Subroutine62_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine62_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   02....       LJMP    ??Subroutine51_0 & 0xFFFF
    351          
    352          /*********************************************************************
    353           * @fn      ZDApp_event_loop()
    354           *
    355           * @brief   Main event loop for Zigbee device objects task. This function
    356           *          should be called at periodic intervals.
    357           *
    358           * @param   task_id - Task ID
    359           * @param   events  - Bitmap of events
    360           *
    361           * @return  none
    362           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    363          UINT16 ZDApp_event_loop( uint8 task_id, UINT16 events )
   \                     ZDApp_event_loop:
    364          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 2,R1
   \   000007   EA           MOV     A,R2
   \   000008   FE           MOV     R6,A
   \   000009   EB           MOV     A,R3
   \   00000A   FF           MOV     R7,A
    365            uint8 *msg_ptr;
    366          
    367            if ( events & SYS_EVENT_MSG )
   \   00000B   5480         ANL     A,#0x80
   \   00000D   7032         JNZ     ??ZDApp_event_loop_0
    368            {
    369              while ( (msg_ptr = osal_msg_receive( ZDAppTaskID )) )
    370              {
    371                ZDApp_ProcessOSALMsg( (osal_event_hdr_t *)msg_ptr );
    372          
    373                // Release the memory
    374                osal_msg_deallocate( msg_ptr );
    375              }
    376          
    377              // Return unprocessed events
    378              return (events ^ SYS_EVENT_MSG);
    379            }
    380          
    381            if ( events & ZDO_NETWORK_INIT )
   \   00000F   EE           MOV     A,R6
   \   000010   A2E0         MOV     C,0xE0 /* A   */.0
   \   000012   5046         JNC     ??ZDApp_event_loop_1
    382            {
    383              // Initialize apps and start the network
    384              devState = DEV_INIT;
   \   000014   90....       MOV     DPTR,#devState
   \   000017   7401         MOV     A,#0x1
   \   000019   12....       LCALL   ??Subroutine45_0 & 0xFFFF
    385              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
    386          
    387              ZDO_StartDevice( (uint8)ZDO_Config_Node_Descriptor.LogicalType, devStartMode,
    388                               DEFAULT_BEACON_ORDER, DEFAULT_SUPERFRAME_ORDER );
   \                     ??CrossCallReturnLabel_68:
   \   00001C                ; Setup parameters for call to function ZDO_StartDevice
   \   00001C   7C0F         MOV     R4,#0xf
   \   00001E   7B0F         MOV     R3,#0xf
   \   000020   90....       MOV     DPTR,#devStartMode
   \   000023   E0           MOVX    A,@DPTR
   \   000024   FA           MOV     R2,A
   \   000025   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000028   E0           MOVX    A,@DPTR
   \   000029   5407         ANL     A,#0x7
   \   00002B   F9           MOV     R1,A
   \   00002C   12....       LCALL   ??ZDO_StartDevice?relay
    389          
    390              // Return unprocessed events
    391              return (events ^ ZDO_NETWORK_INIT);
   \   00002F   EE           MOV     A,R6
   \   000030   6401         XRL     A,#0x1
   \                     ??ZDApp_event_loop_2:
   \   000032   FA           MOV     R2,A
   \   000033   EF           MOV     A,R7
   \                     ??ZDApp_event_loop_3:
   \   000034   FB           MOV     R3,A
   \   000035   807C         SJMP    ??ZDApp_event_loop_4
    392            }
   \                     ??ZDApp_event_loop_5:
   \   000037                ; Setup parameters for call to function ZDApp_ProcessOSALMsg
   \   000037   12....       LCALL   ??ZDApp_ProcessOSALMsg?relay
   \   00003A                ; Setup parameters for call to function osal_msg_deallocate
   \   00003A   AA..         MOV     R2,?V0 + 0
   \   00003C   AB..         MOV     R3,?V0 + 1
   \   00003E   12....       LCALL   ??osal_msg_deallocate?relay
   \                     ??ZDApp_event_loop_0:
   \   000041                ; Setup parameters for call to function osal_msg_receive
   \   000041   90....       MOV     DPTR,#ZDAppTaskID
   \   000044   E0           MOVX    A,@DPTR
   \   000045   F9           MOV     R1,A
   \   000046   12....       LCALL   ??osal_msg_receive?relay
   \   000049   8A..         MOV     ?V0 + 0,R2
   \   00004B   8B..         MOV     ?V0 + 1,R3
   \   00004D   A9..         MOV     R1,?V0 + 1
   \   00004F   EA           MOV     A,R2
   \   000050   49           ORL     A,R1
   \   000051   70E4         JNZ     ??ZDApp_event_loop_5
   \   000053   EE           MOV     A,R6
   \   000054   FA           MOV     R2,A
   \   000055   EF           MOV     A,R7
   \   000056   6480         XRL     A,#0x80
   \   000058   80DA         SJMP    ??ZDApp_event_loop_3
    393          
    394            if ( ZSTACK_ROUTER_BUILD )
    395            {
    396              if ( events & ZDO_NETWORK_START )
    397              {
    398                ZDApp_NetworkStartEvt();
    399          
    400                // Return unprocessed events
    401                return (events ^ ZDO_NETWORK_START);
    402              }
    403          
    404              if ( events & ZDO_ROUTER_START )
    405              {
    406                if ( nwkStatus == ZSuccess )
    407                {
    408                  if ( devState == DEV_END_DEVICE )
    409                    devState = DEV_ROUTER;
    410          
    411                  osal_pwrmgr_device( PWRMGR_ALWAYS_ON );
    412                }
    413                else
    414                {
    415                  // remain as end device!!
    416                }
    417                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
    418          
    419                // Return unprocessed events
    420                return (events ^ ZDO_ROUTER_START);
    421              }
    422            }
    423          
    424            if ( events & ZDO_STATE_CHANGE_EVT )
   \                     ??ZDApp_event_loop_1:
   \   00005A   5410         ANL     A,#0x10
   \   00005C   6023         JZ      ??ZDApp_event_loop_6
    425            {
    426              ZDO_UpdateNwkStatus( devState );
   \   00005E                ; Setup parameters for call to function ZDO_UpdateNwkStatus
   \   00005E   90....       MOV     DPTR,#devState
   \   000061   E0           MOVX    A,@DPTR
   \   000062   F9           MOV     R1,A
   \   000063   12....       LCALL   ??ZDO_UpdateNwkStatus?relay
    427          
    428              // At start up, do one MTO route discovery if the device is a concentrator
    429              if ( zgConcentratorEnable == TRUE )
   \   000066   90....       MOV     DPTR,#zgConcentratorEnable
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   6401         XRL     A,#0x1
   \   00006C   700E         JNZ     ??CrossCallReturnLabel_127
    430              {
    431                // Start next event
    432                osal_start_timerEx( NWK_TaskID, NWK_MTO_RTG_REQ_EVT, 100 );
   \   00006E                ; Setup parameters for call to function osal_start_timerEx
   \   00006E   7C64         MOV     R4,#0x64
   \   000070   7D00         MOV     R5,#0x0
   \   000072   7A00         MOV     R2,#0x0
   \   000074   7B08         MOV     R3,#0x8
   \   000076   90....       MOV     DPTR,#NWK_TaskID
   \   000079   12....       LCALL   ??Subroutine61_0 & 0xFFFF
    433              }
    434          
    435              // Return unprocessed events
    436              return (events ^ ZDO_STATE_CHANGE_EVT);
   \                     ??CrossCallReturnLabel_127:
   \   00007C   EE           MOV     A,R6
   \   00007D   6410         XRL     A,#0x10
   \   00007F   80B1         SJMP    ??ZDApp_event_loop_2
    437            }
    438          
    439            if ( events & ZDO_COMMAND_CNF )
   \                     ??ZDApp_event_loop_6:
   \   000081   EE           MOV     A,R6
   \   000082   5408         ANL     A,#0x8
   \   000084   6006         JZ      ??ZDApp_event_loop_7
    440            {
    441              // User defined logic
    442          
    443              // Return unprocessed events
    444              return (events ^ ZDO_COMMAND_CNF);
   \   000086   EE           MOV     A,R6
   \   000087   6408         XRL     A,#0x8
   \   000089   FA           MOV     R2,A
   \   00008A   8027         SJMP    ??ZDApp_event_loop_4
    445            }
    446          
    447            if ( events & ZDO_NWK_UPDATE_NV )
   \                     ??ZDApp_event_loop_7:
   \   00008C   EF           MOV     A,R7
   \   00008D   5402         ANL     A,#0x2
   \   00008F   600A         JZ      ??ZDApp_event_loop_8
    448            {
    449              ZDApp_SaveNetworkStateEvt();
   \   000091                ; Setup parameters for call to function ZDApp_SaveNetworkStateEvt
   \   000091   12....       LCALL   ??ZDApp_SaveNetworkStateEvt?relay
    450          
    451              // Return unprocessed events
    452              return (events ^ ZDO_NWK_UPDATE_NV);
   \   000094   EE           MOV     A,R6
   \   000095   FA           MOV     R2,A
   \   000096   EF           MOV     A,R7
   \   000097   6402         XRL     A,#0x2
   \   000099   8099         SJMP    ??ZDApp_event_loop_3
    453            }
    454          
    455            if ( events & ZDO_DEVICE_RESET )
   \                     ??ZDApp_event_loop_8:
   \   00009B   EE           MOV     A,R6
   \   00009C   5404         ANL     A,#0x4
   \   00009E   600A         JZ      ??ZDApp_event_loop_9
    456            {
    457          #ifdef ZBA_FALLBACK_NWKKEY
    458              if ( devState == DEV_END_DEVICE_UNAUTH )
    459              {
    460                ZDSecMgrFallbackNwkKey();
    461              }
    462              else
    463          #endif
    464              {
    465                // Set the NV startup option to force a "new" join.
    466                zgWriteStartupOptions( ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
   \   0000A0                ; Setup parameters for call to function zgWriteStartupOptions
   \   0000A0   7A02         MOV     R2,#0x2
   \   0000A2   79FF         MOV     R1,#-0x1
   \   0000A4   12....       LCALL   ??zgWriteStartupOptions?relay
    467          
    468                // The device has been in the UNAUTH state, so reset
    469                // Note: there will be no return from this call
    470                SystemResetSoft();
   \   0000A7                ; Setup parameters for call to function Onboard_soft_reset
   \   0000A7   12....       LCALL   Onboard_soft_reset & 0xFFFF
    471              }
    472            }
    473          
    474            if ( ZG_SECURE_ENABLED )
    475            {
    476              return ( ZDApp_ProcessSecEvent( task_id, events ) );
   \                     ??ZDApp_event_loop_9:
   \   0000AA                ; Setup parameters for call to function ZDApp_ProcessSecEvent
   \   0000AA   EE           MOV     A,R6
   \   0000AB   FA           MOV     R2,A
   \   0000AC   EF           MOV     A,R7
   \   0000AD   FB           MOV     R3,A
   \   0000AE   A9..         MOV     R1,?V0 + 2
   \   0000B0   12....       LCALL   ??ZDApp_ProcessSecEvent?relay
   \                     ??ZDApp_event_loop_4:
   \   0000B3   7F03         MOV     R7,#0x3
   \   0000B5   02....       LJMP    ?BANKED_LEAVE_XDATA
    477            }
    478            else
    479            {
    480              // Discard or make more handlers
    481              return 0;
    482            }
    483          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine45_0:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function osal_set_event
   \   000001                ; Setup parameters for call to function osal_set_event
   \   000001                ; Setup parameters for call to function osal_set_event
   \   000001   7A10         MOV     R2,#0x10
   \   000003   7B00         MOV     R3,#0x0
   \   000005   90....       MOV     DPTR,#ZDAppTaskID
   \   000008   E0           MOVX    A,@DPTR
   \   000009   F9           MOV     R1,A
   \   00000A   12....       LCALL   ??osal_set_event?relay
   \   00000D   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine61_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F9           MOV     R1,A
   \   000002   12....       LCALL   ??osal_start_timerEx?relay
   \   000005   22           RET
    484          
    485          /*********************************************************************
    486           * @fn      ZDApp_ProcessSecEvent()
    487           *
    488           * @brief   Process incoming security events.
    489           *
    490           * @param   task_id - Task ID
    491           * @param   events  - Bitmap of events
    492           *
    493           * @return  none
    494           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    495          UINT16 ZDApp_ProcessSecEvent( uint8 task_id, UINT16 events )
   \                     ZDApp_ProcessSecEvent:
    496          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    497            (void)task_id;  // Intentionally unreferenced parameter
    498          
    499            if ( ZSTACK_ROUTER_BUILD )
    500            {
    501              if ( events & ZDO_NEW_DEVICE )
    502              {
    503                // process the new device event
    504                if ( ZDSecMgrNewDeviceEvent() == TRUE )
    505                {
    506                  osal_start_timerEx( ZDAppTaskID, ZDO_NEW_DEVICE, 1000 );
    507                }
    508          
    509                // Return unprocessed events
    510                return (events ^ ZDO_NEW_DEVICE);
    511              }
    512            }
    513          
    514            if ( (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH)
    515                || (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD) )
    516            {
    517              if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    518              {
    519                if ( events & ZDO_SECMGR_EVENT )
    520                {
    521                  ZDSecMgrEvent();
    522          
    523                  // Return unprocessed events
    524                  return (events ^ ZDO_SECMGR_EVENT);
    525                }
    526              }
    527            }
    528          
    529            if ( events & ZDO_DEVICE_AUTH )
   \   000009   EE           MOV     A,R6
   \   00000A   5480         ANL     A,#0x80
   \   00000C   600B         JZ      ??ZDApp_ProcessSecEvent_0
    530            {
    531              ZDApp_DeviceAuthEvt();
   \   00000E                ; Setup parameters for call to function ZDApp_DeviceAuthEvt
   \   00000E   12....       LCALL   ??ZDApp_DeviceAuthEvt?relay
    532          
    533              // Return unprocessed events
    534              return (events ^ ZDO_DEVICE_AUTH);
   \   000011   EE           MOV     A,R6
   \   000012   6480         XRL     A,#0x80
   \   000014   FA           MOV     R2,A
   \   000015   EF           MOV     A,R7
   \                     ??ZDApp_ProcessSecEvent_1:
   \   000016   FB           MOV     R3,A
   \   000017   804E         SJMP    ??ZDApp_ProcessSecEvent_2
    535            }
    536          
    537            if ( events & ZDO_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_0:
   \   000019   EF           MOV     A,R7
   \   00001A   5404         ANL     A,#0x4
   \   00001C   6027         JZ      ??ZDApp_ProcessSecEvent_3
    538            {
    539              if ( nwkFrameCounterChanges++ > MAX_NWK_FRAMECOUNTER_CHANGES )
   \   00001E   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000021   12....       LCALL   ??Subroutine58_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_113:
   \   000024   E8           MOV     A,R0
   \   000025   2401         ADD     A,#0x1
   \   000027   FA           MOV     R2,A
   \   000028   E9           MOV     A,R1
   \   000029   3400         ADDC    A,#0x0
   \   00002B   FB           MOV     R3,A
   \   00002C   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   00002F   12....       LCALL   ??Subroutine53_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_82:
   \   000032   C3           CLR     C
   \   000033   E8           MOV     A,R0
   \   000034   94E9         SUBB    A,#-0x17
   \   000036   E9           MOV     A,R1
   \   000037   9403         SUBB    A,#0x3
   \   000039   4003         JC      ??ZDApp_ProcessSecEvent_4
    540              {
    541                ZDApp_SaveNwkKey();
   \   00003B                ; Setup parameters for call to function ZDApp_SaveNwkKey
   \   00003B   12....       LCALL   ??ZDApp_SaveNwkKey?relay
    542              }
    543          
    544              // Return unprocessed events
    545              return (events ^ ZDO_FRAMECOUNTER_CHANGE);
   \                     ??ZDApp_ProcessSecEvent_4:
   \   00003E   EE           MOV     A,R6
   \   00003F   FA           MOV     R2,A
   \   000040   EF           MOV     A,R7
   \   000041   6404         XRL     A,#0x4
   \   000043   80D1         SJMP    ??ZDApp_ProcessSecEvent_1
    546            }
    547          
    548            if ( events & ZDO_APS_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_3:
   \   000045   EF           MOV     A,R7
   \   000046   5410         ANL     A,#0x10
   \   000048   600A         JZ      ??ZDApp_ProcessSecEvent_5
    549            {
    550          #if defined (NV_RESTORE)
    551              ZDSecMgrSaveApsLinkKey();
   \   00004A                ; Setup parameters for call to function ZDSecMgrSaveApsLinkKey
   \   00004A   12....       LCALL   ??ZDSecMgrSaveApsLinkKey?relay
    552          #endif // (NV_RESTORE)
    553          
    554              // Return unprocessed events
    555              return (events ^ ZDO_APS_FRAMECOUNTER_CHANGE);
   \   00004D   EE           MOV     A,R6
   \   00004E   FA           MOV     R2,A
   \   00004F   EF           MOV     A,R7
   \   000050   6410         XRL     A,#0x10
   \   000052   80C2         SJMP    ??ZDApp_ProcessSecEvent_1
    556            }
    557          
    558            if ( events & ZDO_TCLK_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_5:
   \   000054   EF           MOV     A,R7
   \   000055   5408         ANL     A,#0x8
   \   000057   600A         JZ      ??ZDApp_ProcessSecEvent_6
    559            {
    560              ZDSecMgrSaveTCLinkKey();
   \   000059                ; Setup parameters for call to function ZDSecMgrSaveTCLinkKey
   \   000059   12....       LCALL   ??ZDSecMgrSaveTCLinkKey?relay
    561          
    562              // Return unprocessed events
    563              return (events ^ ZDO_TCLK_FRAMECOUNTER_CHANGE);
   \   00005C   EE           MOV     A,R6
   \   00005D   FA           MOV     R2,A
   \   00005E   EF           MOV     A,R7
   \   00005F   6408         XRL     A,#0x8
   \   000061   80B3         SJMP    ??ZDApp_ProcessSecEvent_1
    564            }
    565          
    566            // Discard or make more handlers
    567            return 0;
   \                     ??ZDApp_ProcessSecEvent_6:
   \   000063   7A00         MOV     R2,#0x0
   \   000065   7B00         MOV     R3,#0x0
   \                     ??ZDApp_ProcessSecEvent_2:
   \   000067   02....       LJMP    ??Subroutine51_0 & 0xFFFF
    568          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine53_0:
   \   000000   EA           MOV     A,R2
   \   000001   F0           MOVX    @DPTR,A
   \   000002   A3           INC     DPTR
   \   000003   EB           MOV     A,R3
   \   000004   F0           MOVX    @DPTR,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine58_0:
   \   000000   12....       LCALL   ?Subroutine39 & 0xFFFF
   \                     ??CrossCallReturnLabel_121:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine39:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   22           RET
    569          
    570          /*********************************************************************
    571           * Application Functions
    572           */
    573          
    574          /*********************************************************************
    575           * @fn      ZDOInitDevice
    576           *
    577           * @brief   Start the device in the network.  This function will read
    578           *   ZCD_NV_STARTUP_OPTION (NV item) to determine whether or not to
    579           *   restore the network state of the device.
    580           *
    581           * @param   startDelay - timeDelay to start device (in milliseconds).
    582           *                       There is a jitter added to this delay:
    583           *                       ((NWK_START_DELAY + startDelay)
    584           *                       + (osal_rand() & EXTENDED_JOINING_RANDOM_MASK))
    585           *                       When startDelay is set to ZDO_INIT_HOLD_NWK_START
    586           *                       this function will hold the network init. Application
    587           *                       can start the device.
    588           *
    589           * NOTE:    If the application would like to force a "new" join, the
    590           *          application should set the ZCD_STARTOPT_DEFAULT_NETWORK_STATE
    591           *          bit in the ZCD_NV_STARTUP_OPTION NV item before calling
    592           *          this function. "new" join means to not restore the network
    593           *          state of the device. Use zgWriteStartupOptions() to set these
    594           *          options.
    595           *
    596           * @return
    597           *    ZDO_INITDEV_RESTORED_NETWORK_STATE  - The device's network state was
    598           *          restored.
    599           *    ZDO_INITDEV_NEW_NETWORK_STATE - The network state was initialized.
    600           *          This could mean that ZCD_NV_STARTUP_OPTION said to not restore, or
    601           *          it could mean that there was no network state to restore.
    602           *    ZDO_INITDEV_LEAVE_NOT_STARTED - Before the reset, a network leave was issued
    603           *          with the rejoin option set to TRUE.  So, the device was not
    604           *          started in the network (one time only).  The next time this
    605           *          function is called it will start.
    606           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    607          uint8 ZDOInitDevice( uint16 startDelay )
   \                     ZDOInitDevice:
    608          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   12....       LCALL   ?Subroutine10 & 0xFFFF
    609            uint8 networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
    610            uint16 extendedDelay = 0;
   \                     ??CrossCallReturnLabel_89:
   \   00000D   7E00         MOV     R6,#0x0
   \   00000F   7F00         MOV     R7,#0x0
    611          
    612            
    613            if ( devState == DEV_HOLD )
   \   000011   90....       MOV     DPTR,#devState
   \   000014   E0           MOVX    A,@DPTR
   \   000015   7005         JNZ     ??ZDOInitDevice_0
    614            {
    615              // Initialize the RAM items table, in case an NV item has been updated.
    616              zgInitItems( FALSE );
   \   000017                ; Setup parameters for call to function zgInitItems
   \   000017   7900         MOV     R1,#0x0
   \   000019   12....       LCALL   ??zgInitItems?relay
    617            }
    618          
    619            ZDConfig_InitDescriptors();
   \                     ??ZDOInitDevice_0:
   \   00001C                ; Setup parameters for call to function ZDConfig_InitDescriptors
   \   00001C   12....       LCALL   ??ZDConfig_InitDescriptors?relay
    620            //devtag.071807.todo - fix this temporary solution
    621            _NIB.CapabilityFlags = ZDO_Config_Node_Descriptor.CapabilityFlags;
   \   00001F   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000022   E0           MOVX    A,@DPTR
   \   000023   90....       MOV     DPTR,#_NIB + 14
   \   000026   F0           MOVX    @DPTR,A
    622          
    623          #if defined ( NV_RESTORE )
    624            // Get Keypad directly to see if a reset nv is needed.
    625            // Hold down the SW_BYPASS_NV key (defined in OnBoard.h)
    626            // while booting to skip past NV Restore.
    627            if ( HalKeyRead() == SW_BYPASS_NV )
   \   000027                ; Setup parameters for call to function HalKeyRead
   \   000027   12....       LCALL   ??HalKeyRead?relay
   \   00002A   E9           MOV     A,R1
   \   00002B   6404         XRL     A,#0x4
   \   00002D   7074         JNZ     ??ZDOInitDevice_1
    628              networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
   \   00002F   75..01       MOV     ?V0 + 0,#0x1
    629            else
    630            {
    631              // Determine if NV should be restored
    632              networkStateNV = ZDApp_ReadNetworkRestoreState();
    633            }
    634          
    635            if ( networkStateNV == ZDO_INITDEV_RESTORED_NETWORK_STATE )
    636            {
    637              networkStateNV = ZDApp_RestoreNetworkState();
    638            }
    639            else
    640            {
    641              // Wipe out the network state in NV
    642              NLME_InitNV();
   \                     ??ZDOInitDevice_2:
   \   000032                ; Setup parameters for call to function NLME_InitNV
   \   000032   12....       LCALL   ??NLME_InitNV?relay
    643              NLME_SetDefaultNV();
   \   000035                ; Setup parameters for call to function NLME_SetDefaultNV
   \   000035   12....       LCALL   ??NLME_SetDefaultNV?relay
    644              // clear NWK key values
    645              ZDSecMgrClearNVKeyValues();
   \   000038                ; Setup parameters for call to function ZDSecMgrClearNVKeyValues
   \   000038   12....       LCALL   ??ZDSecMgrClearNVKeyValues?relay
    646            }
    647          #endif
    648          
    649            if ( networkStateNV == ZDO_INITDEV_NEW_NETWORK_STATE )
   \                     ??ZDOInitDevice_3:
   \   00003B   7401         MOV     A,#0x1
   \   00003D   65..         XRL     A,?V0 + 0
   \   00003F   7020         JNZ     ??ZDOInitDevice_4
    650            {
    651              ZDAppDetermineDeviceType();
   \   000041                ; Setup parameters for call to function ZDAppDetermineDeviceType
   \   000041   12....       LCALL   ??ZDAppDetermineDeviceType?relay
    652          
    653              // Only delay if joining network - not restoring network state
    654              extendedDelay = (uint16)((NWK_START_DELAY + startDelay)
    655                        + (osal_rand() & EXTENDED_JOINING_RANDOM_MASK));
   \   000044                ; Setup parameters for call to function osal_rand
   \   000044   12....       LCALL   ??osal_rand?relay
   \   000047   85..82       MOV     DPL,?XSP + 0
   \   00004A   85..83       MOV     DPH,?XSP + 1
   \   00004D   EA           MOV     A,R2
   \   00004E   547F         ANL     A,#0x7f
   \   000050   F8           MOV     R0,A
   \   000051   E0           MOVX    A,@DPTR
   \   000052   28           ADD     A,R0
   \   000053   F8           MOV     R0,A
   \   000054   A3           INC     DPTR
   \   000055   E0           MOVX    A,@DPTR
   \   000056   3400         ADDC    A,#0x0
   \   000058   F9           MOV     R1,A
   \   000059   E8           MOV     A,R0
   \   00005A   2464         ADD     A,#0x64
   \   00005C   FE           MOV     R6,A
   \   00005D   E9           MOV     A,R1
   \   00005E   3400         ADDC    A,#0x0
   \   000060   FF           MOV     R7,A
    656            }
    657          
    658            // Initialize the security for type of device
    659            ZDApp_SecInit( networkStateNV );
   \                     ??ZDOInitDevice_4:
   \   000061                ; Setup parameters for call to function ZDApp_SecInit
   \   000061   A9..         MOV     R1,?V0 + 0
   \   000063   12....       LCALL   ??ZDApp_SecInit?relay
    660          
    661            if( ZDO_INIT_HOLD_NWK_START != startDelay )
   \   000066   85..82       MOV     DPL,?XSP + 0
   \   000069   85..83       MOV     DPH,?XSP + 1
   \   00006C   E0           MOVX    A,@DPTR
   \   00006D   F4           CPL     A
   \   00006E   7003         JNZ     ??ZDOInitDevice_5
   \   000070   A3           INC     DPTR
   \   000071   E0           MOVX    A,@DPTR
   \   000072   F4           CPL     A
   \                     ??ZDOInitDevice_5:
   \   000073   6045         JZ      ??ZDOInitDevice_6
    662            {
    663              devState = DEV_INIT;    // Remove the Hold state
   \   000075   90....       MOV     DPTR,#devState
   \   000078   7401         MOV     A,#0x1
   \   00007A   F0           MOVX    @DPTR,A
    664          
    665              // Initialize leave control logic
    666              ZDApp_LeaveCtrlInit();
   \   00007B                ; Setup parameters for call to function ZDApp_LeaveCtrlInit
   \   00007B   12....       LCALL   ??ZDApp_LeaveCtrlInit?relay
    667          
    668              // Check leave control reset settings
    669              ZDApp_LeaveCtrlStartup( &devState, &startDelay );
   \   00007E                ; Setup parameters for call to function ZDApp_LeaveCtrlStartup
   \   00007E   85..82       MOV     DPL,?XSP + 0
   \   000081   85..83       MOV     DPH,?XSP + 1
   \   000084   AC82         MOV     R4,DPL
   \   000086   AD83         MOV     R5,DPH
   \   000088   7A..         MOV     R2,#devState & 0xff
   \   00008A   7B..         MOV     R3,#(devState >> 8) & 0xff
   \   00008C   12....       LCALL   ??ZDApp_LeaveCtrlStartup?relay
    670          
    671              // Leave may make the hold state come back
    672              if ( devState == DEV_HOLD )
   \   00008F   90....       MOV     DPTR,#devState
   \   000092   E0           MOVX    A,@DPTR
   \   000093   701E         JNZ     ??ZDOInitDevice_7
    673              {
    674                // Set the NV startup option to force a "new" join.
    675                zgWriteStartupOptions( ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
   \   000095                ; Setup parameters for call to function zgWriteStartupOptions
   \   000095   7A02         MOV     R2,#0x2
   \   000097   79FF         MOV     R1,#-0x1
   \   000099   12....       LCALL   ??zgWriteStartupOptions?relay
    676          
    677                // Notify the applications
    678                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00009C                ; Setup parameters for call to function osal_set_event
   \   00009C   12....       LCALL   ?Subroutine16 & 0xFFFF
    679          
    680                return ( ZDO_INITDEV_LEAVE_NOT_STARTED );   // Don't join - (one time).
   \                     ??CrossCallReturnLabel_59:
   \   00009F   7902         MOV     R1,#0x2
   \   0000A1   8021         SJMP    ??ZDOInitDevice_8
    681              }
   \                     ??ZDOInitDevice_1:
   \   0000A3                ; Setup parameters for call to function ZDApp_ReadNetworkRestoreState
   \   0000A3   12....       LCALL   ??ZDApp_ReadNetworkRestoreState?relay
   \   0000A6   E9           MOV     A,R1
   \   0000A7   F5..         MOV     ?V0 + 0,A
   \   0000A9   7087         JNZ     ??ZDOInitDevice_2
   \   0000AB                ; Setup parameters for call to function ZDApp_RestoreNetworkState
   \   0000AB   12....       LCALL   ??ZDApp_RestoreNetworkState?relay
   \   0000AE   E9           MOV     A,R1
   \   0000AF   F5..         MOV     ?V0 + 0,A
   \   0000B1   8088         SJMP    ??ZDOInitDevice_3
    682          
    683              // Trigger the network start
    684              ZDApp_NetworkInit( extendedDelay );
   \                     ??ZDOInitDevice_7:
   \   0000B3                ; Setup parameters for call to function ZDApp_NetworkInit
   \   0000B3   EE           MOV     A,R6
   \   0000B4   FA           MOV     R2,A
   \   0000B5   EF           MOV     A,R7
   \   0000B6   FB           MOV     R3,A
   \   0000B7   12....       LCALL   ??ZDApp_NetworkInit?relay
    685            }
    686          
    687            // set broadcast address mask to support broadcast filtering
    688            NLME_SetBroadcastFilter( ZDO_Config_Node_Descriptor.CapabilityFlags );
   \                     ??ZDOInitDevice_6:
   \   0000BA                ; Setup parameters for call to function NLME_SetBroadcastFilter
   \   0000BA   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   0000BD   E0           MOVX    A,@DPTR
   \   0000BE   F9           MOV     R1,A
   \   0000BF   12....       LCALL   ??NLME_SetBroadcastFilter?relay
    689          
    690            return ( networkStateNV );
   \   0000C2   A9..         MOV     R1,?V0 + 0
   \                     ??ZDOInitDevice_8:
   \   0000C4   7402         MOV     A,#0x2
   \   0000C6   80..         SJMP    ??Subroutine43_0
    691          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine16:
   \   000000   7A10         MOV     R2,#0x10
   \   000002                REQUIRE ??Subroutine42_0
   \   000002                ; // Fall through to label ??Subroutine42_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine42_0:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   90....       MOV     DPTR,#ZDAppTaskID
   \   000005   E0           MOVX    A,@DPTR
   \   000006   F9           MOV     R1,A
   \   000007   12....       LCALL   ??osal_set_event?relay
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine43_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003                REQUIRE ??Subroutine44_0
   \   000003                ; // Fall through to label ??Subroutine44_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine44_0:
   \   000000   7F04         MOV     R7,#0x4
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006                REQUIRE ??Subroutine53_0
   \   000006                ; // Fall through to label ??Subroutine53_0
    692          
    693          /*********************************************************************
    694           * @fn      ZDApp_ReadNetworkRestoreState
    695           *
    696           * @brief   Read the ZCD_NV_STARTUP_OPTION NV Item to state whether
    697           *          or not to restore the network state.
    698           *          If the read value has the ZCD_STARTOPT_DEFAULT_NETWORK_STATE
    699           *          bit set return the ZDO_INITDEV_NEW_NETWORK_STATE.
    700           *
    701           * @param   none
    702           *
    703           * @return  ZDO_INITDEV_NEW_NETWORK_STATE
    704           *          or ZDO_INITDEV_RESTORED_NETWORK_STATE based on whether or
    705           *          not ZCD_STARTOPT_DEFAULT_NETWORK_STATE bit is set in
    706           *          ZCD_NV_STARTUP_OPTION
    707           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    708          uint8 ZDApp_ReadNetworkRestoreState( void )
   \                     ZDApp_ReadNetworkRestoreState:
    709          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    710            uint8 networkStateNV = ZDO_INITDEV_RESTORED_NETWORK_STATE;
   \   000005   7E00         MOV     R6,#0x0
    711          
    712            // Look for the New Network State option.
    713            if ( zgReadStartupOptions() & ZCD_STARTOPT_DEFAULT_NETWORK_STATE )
   \   000007                ; Setup parameters for call to function zgReadStartupOptions
   \   000007   12....       LCALL   ??zgReadStartupOptions?relay
   \   00000A   E9           MOV     A,R1
   \   00000B   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000D   5001         JNC     ??ZDApp_ReadNetworkRestoreState_0
    714            {
    715              networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
   \   00000F   0E           INC     R6
    716            }
    717          
    718            return ( networkStateNV );
   \                     ??ZDApp_ReadNetworkRestoreState_0:
   \   000010   EE           MOV     A,R6
   \   000011   F9           MOV     R1,A
   \   000012   02....       LJMP    ??Subroutine51_0 & 0xFFFF
    719          }
    720          
    721          /*********************************************************************
    722           * @fn      ZDAppDetermineDeviceType()
    723           *
    724           * @brief   Determines the type of device to start.
    725           *
    726           *          Looks at zgDeviceLogicalType and determines what type of
    727           *          device to start.  The types are:
    728           *            ZG_DEVICETYPE_COORDINATOR
    729           *            ZG_DEVICETYPE_ROUTER
    730           *            ZG_DEVICETYPE_ENDDEVICE
    731           *
    732           * @param   none
    733           *
    734           * @return  none
    735           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    736          void ZDAppDetermineDeviceType( void )
   \                     ZDAppDetermineDeviceType:
    737          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    738            if ( zgDeviceLogicalType == ZG_DEVICETYPE_COORDINATOR )
   \   000004   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000007   E0           MOVX    A,@DPTR
   \   000008   700E         JNZ     ??ZDAppDetermineDeviceType_0
    739            {
    740              devStartMode = MODE_HARD;     // Start as a coordinator
   \   00000A   90....       MOV     DPTR,#devStartMode
   \   00000D   7402         MOV     A,#0x2
   \   00000F   F0           MOVX    @DPTR,A
    741              ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_COORDINATOR;
   \   000010   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000013   E0           MOVX    A,@DPTR
   \   000014   54F8         ANL     A,#0xf8
   \   000016   802E         SJMP    ??ZDAppDetermineDeviceType_1
    742            }
    743            else
    744            {
    745              if ( zgDeviceLogicalType == ZG_DEVICETYPE_ROUTER  )
   \                     ??ZDAppDetermineDeviceType_0:
   \   000018   6401         XRL     A,#0x1
   \   00001A   700A         JNZ     ??ZDAppDetermineDeviceType_2
    746                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_ROUTER;
   \   00001C   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   54F8         ANL     A,#0xf8
   \   000022   4401         ORL     A,#0x1
   \   000024   800D         SJMP    ??ZDAppDetermineDeviceType_3
    747              else if ( zgDeviceLogicalType == ZG_DEVICETYPE_ENDDEVICE )
   \                     ??ZDAppDetermineDeviceType_2:
   \   000026   E0           MOVX    A,@DPTR
   \   000027   6402         XRL     A,#0x2
   \   000029   7009         JNZ     ??ZDAppDetermineDeviceType_4
    748                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_DEVICE;
   \   00002B   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   54F8         ANL     A,#0xf8
   \   000031   4402         ORL     A,#0x2
   \                     ??ZDAppDetermineDeviceType_3:
   \   000033   F0           MOVX    @DPTR,A
    749          
    750              // If AIB_apsUseExtendedPANID is set to a non-zero value by commissioning
    751              // The device shall do rejoin the network. Otherwise, do normal join
    752              if ( nwk_ExtPANIDValid( AIB_apsUseExtendedPANID ) == false )
   \                     ??ZDAppDetermineDeviceType_4:
   \   000034                ; Setup parameters for call to function nwk_ExtPANIDValid
   \   000034   7A..         MOV     R2,#AIB_apsUseExtendedPANID & 0xff
   \   000036   7B..         MOV     R3,#(AIB_apsUseExtendedPANID >> 8) & 0xff
   \   000038   12....       LCALL   ??nwk_ExtPANIDValid?relay
   \   00003B   E9           MOV     A,R1
   \   00003C   90....       MOV     DPTR,#devStartMode
   \   00003F   7003         JNZ     ??ZDAppDetermineDeviceType_5
    753              {
    754                devStartMode = MODE_JOIN;     // Assume joining
   \   000041   E4           CLR     A
   \   000042   8002         SJMP    ??ZDAppDetermineDeviceType_1
    755              }
    756              else
    757              {
    758                devStartMode = MODE_REJOIN;
   \                     ??ZDAppDetermineDeviceType_5:
   \   000044   7403         MOV     A,#0x3
   \                     ??ZDAppDetermineDeviceType_1:
   \   000046   F0           MOVX    @DPTR,A
    759              }
    760            }
    761          }
   \   000047   02....       LJMP    ??Subroutine47_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine47_0:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    762          
    763          /*********************************************************************
    764           * @fn      ZDApp_NetworkStartEvt()
    765           *
    766           * @brief   Process the Network Start Event
    767           *
    768           * @param   none
    769           *
    770           * @return  none
    771           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    772          void ZDApp_NetworkStartEvt( void )
   \                     ZDApp_NetworkStartEvt:
    773          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    774            if ( nwkStatus == ZSuccess )
   \   000004   90....       MOV     DPTR,#nwkStatus
   \   000007   E0           MOVX    A,@DPTR
   \   000008   7012         JNZ     ??ZDApp_NetworkStartEvt_0
    775            {
    776              // Successfully started a ZigBee network
    777              if ( devState == DEV_COORD_STARTING )
   \   00000A   90....       MOV     DPTR,#devState
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6408         XRL     A,#0x8
   \   000010   7003         JNZ     ??ZDApp_NetworkStartEvt_1
    778              {
    779                devState = DEV_ZB_COORD;
   \   000012   7409         MOV     A,#0x9
   \   000014   F0           MOVX    @DPTR,A
    780              }
    781          
    782              osal_pwrmgr_device( PWRMGR_ALWAYS_ON );
   \                     ??ZDApp_NetworkStartEvt_1:
   \   000015                ; Setup parameters for call to function osal_pwrmgr_device
   \   000015   7900         MOV     R1,#0x0
   \   000017   12....       LCALL   ??osal_pwrmgr_device?relay
    783              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00001A                ; Setup parameters for call to function osal_set_event
   \   00001A   802B         SJMP    ??ZDApp_NetworkStartEvt_2
    784            }
    785            else
    786            {
    787              // Try again with a higher energy threshold !!
    788              if ( ( NLME_GetEnergyThreshold() + ENERGY_SCAN_INCREMENT ) < 0xff )
   \                     ??ZDApp_NetworkStartEvt_0:
   \   00001C                ; Setup parameters for call to function NLME_GetEnergyThreshold
   \   00001C   12....       LCALL   ??NLME_GetEnergyThreshold?relay
   \   00001F   E9           MOV     A,R1
   \   000020   2410         ADD     A,#0x10
   \   000022   F8           MOV     R0,A
   \   000023   E4           CLR     A
   \   000024   3400         ADDC    A,#0x0
   \   000026   F9           MOV     R1,A
   \   000027   E8           MOV     A,R0
   \   000028   94FF         SUBB    A,#-0x1
   \   00002A   E9           MOV     A,R1
   \   00002B   9400         SUBB    A,#0x0
   \   00002D   C3           CLR     C
   \   00002E   65D0         XRL     A,PSW
   \   000030   33           RLC     A
   \   000031   500E         JNC     ??ZDApp_NetworkStartEvt_3
    789              {
    790                NLME_SetEnergyThreshold( (uint8)(NLME_GetEnergyThreshold() + ENERGY_SCAN_INCREMENT) );
   \   000033                ; Setup parameters for call to function NLME_SetEnergyThreshold
   \   000033                ; Setup parameters for call to function NLME_GetEnergyThreshold
   \   000033   12....       LCALL   ??NLME_GetEnergyThreshold?relay
   \   000036   E9           MOV     A,R1
   \   000037   2410         ADD     A,#0x10
   \   000039   F9           MOV     R1,A
   \   00003A   12....       LCALL   ??NLME_SetEnergyThreshold?relay
    791                osal_set_event( ZDAppTaskID, ZDO_NETWORK_INIT );
   \   00003D                ; Setup parameters for call to function osal_set_event
   \   00003D   7A01         MOV     R2,#0x1
   \   00003F   8008         SJMP    ??ZDApp_NetworkStartEvt_4
    792              }
    793              else
    794              {
    795                // Failed to start network. Enter a dormant state (until user intervenes)
    796                devState = DEV_INIT;
   \                     ??ZDApp_NetworkStartEvt_3:
   \   000041   90....       MOV     DPTR,#devState
   \   000044   7401         MOV     A,#0x1
   \   000046   F0           MOVX    @DPTR,A
    797                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000047                ; Setup parameters for call to function osal_set_event
   \                     ??ZDApp_NetworkStartEvt_2:
   \   000047   7A10         MOV     R2,#0x10
    798              }
    799            }
   \                     ??ZDApp_NetworkStartEvt_4:
   \   000049   12....       LCALL   ??Subroutine42_0 & 0xFFFF
    800          }
   \                     ??CrossCallReturnLabel_63:
   \   00004C   02....       LJMP    ??Subroutine47_0 & 0xFFFF
    801          
    802          /*********************************************************************
    803           * @fn      ZDApp_DeviceAuthEvt()
    804           *
    805           * @brief   Process the Device Authentic Event
    806           *
    807           * @param   none
    808           *
    809           * @return  none
    810           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    811          void ZDApp_DeviceAuthEvt( void )
   \                     ZDApp_DeviceAuthEvt:
    812          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    813            // received authentication from trust center
    814            if ( devState == DEV_END_DEVICE_UNAUTH )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6405         XRL     A,#0x5
   \   00000A   701F         JNZ     ??ZDApp_DeviceAuthEvt_0
    815            {
    816              // Stop the reset timer so it doesn't reset
    817              ZDApp_ResetTimerCancel();
   \   00000C                ; Setup parameters for call to function ZDApp_ResetTimerCancel
   \   00000C   12....       LCALL   ??ZDApp_ResetTimerCancel?relay
    818          
    819              devState = DEV_END_DEVICE;
   \   00000F   12....       LCALL   ?Subroutine8 & 0xFFFF
    820              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
    821          
    822              // Set the Power Manager Device
    823          #if defined ( POWER_SAVING )
    824             // osal_pwrmgr_device( PWRMGR_BATTERY );
    825          #endif
    826          
    827              if ( ZSTACK_ROUTER_BUILD )
    828              {
    829                if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
    830                {
    831                  // NOTE: first two parameters are not used, see NLMEDE.h for details
    832                  NLME_StartRouterRequest( 0, 0, false );
    833                }
    834              }
    835          
    836              // Notify to save info into NV
    837              ZDApp_NVUpdate();
   \                     ??CrossCallReturnLabel_66:
   \   000012                ; Setup parameters for call to function ZDApp_NVUpdate
   \   000012   12....       LCALL   ??ZDApp_NVUpdate?relay
    838          
    839              // Save off the security
    840              ZDApp_SaveNwkKey();
   \   000015                ; Setup parameters for call to function ZDApp_SaveNwkKey
   \   000015   12....       LCALL   ??ZDApp_SaveNwkKey?relay
    841          
    842              ZDApp_AnnounceNewAddress();
   \   000018                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   000018   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
    843          
    844              if ( (ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE) == 0 )
   \   00001B   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   A2E3         MOV     C,0xE0 /* A   */.3
   \   000021   400B         JC      ??ZDApp_DeviceAuthEvt_1
    845              {
    846                NLME_SetPollRate( ZDApp_SavedPollRate );
   \   000023                ; Setup parameters for call to function NLME_SetPollRate
   \   000023   90....       MOV     DPTR,#ZDApp_SavedPollRate
   \   000026   12....       LCALL   ?Subroutine24 & 0xFFFF
    847              }
    848            }
   \                     ??CrossCallReturnLabel_26:
   \   000029   8003         SJMP    ??ZDApp_DeviceAuthEvt_1
    849            else
    850            {
    851              ZDApp_NVUpdate();
   \                     ??ZDApp_DeviceAuthEvt_0:
   \   00002B                ; Setup parameters for call to function ZDApp_NVUpdate
   \   00002B   12....       LCALL   ??ZDApp_NVUpdate?relay
    852            }
    853          }
   \                     ??ZDApp_DeviceAuthEvt_1:
   \   00002E   02....       LJMP    ??Subroutine47_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   90....       MOV     DPTR,#devState
   \   000003   7406         MOV     A,#0x6
   \   000005                REQUIRE ??Subroutine45_0
   \   000005                ; // Fall through to label ??Subroutine45_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine24:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FA           MOV     R2,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FB           MOV     R3,A
   \   000005   12....       LCALL   ??NLME_SetPollRate?relay
   \   000008   22           RET
    854          
    855          /*********************************************************************
    856           * @fn      ZDApp_SaveNetworkStateEvt()
    857           *
    858           * @brief   Process the Save the Network State Event
    859           *
    860           * @param   none
    861           *
    862           * @return  none
    863           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    864          void ZDApp_SaveNetworkStateEvt( void )
   \                     ZDApp_SaveNetworkStateEvt:
    865          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    866          #if defined ( NV_RESTORE )
    867           #if defined ( NV_TURN_OFF_RADIO )
    868            // Turn off the radio's receiver during an NV update
    869            uint8 RxOnIdle;
    870            uint8 x = false;
    871            ZMacGetReq( ZMacRxOnIdle, &RxOnIdle );
    872            ZMacSetReq( ZMacRxOnIdle, &x );
    873           #endif
    874          
    875            // Update the Network State in NV
    876            NLME_UpdateNV( NWK_NV_NIB_ENABLE        |
    877                           NWK_NV_DEVICELIST_ENABLE |
    878                           NWK_NV_BINDING_ENABLE    |
    879                           NWK_NV_ADDRMGR_ENABLE );
   \   000004                ; Setup parameters for call to function NLME_UpdateNV
   \   000004   790F         MOV     R1,#0xf
   \   000006   12....       LCALL   ??NLME_UpdateNV?relay
    880          
    881            // Reset the NV startup option to resume from NV by
    882            // clearing the "New" join option.
    883            zgWriteStartupOptions( FALSE, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
   \   000009                ; Setup parameters for call to function zgWriteStartupOptions
   \   000009   7A02         MOV     R2,#0x2
   \   00000B   7900         MOV     R1,#0x0
   \   00000D   12....       LCALL   ??zgWriteStartupOptions?relay
    884          
    885           #if defined ( NV_TURN_OFF_RADIO )
    886            ZMacSetReq( ZMacRxOnIdle, &RxOnIdle );
    887           #endif
    888          #endif  // NV_RESTORE
    889          }
   \   000010   02....       LJMP    ??Subroutine47_0 & 0xFFFF
    890          
    891          /*********************************************************************
    892           * @fn      ZDApp_RestoreNetworkState()
    893           *
    894           * @brief   This function will restore the network state of the
    895           *          device if the network state is stored in NV.
    896           *
    897           * @param   none
    898           *
    899           * @return
    900           *    ZDO_INITDEV_RESTORED_NETWORK_STATE  - The device's network state was
    901           *          restored.
    902           *    ZDO_INITDEV_NEW_NETWORK_STATE - The network state was not used.
    903           *          This could mean that zgStartupOption said to not restore, or
    904           *          it could mean that there was no network state to restore.
    905           *
    906           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    907          uint8 ZDApp_RestoreNetworkState( void )
   \                     ZDApp_RestoreNetworkState:
    908          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    909            uint8 nvStat;
    910          
    911            // Initialize NWK NV items
    912            nvStat = NLME_InitNV();
   \   000005                ; Setup parameters for call to function NLME_InitNV
   \   000005   12....       LCALL   ??NLME_InitNV?relay
   \   000008   E9           MOV     A,R1
   \   000009   FE           MOV     R6,A
    913          
    914            if ( nvStat != NV_OPER_FAILED )
   \   00000A   740A         MOV     A,#0xa
   \   00000C   6E           XRL     A,R6
   \   00000D   6038         JZ      ??ZDApp_RestoreNetworkState_0
    915            {
    916              if ( NLME_RestoreFromNV() )
   \   00000F                ; Setup parameters for call to function NLME_RestoreFromNV
   \   00000F   12....       LCALL   ??NLME_RestoreFromNV?relay
   \   000012   E9           MOV     A,R1
   \   000013   6022         JZ      ??ZDApp_RestoreNetworkState_1
    917              {
    918                // Are we a coordinator
    919                ZDAppNwkAddr.addr.shortAddr = NLME_GetShortAddr();
   \   000015                ; Setup parameters for call to function NLME_GetShortAddr
   \   000015   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000018   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00001B   12....       LCALL   ??Subroutine53_0 & 0xFFFF
    920                if ( ZDAppNwkAddr.addr.shortAddr == 0 )
   \                     ??CrossCallReturnLabel_83:
   \   00001E   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000021   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_8:
   \   000024   7007         JNZ     ??ZDApp_RestoreNetworkState_2
    921                  ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_COORDINATOR;
   \   000026   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   54F8         ANL     A,#0xf8
   \   00002C   F0           MOVX    @DPTR,A
    922                devStartMode = MODE_RESUME;
   \                     ??ZDApp_RestoreNetworkState_2:
   \   00002D   90....       MOV     DPTR,#devStartMode
   \   000030   7401         MOV     A,#0x1
   \   000032   12....       LCALL   ?Subroutine9 & 0xFFFF
    923                osal_cpyExtAddr( ZDO_UseExtendedPANID, _NIB.extendedPANID );
    924              }
   \                     ??CrossCallReturnLabel_0:
   \   000035   8002         SJMP    ??ZDApp_RestoreNetworkState_3
    925              else
    926                nvStat = NV_ITEM_UNINIT;
   \                     ??ZDApp_RestoreNetworkState_1:
   \   000037   7E09         MOV     R6,#0x9
    927          
    928              if ( ZG_SECURE_ENABLED )
    929              {
    930                nwkFrameCounterChanges = 0;
   \                     ??ZDApp_RestoreNetworkState_3:
   \   000039   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   00003C   E4           CLR     A
   \   00003D   F0           MOVX    @DPTR,A
   \   00003E   A3           INC     DPTR
   \   00003F   F0           MOVX    @DPTR,A
    931          
    932                if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    933                {
    934                  ZDApp_RestoreNwkKey();
    935                }
    936              }
    937          
    938              // The default for RxOnWhenIdle is true for Routers and false for end devices
    939              // [setup in the NLME_RestoreFromNV()].  Change it here if you want something
    940              // other than default.
    941            }
    942          
    943            if ( nvStat == ZSUCCESS )
   \   000040   EE           MOV     A,R6
   \   000041   7004         JNZ     ??ZDApp_RestoreNetworkState_0
    944              return ( ZDO_INITDEV_RESTORED_NETWORK_STATE );
   \   000043   7900         MOV     R1,#0x0
   \   000045   8002         SJMP    ??ZDApp_RestoreNetworkState_4
    945            else
    946              return ( ZDO_INITDEV_NEW_NETWORK_STATE );
   \                     ??ZDApp_RestoreNetworkState_0:
   \   000047   7901         MOV     R1,#0x1
   \                     ??ZDApp_RestoreNetworkState_4:
   \   000049   02....       LJMP    ??Subroutine51_0 & 0xFFFF
    947          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function sAddrExtCpy
   \   000001                ; Setup parameters for call to function sAddrExtCpy
   \   000001   7C..         MOV     R4,#(_NIB + 53) & 0xff
   \   000003   7D..         MOV     R5,#((_NIB + 53) >> 8) & 0xff
   \   000005   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   000007   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000009   12....       LCALL   ??sAddrExtCpy?relay
   \   00000C   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   12....       LCALL   ?Subroutine39 & 0xFFFF
   \                     ??CrossCallReturnLabel_118:
   \   000003   E8           MOV     A,R0
   \   000004   49           ORL     A,R1
   \   000005   22           RET
    948          
    949          /*********************************************************************
    950           * @fn      ZDApp_InitUserDesc()
    951           *
    952           * @brief   Initialize the User Descriptor, the descriptor is read from NV
    953           *          when needed.  If you want to initialize the User descriptor to
    954           *          something other than all zero, do it here.
    955           *
    956           * @param   none
    957           *
    958           * @return  none
    959           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    960          void ZDApp_InitUserDesc( void )
   \                     ZDApp_InitUserDesc:
    961          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 17
   \   000005   74EF         MOV     A,#-0x11
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    962            UserDescriptorFormat_t ZDO_DefaultUserDescriptor;
    963          
    964            // Initialize the User Descriptor, the descriptor is read from NV
    965            // when needed.  If you want to initialize the User descriptor to something
    966            // other than all zero, do it here.
    967            osal_memset( &ZDO_DefaultUserDescriptor, 0, sizeof( UserDescriptorFormat_t ) );
   \   00000A                ; Setup parameters for call to function osal_memset
   \   00000A   7C11         MOV     R4,#0x11
   \   00000C   12....       LCALL   ?Subroutine30 & 0xFFFF
    968            if ( ZSUCCESS == osal_nv_item_init( ZCD_NV_USERDESC,
    969                   sizeof(UserDescriptorFormat_t), (void*)&ZDO_DefaultUserDescriptor ) )
   \                     ??CrossCallReturnLabel_37:
   \   00000F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000012   7C11         MOV     R4,#0x11
   \   000014   7D00         MOV     R5,#0x0
   \   000016   7A81         MOV     R2,#-0x7f
   \   000018   7B00         MOV     R3,#0x0
   \   00001A   12....       LCALL   ??osal_nv_item_init?relay
   \   00001D   7402         MOV     A,#0x2
   \   00001F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000022   E9           MOV     A,R1
   \   000023   702F         JNZ     ??ZDApp_InitUserDesc_0
    970            {
    971              if ( ZSUCCESS == osal_nv_read( ZCD_NV_USERDESC, 0,
    972                   sizeof(UserDescriptorFormat_t), (void*)&ZDO_DefaultUserDescriptor ) )
   \   000025                ; Setup parameters for call to function osal_nv_read
   \   000025   78..         MOV     R0,#?V0 + 0
   \   000027   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002A   75..11       MOV     ?V0 + 0,#0x11
   \   00002D   75..00       MOV     ?V0 + 1,#0x0
   \   000030   78..         MOV     R0,#?V0 + 0
   \   000032   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000035   7C00         MOV     R4,#0x0
   \   000037   7D00         MOV     R5,#0x0
   \   000039   7A81         MOV     R2,#-0x7f
   \   00003B   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_47:
   \   00003E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000041   E9           MOV     A,R1
   \   000042   7010         JNZ     ??ZDApp_InitUserDesc_0
    973              {
    974                if ( ZDO_DefaultUserDescriptor.len != 0 )
   \   000044   85..82       MOV     DPL,?XSP + 0
   \   000047   85..83       MOV     DPH,?XSP + 1
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   6007         JZ      ??ZDApp_InitUserDesc_0
    975                {
    976                  ZDO_Config_Node_Descriptor.UserDescAvail = TRUE;
   \   00004D   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000050   E0           MOVX    A,@DPTR
   \   000051   D2E4         SETB    0xE0 /* A   */.4
   \   000053   F0           MOVX    @DPTR,A
    977                }
    978              }
    979            }
    980          }
   \                     ??ZDApp_InitUserDesc_0:
   \   000054   7411         MOV     A,#0x11
   \   000056   02....       LJMP    ??Subroutine49_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine30:
   \   000000   7D00         MOV     R5,#0x0
   \   000002   7900         MOV     R1,#0x0
   \   000004   85..82       MOV     DPL,?XSP + 0
   \   000007   85..83       MOV     DPH,?XSP + 1
   \   00000A   AA82         MOV     R2,DPL
   \   00000C   AB83         MOV     R3,DPH
   \   00000E   12....       LCALL   ??osal_memset?relay
   \   000011                ; Setup parameters for call to function osal_nv_item_init
   \   000011                ; Setup parameters for call to function osal_nv_write
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   8582..       MOV     ?V0 + 0,DPL
   \   00001A   8583..       MOV     ?V0 + 1,DPH
   \   00001D   78..         MOV     R0,#?V0 + 0
   \   00001F   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine36:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_read?relay
   \   000005   7404         MOV     A,#0x4
   \   000007   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine49_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003                REQUIRE ??Subroutine50_0
   \   000003                ; // Fall through to label ??Subroutine50_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine50_0:
   \   000000   7F02         MOV     R7,#0x2
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    981          
    982          /*********************************************************************
    983           * @fn      ZDAppCheckForHoldKey()
    984           *
    985           * @brief   Check for key to set the device into Hold Auto Start
    986           *
    987           * @param   none
    988           *
    989           * @return  none
    990           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    991          void ZDAppCheckForHoldKey( void )
   \                     ZDAppCheckForHoldKey:
    992          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    993          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    994            // Get Keypad directly to see if a HOLD_START is needed.
    995            // Hold down the SW_BYPASS_START key (see OnBoard.h)
    996            // while booting to avoid starting up the device.
    997            if ( HalKeyRead () == SW_BYPASS_START)
    998            {
    999              
   1000              // Change the device state to HOLD on start up
   1001              devState = DEV_HOLD;
   1002            }
   1003          #endif // HAL_KEY
   1004          }
   \   000000   02....       LJMP    ?BRET
   1005          /*********************************************************************
   1006           * @fn      ZDApp_ProcessOSALMsg()
   1007           *
   1008           * @brief   Process the incoming task message.
   1009           *
   1010           * @param   msgPtr - message to process
   1011           *
   1012           * @return  none
   1013           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1014          void ZDApp_ProcessOSALMsg( osal_event_hdr_t *msgPtr )
   \                     ZDApp_ProcessOSALMsg:
   1015          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1016            // Data Confirmation message fields
   1017            uint8 sentEP;       // This should always be 0
   1018            uint8 sentStatus;
   1019            afDataConfirm_t *afDataConfirm;
   1020            uint8 tmp;
   1021          
   1022            switch ( msgPtr->event )
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   14           DEC     A
   \   000010   602A         JZ      ??ZDApp_ProcessOSALMsg_0
   \   000012   14           DEC     A
   \   000013   7003         JNZ     $+5
   \   000015   02....       LJMP    ??ZDApp_ProcessOSALMsg_1 & 0xFFFF
   \   000018   14           DEC     A
   \   000019   7003         JNZ     $+5
   \   00001B   02....       LJMP    ??ZDApp_ProcessOSALMsg_2 & 0xFFFF
   \   00001E   24E9         ADD     A,#-0x17
   \   000020   600E         JZ      ??ZDApp_ProcessOSALMsg_3
   \   000022   2447         ADD     A,#0x47
   \   000024   6010         JZ      ??ZDApp_ProcessOSALMsg_4
   \   000026   24D6         ADD     A,#-0x2a
   \   000028   7003         JNZ     $+5
   \   00002A   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   \   00002D   02....       LJMP    ??ZDApp_ProcessOSALMsg_6 & 0xFFFF
   1023            {
   1024              // Incoming ZDO Message
   1025              case AF_INCOMING_MSG_CMD:
   1026                ZDP_IncomingData( (afIncomingMSGPacket_t *)msgPtr );
   \                     ??ZDApp_ProcessOSALMsg_3:
   \   000030                ; Setup parameters for call to function ZDP_IncomingData
   \   000030   12....       LCALL   ??ZDP_IncomingData?relay
   1027                break;
   \   000033   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1028          
   1029              case ZDO_CB_MSG:
   1030                ZDApp_ProcessMsgCBs( (zdoIncomingMsg_t *)msgPtr );
   \                     ??ZDApp_ProcessOSALMsg_4:
   \   000036                ; Setup parameters for call to function ZDApp_ProcessMsgCBs
   \   000036   12....       LCALL   ??ZDApp_ProcessMsgCBs?relay
   1031                break;
   \   000039   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1032          
   1033              case AF_DATA_CONFIRM_CMD:
   1034                // This message is received as a confirmation of a data packet sent.
   1035                // The status is of ZStatus_t type [defined in NLMEDE.h]
   1036                // The message fields are defined in AF.h
   1037                afDataConfirm = (afDataConfirm_t *)msgPtr;
   1038                sentEP = afDataConfirm->endpoint;
   1039                sentStatus = afDataConfirm->hdr.status;
   1040          
   1041                // Action taken when confirmation is received.
   1042          #if defined ( ZIGBEE_FREQ_AGILITY )
   1043                if ( pZDNwkMgr_ProcessDataConfirm )
   1044                  pZDNwkMgr_ProcessDataConfirm( afDataConfirm );
   1045          #endif
   1046                (void)sentEP;
   1047                (void)sentStatus;
   1048                break;
   1049          
   1050              case ZDO_NWK_DISC_CNF:
   1051                if (devState != DEV_NWK_DISC)
   \                     ??ZDApp_ProcessOSALMsg_0:
   \   00003C   90....       MOV     DPTR,#devState
   \   00003F   E0           MOVX    A,@DPTR
   \   000040   6402         XRL     A,#0x2
   \   000042   6003         JZ      $+5
   \   000044   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1052                  break;
   1053          
   1054                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \   000047   90....       MOV     DPTR,#zgDeviceLogicalType
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   6401         XRL     A,#0x1
   \   00004D   6008         JZ      ??ZDApp_ProcessOSALMsg_7
   \   00004F   E0           MOVX    A,@DPTR
   \   000050   6402         XRL     A,#0x2
   \   000052   6003         JZ      $+5
   \   000054   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1055                {
   1056                  // Process the network discovery scan results and choose a parent
   1057                  // device to join/rejoin itself
   1058                  networkDesc_t *pChosenNwk;
   1059                  if ( ( (pChosenNwk = ZDApp_NwkDescListProcessing()) != NULL ) && (zdoDiscCounter > NUM_DISC_ATTEMPTS) )
   \                     ??ZDApp_ProcessOSALMsg_7:
   \   000057                ; Setup parameters for call to function ZDApp_NwkDescListProcessing
   \   000057   12....       LCALL   ??ZDApp_NwkDescListProcessing?relay
   \   00005A   8A..         MOV     ?V0 + 0,R2
   \   00005C   8B..         MOV     ?V0 + 1,R3
   \   00005E   A8..         MOV     R0,?V0 + 0
   \   000060   A9..         MOV     R1,?V0 + 1
   \   000062   E8           MOV     A,R0
   \   000063   FE           MOV     R6,A
   \   000064   E9           MOV     A,R1
   \   000065   FF           MOV     R7,A
   \   000066   E8           MOV     A,R0
   \   000067   49           ORL     A,R1
   \   000068   7003         JNZ     $+5
   \   00006A   02....       LJMP    ??ZDApp_ProcessOSALMsg_8 & 0xFFFF
   \   00006D   90....       MOV     DPTR,#zdoDiscCounter
   \   000070   E0           MOVX    A,@DPTR
   \   000071   C3           CLR     C
   \   000072   9403         SUBB    A,#0x3
   \   000074   5003         JNC     $+5
   \   000076   02....       LJMP    ??ZDApp_ProcessOSALMsg_8 & 0xFFFF
   1060                  {
   1061                    if ( devStartMode == MODE_JOIN )
   \   000079   90....       MOV     DPTR,#devStartMode
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   7059         JNZ     ??ZDApp_ProcessOSALMsg_9
   1062                    {
   1063                      devState = DEV_NWK_JOINING;
   \   00007F   90....       MOV     DPTR,#devState
   \   000082   7403         MOV     A,#0x3
   \   000084   12....       LCALL   ?Subroutine11 & 0xFFFF
   1064          
   1065                      ZDApp_NodeProfileSync( pChosenNwk->stackProfile);
   \                     ??CrossCallReturnLabel_2:
   \   000087   E0           MOVX    A,@DPTR
   \   000088   F9           MOV     R1,A
   \   000089   12....       LCALL   ??ZDApp_NodeProfileSync?relay
   1066          
   1067                      if ( NLME_JoinRequest( pChosenNwk->extendedPANID, pChosenNwk->panId,
   1068                                            pChosenNwk->logicalChannel,
   1069                                            ZDO_Config_Node_Descriptor.CapabilityFlags,
   1070                                            pChosenNwk->chosenRouter, pChosenNwk->chosenRouterDepth ) != ZSuccess )
   \   00008C                ; Setup parameters for call to function NLME_JoinRequest
   \   00008C   8E82         MOV     DPL,R6
   \   00008E   8F83         MOV     DPH,R7
   \   000090   A3           INC     DPTR
   \   000091   A3           INC     DPTR
   \   000092   A3           INC     DPTR
   \   000093   A3           INC     DPTR
   \   000094   A3           INC     DPTR
   \   000095   A3           INC     DPTR
   \   000096   A3           INC     DPTR
   \   000097   A3           INC     DPTR
   \   000098   A3           INC     DPTR
   \   000099   A3           INC     DPTR
   \   00009A   E0           MOVX    A,@DPTR
   \   00009B   F5..         MOV     ?V0 + 0,A
   \   00009D   78..         MOV     R0,#?V0 + 0
   \   00009F   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000A2   8E82         MOV     DPL,R6
   \   0000A4   8F83         MOV     DPH,R7
   \   0000A6   A3           INC     DPTR
   \   0000A7   A3           INC     DPTR
   \   0000A8   A3           INC     DPTR
   \   0000A9   A3           INC     DPTR
   \   0000AA   A3           INC     DPTR
   \   0000AB   A3           INC     DPTR
   \   0000AC   A3           INC     DPTR
   \   0000AD   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0000B0   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   0000B3   E0           MOVX    A,@DPTR
   \   0000B4   F5..         MOV     ?V0 + 0,A
   \   0000B6   78..         MOV     R0,#?V0 + 0
   \   0000B8   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000BB   8E82         MOV     DPL,R6
   \   0000BD   8F83         MOV     DPH,R7
   \   0000BF   A3           INC     DPTR
   \   0000C0   A3           INC     DPTR
   \   0000C1   E0           MOVX    A,@DPTR
   \   0000C2   F9           MOV     R1,A
   \   0000C3   12....       LCALL   ?Subroutine26 & 0xFFFF
   1071                      {
   1072                        ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1073                                                    + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   1074                      }
   1075                    } // if ( devStartMode == MODE_JOIN )
   \                     ??CrossCallReturnLabel_80:
   \   0000C6   EE           MOV     A,R6
   \   0000C7   240B         ADD     A,#0xb
   \   0000C9   FA           MOV     R2,A
   \   0000CA   EF           MOV     A,R7
   \   0000CB   3400         ADDC    A,#0x0
   \   0000CD   FB           MOV     R3,A
   \   0000CE   12....       LCALL   ??NLME_JoinRequest?relay
   \   0000D1   7404         MOV     A,#0x4
   \   0000D3   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000D6   806E         SJMP    ??ZDApp_ProcessOSALMsg_10
   1076                    else if ( devStartMode == MODE_REJOIN )
   \                     ??ZDApp_ProcessOSALMsg_9:
   \   0000D8   6403         XRL     A,#0x3
   \   0000DA   7070         JNZ     ??CrossCallReturnLabel_39
   1077                    {
   1078                      devState = DEV_NWK_REJOIN;
   \   0000DC   90....       MOV     DPTR,#devState
   \   0000DF   7404         MOV     A,#0x4
   \   0000E1   F0           MOVX    @DPTR,A
   1079          
   1080                      // Before trying to do rejoin, check if the device has a valid short address
   1081                      // If not, generate a random short address for itself
   1082                      if ( _NIB.nwkDevAddress == INVALID_NODE_ADDR )
   \   0000E2   90....       MOV     DPTR,#_NIB + 20
   \   0000E5   E0           MOVX    A,@DPTR
   \   0000E6   64FE         XRL     A,#0xfe
   \   0000E8   7003         JNZ     ??ZDApp_ProcessOSALMsg_11
   \   0000EA   A3           INC     DPTR
   \   0000EB   E0           MOVX    A,@DPTR
   \   0000EC   F4           CPL     A
   \                     ??ZDApp_ProcessOSALMsg_11:
   \   0000ED   7012         JNZ     ??ZDApp_ProcessOSALMsg_12
   1083                      {
   1084                        _NIB.nwkDevAddress = osal_rand();
   \   0000EF                ; Setup parameters for call to function osal_rand
   \   0000EF   12....       LCALL   ??osal_rand?relay
   \   0000F2   90....       MOV     DPTR,#_NIB + 20
   \   0000F5   12....       LCALL   ??Subroutine53_0 & 0xFFFF
   1085                        ZMacSetReq( ZMacShortAddress, (byte*)&_NIB.nwkDevAddress );
   \                     ??CrossCallReturnLabel_84:
   \   0000F8                ; Setup parameters for call to function ZMacSetReq
   \   0000F8   7A..         MOV     R2,#(_NIB + 20) & 0xff
   \   0000FA   7B..         MOV     R3,#((_NIB + 20) >> 8) & 0xff
   \   0000FC   7953         MOV     R1,#0x53
   \   0000FE   12....       LCALL   ??ZMacSetReq?relay
   1086                      }
   1087          
   1088                      if ( ZG_SECURE_ENABLED )
   1089                      {
   1090                        ZDApp_RestoreNwkKey();
   \                     ??ZDApp_ProcessOSALMsg_12:
   \   000101                ; Setup parameters for call to function ZDApp_RestoreNwkKey
   \   000101   12....       LCALL   ??ZDApp_RestoreNwkKey?relay
   1091                      }
   1092          
   1093                      // Check if the device has a valid PanID, if not, set it to the discovered Pan
   1094                      if ( _NIB.nwkPanId == INVALID_PAN_ID )
   \   000104   90....       MOV     DPTR,#_NIB + 33
   \   000107   E0           MOVX    A,@DPTR
   \   000108   64FE         XRL     A,#0xfe
   \   00010A   7003         JNZ     ??ZDApp_ProcessOSALMsg_13
   \   00010C   A3           INC     DPTR
   \   00010D   E0           MOVX    A,@DPTR
   \   00010E   F4           CPL     A
   \                     ??ZDApp_ProcessOSALMsg_13:
   \   00010F   7014         JNZ     ??ZDApp_ProcessOSALMsg_14
   1095                      {
   1096                        _NIB.nwkPanId = pChosenNwk->panId;
   \   000111   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_116:
   \   000114   90....       MOV     DPTR,#_NIB + 33
   \   000117   E8           MOV     A,R0
   \   000118   F0           MOVX    @DPTR,A
   \   000119   A3           INC     DPTR
   \   00011A   E9           MOV     A,R1
   \   00011B   F0           MOVX    @DPTR,A
   1097                        ZMacSetReq( ZMacPanId, (byte*)&(_NIB.nwkPanId) );
   \   00011C                ; Setup parameters for call to function ZMacSetReq
   \   00011C   7A..         MOV     R2,#(_NIB + 33) & 0xff
   \   00011E   7B..         MOV     R3,#((_NIB + 33) >> 8) & 0xff
   \   000120   7950         MOV     R1,#0x50
   \   000122   12....       LCALL   ??ZMacSetReq?relay
   1098                      }
   1099          
   1100                      tmp = true;
   \                     ??ZDApp_ProcessOSALMsg_14:
   \   000125   85..82       MOV     DPL,?XSP + 0
   \   000128   85..83       MOV     DPH,?XSP + 1
   \   00012B   7401         MOV     A,#0x1
   \   00012D   F0           MOVX    @DPTR,A
   1101                      ZMacSetReq( ZMacRxOnIdle, &tmp ); // Set receiver always on during rejoin
   \   00012E                ; Setup parameters for call to function ZMacSetReq
   \   00012E   AA82         MOV     R2,DPL
   \   000130   AB83         MOV     R3,DPH
   \   000132   7952         MOV     R1,#0x52
   \   000134   12....       LCALL   ??ZMacSetReq?relay
   1102                      if ( NLME_ReJoinRequest( ZDO_UseExtendedPANID, pChosenNwk->logicalChannel) != ZSuccess )
   \   000137                ; Setup parameters for call to function NLME_ReJoinRequest
   \   000137   8E82         MOV     DPL,R6
   \   000139   8F83         MOV     DPH,R7
   \   00013B   A3           INC     DPTR
   \   00013C   A3           INC     DPTR
   \   00013D   E0           MOVX    A,@DPTR
   \   00013E   F9           MOV     R1,A
   \   00013F   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   000141   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000143   12....       LCALL   ??NLME_ReJoinRequest?relay
   \                     ??ZDApp_ProcessOSALMsg_10:
   \   000146   E9           MOV     A,R1
   \   000147   6003         JZ      ??CrossCallReturnLabel_39
   1103                      {
   1104                        ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1105                                                    + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   \   000149                ; Setup parameters for call to function ZDApp_NetworkInit
   \   000149                ; Setup parameters for call to function osal_rand
   \   000149   12....       LCALL   ?Subroutine31 & 0xFFFF
   1106                      }
   1107                    } // else if ( devStartMode == MODE_REJOIN )
   1108          
   1109                    if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE )
   \                     ??CrossCallReturnLabel_39:
   \   00014C   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00014F   E0           MOVX    A,@DPTR
   \   000150   A2E3         MOV     C,0xE0 /* A   */.3
   \   000152   5005         JNC     ??ZDApp_ProcessOSALMsg_15
   1110                    {
   1111                      // The receiver is on, turn network layer polling off.
   1112                      NLME_SetPollRate( 0 );
   \   000154                ; Setup parameters for call to function NLME_SetPollRate
   \   000154   12....       LCALL   ?Subroutine35 & 0xFFFF
   1113                      NLME_SetQueuedPollRate( 0 );
   1114                      NLME_SetResponseRate( 0 );
   1115                    }
   \                     ??CrossCallReturnLabel_45:
   \   000157   8076         SJMP    ??ZDApp_ProcessOSALMsg_5
   1116                    else
   1117                    {
   1118                      if ( (ZG_SECURE_ENABLED) && (devStartMode == MODE_JOIN) )
   \                     ??ZDApp_ProcessOSALMsg_15:
   \   000159   90....       MOV     DPTR,#devStartMode
   \   00015C   E0           MOVX    A,@DPTR
   \   00015D   7070         JNZ     ??ZDApp_ProcessOSALMsg_5
   1119                      {
   1120                        ZDApp_SavedPollRate = zgPollRate;
   \   00015F   90....       MOV     DPTR,#zgPollRate
   \   000162   12....       LCALL   ??Subroutine58_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_114:
   \   000165   90....       MOV     DPTR,#ZDApp_SavedPollRate
   \   000168   E8           MOV     A,R0
   \   000169   F0           MOVX    @DPTR,A
   \   00016A   A3           INC     DPTR
   \   00016B   E9           MOV     A,R1
   \   00016C   F0           MOVX    @DPTR,A
   1121                        NLME_SetPollRate( zgRejoinPollRate );
   \   00016D                ; Setup parameters for call to function NLME_SetPollRate
   \   00016D   90....       MOV     DPTR,#zgRejoinPollRate
   \   000170   12....       LCALL   ?Subroutine24 & 0xFFFF
   1122                      }
   1123                    }
   1124                  }
   \                     ??CrossCallReturnLabel_27:
   \   000173   805A         SJMP    ??ZDApp_ProcessOSALMsg_5
   1125                  else
   1126                  {
   1127                    if ( continueJoining )
   \                     ??ZDApp_ProcessOSALMsg_8:
   \   000175   90....       MOV     DPTR,#continueJoining
   \   000178   E0           MOVX    A,@DPTR
   \   000179   6054         JZ      ??ZDApp_ProcessOSALMsg_5
   1128                    {
   1129              #if defined ( MANAGED_SCAN )
   1130                      ZDApp_NetworkInit( MANAGEDSCAN_DELAY_BETWEEN_SCANS );
   1131              #else
   1132                      zdoDiscCounter++;
   \   00017B   90....       MOV     DPTR,#zdoDiscCounter
   \   00017E   E0           MOVX    A,@DPTR
   \   00017F   04           INC     A
   \   000180   F0           MOVX    @DPTR,A
   1133                      ZDApp_NetworkInit( (uint16)(BEACON_REQUEST_DELAY
   1134                            + ((uint16)(osal_rand()& BEACON_REQ_DELAY_MASK))) );
   \   000181                ; Setup parameters for call to function ZDApp_NetworkInit
   \   000181                ; Setup parameters for call to function osal_rand
   \   000181   12....       LCALL   ??osal_rand?relay
   \   000184   EA           MOV     A,R2
   \   000185   2464         ADD     A,#0x64
   \   000187   FA           MOV     R2,A
   \   000188   E4           CLR     A
   \   000189   3400         ADDC    A,#0x0
   \   00018B   FB           MOV     R3,A
   \                     ??ZDApp_ProcessOSALMsg_16:
   \   00018C   12....       LCALL   ??ZDApp_NetworkInit?relay
   \   00018F   803E         SJMP    ??ZDApp_ProcessOSALMsg_5
   1135              #endif
   1136                    }
   1137                  }
   1138                }
   1139                break;
   1140          
   1141              case ZDO_NWK_JOIN_IND:
   1142                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessOSALMsg_1:
   \   000191   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000194   E0           MOVX    A,@DPTR
   \   000195   6401         XRL     A,#0x1
   \   000197   6005         JZ      ??ZDApp_ProcessOSALMsg_17
   \   000199   E0           MOVX    A,@DPTR
   \   00019A   6402         XRL     A,#0x2
   \   00019C   7031         JNZ     ??ZDApp_ProcessOSALMsg_5
   1143                {
   1144                  ZDApp_ProcessNetworkJoin();
   \                     ??ZDApp_ProcessOSALMsg_17:
   \   00019E                ; Setup parameters for call to function ZDApp_ProcessNetworkJoin
   \   00019E   12....       LCALL   ??ZDApp_ProcessNetworkJoin?relay
   \   0001A1   802C         SJMP    ??ZDApp_ProcessOSALMsg_5
   1145                }
   1146                break;
   1147          
   1148              case ZDO_NWK_JOIN_REQ:
   1149                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessOSALMsg_2:
   \   0001A3   90....       MOV     DPTR,#zgDeviceLogicalType
   \   0001A6   E0           MOVX    A,@DPTR
   \   0001A7   6401         XRL     A,#0x1
   \   0001A9   6005         JZ      ??ZDApp_ProcessOSALMsg_18
   \   0001AB   E0           MOVX    A,@DPTR
   \   0001AC   6402         XRL     A,#0x2
   \   0001AE   701F         JNZ     ??ZDApp_ProcessOSALMsg_5
   1150                {
   1151                  retryCnt = 0;
   \                     ??ZDApp_ProcessOSALMsg_18:
   \   0001B0   90....       MOV     DPTR,#retryCnt
   \   0001B3   E4           CLR     A
   \   0001B4   F0           MOVX    @DPTR,A
   1152                  devStartMode = MODE_RESUME;
   \   0001B5   90....       MOV     DPTR,#devStartMode
   \   0001B8   04           INC     A
   \   0001B9   F0           MOVX    @DPTR,A
   1153                  _tmpRejoinState = true;
   \   0001BA   90....       MOV     DPTR,#_tmpRejoinState
   \   0001BD   12....       LCALL   ?Subroutine9 & 0xFFFF
   1154                  osal_cpyExtAddr( ZDO_UseExtendedPANID, _NIB.extendedPANID );
   1155                  zgDefaultStartingScanDuration = BEACON_ORDER_60_MSEC;
   \                     ??CrossCallReturnLabel_1:
   \   0001C0   90....       MOV     DPTR,#zgDefaultStartingScanDuration
   \   0001C3   7402         MOV     A,#0x2
   \   0001C5   F0           MOVX    @DPTR,A
   1156                  ZDApp_NetworkInit( 0 );
   \   0001C6                ; Setup parameters for call to function ZDApp_NetworkInit
   \   0001C6   7A00         MOV     R2,#0x0
   \   0001C8   7B00         MOV     R3,#0x0
   \   0001CA   80C0         SJMP    ??ZDApp_ProcessOSALMsg_16
   1157                }
   1158                break;
   1159          
   1160              default:
   1161                if ( ZG_SECURE_ENABLED )
   1162                  ZDApp_ProcessSecMsg( msgPtr );
   \                     ??ZDApp_ProcessOSALMsg_6:
   \   0001CC                ; Setup parameters for call to function ZDApp_ProcessSecMsg
   \   0001CC   12....       LCALL   ??ZDApp_ProcessSecMsg?relay
   1163                break;
   1164            }
   1165          
   1166          }
   \                     ??ZDApp_ProcessOSALMsg_5:
   \   0001CF   7401         MOV     A,#0x1
   \   0001D1   02....       LJMP    ??Subroutine49_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine35:
   \   000000   7A00         MOV     R2,#0x0
   \   000002   7B00         MOV     R3,#0x0
   \   000004   12....       LCALL   ??NLME_SetPollRate?relay
   \   000007                ; Setup parameters for call to function NLME_SetQueuedPollRate
   \   000007                ; Setup parameters for call to function NLME_SetQueuedPollRate
   \   000007   7A00         MOV     R2,#0x0
   \   000009   7B00         MOV     R3,#0x0
   \   00000B   12....       LCALL   ??NLME_SetQueuedPollRate?relay
   \   00000E                ; Setup parameters for call to function NLME_SetResponseRate
   \   00000E                ; Setup parameters for call to function NLME_SetResponseRate
   \   00000E   7A00         MOV     R2,#0x0
   \   000010   7B00         MOV     R3,#0x0
   \   000012   12....       LCALL   ??NLME_SetResponseRate?relay
   \   000015   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine31:
   \   000000   12....       LCALL   ??osal_rand?relay
   \   000003   EA           MOV     A,R2
   \   000004   547F         ANL     A,#0x7f
   \   000006   2464         ADD     A,#0x64
   \   000008   FA           MOV     R2,A
   \   000009   7B00         MOV     R3,#0x0
   \   00000B   12....       LCALL   ??ZDApp_NetworkInit?relay
   \   00000E   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine26:
   \   000000   8E82         MOV     DPL,R6
   \   000002   8F83         MOV     DPH,R7
   \   000004                REQUIRE ??Subroutine52_0
   \   000004                ; // Fall through to label ??Subroutine52_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine52_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FC           MOV     R4,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FD           MOV     R5,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function ZDApp_NodeProfileSync
   \   000001   8E82         MOV     DPL,R6
   \   000003   8F83         MOV     DPH,R7
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine28:
   \   000000   8E82         MOV     DPL,R6
   \   000002   8F83         MOV     DPH,R7
   \   000004                REQUIRE ??Subroutine58_0
   \   000004                ; // Fall through to label ??Subroutine58_0
   1167          
   1168          /*********************************************************************
   1169           * @fn      ZDApp_ProcessMsgCBs()
   1170           *
   1171           * @brief   Process response messages
   1172           *
   1173           * @param   none
   1174           *
   1175           * @return  none
   1176           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1177          void ZDApp_ProcessMsgCBs( zdoIncomingMsg_t *inMsg )
   \                     ZDApp_ProcessMsgCBs:
   1178          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   1179            switch ( inMsg->clusterID )
   \   00000E   EE           MOV     A,R6
   \   00000F   240C         ADD     A,#0xc
   \   000011   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_101:
   \   000014   F5..         MOV     ?V0 + 0,A
   \   000016   A3           INC     DPTR
   \   000017   E0           MOVX    A,@DPTR
   \   000018   F5..         MOV     ?V0 + 1,A
   \   00001A   78..         MOV     R0,#?V0 + 0
   \   00001C   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for ZDApp_ProcessMsgCBs>_0`:
   \   00001F   0200         DW        2
   \   000021   2100         DW        33
   \   000023   2200         DW        34
   \   000025   ....         DW        ??ZDApp_ProcessMsgCBs_0
   \   000027   0080         DW        32768
   \   000029   0180         DW        32769
   \   00002B   ....         DW        ??ZDApp_ProcessMsgCBs_1
   \   00002D   0000         DW        0
   \   00002F   ....         DW        ??ZDApp_ProcessMsgCBs_2
   1180            {
   1181          #if defined ( ZDO_NWKADDR_REQUEST ) || defined ( ZDO_IEEEADDR_REQUEST ) || defined ( REFLECTOR )
   1182              case NWK_addr_rsp:
   1183              case IEEE_addr_rsp:
   1184                {
   1185                  ZDO_NwkIEEEAddrResp_t *pAddrRsp;
   1186                  pAddrRsp = ZDO_ParseAddrRsp( inMsg );
   \                     ??ZDApp_ProcessMsgCBs_1:
   \   000031                ; Setup parameters for call to function ZDO_ParseAddrRsp
   \   000031   12....       LCALL   ??ZDO_ParseAddrRsp?relay
   \   000034   8A..         MOV     ?V0 + 0,R2
   \   000036   8B..         MOV     ?V0 + 1,R3
   \   000038   AE..         MOV     R6,?V0 + 0
   \   00003A   AF..         MOV     R7,?V0 + 1
   1187                  if ( pAddrRsp )
   \   00003C   EE           MOV     A,R6
   \   00003D   4F           ORL     A,R7
   \   00003E   603D         JZ      ??ZDApp_ProcessMsgCBs_2
   1188                  {
   1189                    if ( pAddrRsp->status == ZSuccess )
   \   000040   8E82         MOV     DPL,R6
   \   000042   8F83         MOV     DPH,R7
   \   000044   E0           MOVX    A,@DPTR
   \   000045   700F         JNZ     ??ZDApp_ProcessMsgCBs_3
   1190                    {
   1191                      ZDO_UpdateAddrManager( pAddrRsp->nwkAddr, pAddrRsp->extAddr );
   \   000047                ; Setup parameters for call to function ZDO_UpdateAddrManager
   \   000047   EE           MOV     A,R6
   \   000048   2403         ADD     A,#0x3
   \   00004A   FC           MOV     R4,A
   \   00004B   EF           MOV     A,R7
   \   00004C   3400         ADDC    A,#0x0
   \   00004E   FD           MOV     R5,A
   \   00004F   A3           INC     DPTR
   \   000050   12....       LCALL   ?Subroutine25 & 0xFFFF
   1192                    }
   \                     ??CrossCallReturnLabel_28:
   \   000053   12....       LCALL   ??ZDO_UpdateAddrManager?relay
   1193                    osal_mem_free( pAddrRsp );
   \                     ??ZDApp_ProcessMsgCBs_3:
   \   000056                ; Setup parameters for call to function osal_mem_free
   \   000056   EE           MOV     A,R6
   \   000057   FA           MOV     R2,A
   \   000058   EF           MOV     A,R7
   \   000059   FB           MOV     R3,A
   \   00005A   12....       LCALL   ??osal_mem_free?relay
   \   00005D   801E         SJMP    ??ZDApp_ProcessMsgCBs_2
   1194                  }
   1195                }
   1196                break;
   1197          #endif
   1198          
   1199          #if defined ( REFLECTOR )
   1200              case Bind_req:
   1201              case Unbind_req:
   1202                {
   1203                  ZDO_BindUnbindReq_t bindReq;
   1204                  ZDO_ParseBindUnbindReq( inMsg, &bindReq );
   \                     ??ZDApp_ProcessMsgCBs_0:
   \   00005F                ; Setup parameters for call to function ZDO_ParseBindUnbindReq
   \   00005F   85..82       MOV     DPL,?XSP + 0
   \   000062   85..83       MOV     DPH,?XSP + 1
   \   000065   AC82         MOV     R4,DPL
   \   000067   AD83         MOV     R5,DPH
   \   000069   12....       LCALL   ??ZDO_ParseBindUnbindReq?relay
   1205                  ZDO_ProcessBindUnbindReq( inMsg, &bindReq );
   \   00006C                ; Setup parameters for call to function ZDO_ProcessBindUnbindReq
   \   00006C   85..82       MOV     DPL,?XSP + 0
   \   00006F   85..83       MOV     DPH,?XSP + 1
   \   000072   AC82         MOV     R4,DPL
   \   000074   AD83         MOV     R5,DPH
   \   000076   EE           MOV     A,R6
   \   000077   FA           MOV     R2,A
   \   000078   EF           MOV     A,R7
   \   000079   FB           MOV     R3,A
   \   00007A   12....       LCALL   ??ZDO_ProcessBindUnbindReq?relay
   1206                }
   1207                break;
   1208          #endif
   1209          
   1210          #if ( ZG_BUILD_COORDINATOR_TYPE )
   1211              case Bind_rsp:
   1212              case Unbind_rsp:
   1213                if (ZG_DEVICE_COORDINATOR_TYPE && matchED)
   1214                {
   1215                  ZDMatchSendState(
   1216                       (uint8)((inMsg->clusterID == Bind_rsp) ? ZDMATCH_REASON_BIND_RSP : ZDMATCH_REASON_UNBIND_RSP),
   1217                       ZDO_ParseBindRsp(inMsg), inMsg->TransSeq );
   1218                }
   1219                break;
   1220          
   1221              case End_Device_Bind_req:
   1222                if (ZG_DEVICE_COORDINATOR_TYPE)
   1223                {
   1224                  ZDEndDeviceBind_t bindReq;
   1225                  ZDO_ParseEndDeviceBindReq( inMsg, &bindReq );
   1226                  ZDO_MatchEndDeviceBind( &bindReq );
   1227          
   1228                  // Freeing the cluster lists - if allocated.
   1229                  if ( bindReq.numInClusters )
   1230                    osal_mem_free( bindReq.inClusters );
   1231                  if ( bindReq.numOutClusters )
   1232                    osal_mem_free( bindReq.outClusters );
   1233                }
   1234                break;
   1235          #endif
   1236            }
   1237          }
   \                     ??ZDApp_ProcessMsgCBs_2:
   \   00007D                REQUIRE ?Subroutine6
   \   00007D                ; // Fall through to label ?Subroutine6

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   7415         MOV     A,#0x15
   \   000002   02....       LJMP    ??Subroutine49_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine25:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FA           MOV     R2,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FB           MOV     R3,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine55_0:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F583         MOV     DPH,A
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine56_0:
   \   000000   F582         MOV     DPL,A
   \   000002   EF           MOV     A,R7
   \   000003                REQUIRE ??Subroutine57_0
   \   000003                ; // Fall through to label ??Subroutine57_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine57_0:
   \   000000   12....       LCALL   ??Subroutine55_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_112:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   22           RET
   1238          
   1239          /*********************************************************************
   1240           * @fn      ZDApp_RegisterCBs()
   1241           *
   1242           * @brief   Process response messages
   1243           *
   1244           * @param   none
   1245           *
   1246           * @return  none
   1247           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1248          void ZDApp_RegisterCBs( void )
   \                     ZDApp_RegisterCBs:
   1249          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1250          #if defined ( ZDO_IEEEADDR_REQUEST ) || defined ( REFLECTOR )
   1251            ZDO_RegisterForZDOMsg( ZDAppTaskID, IEEE_addr_rsp );
   \   000004                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000004   7A01         MOV     R2,#0x1
   \   000006   12....       LCALL   ?Subroutine21 & 0xFFFF
   1252          #endif
   1253          #if defined ( ZDO_NWKADDR_REQUEST ) || defined ( REFLECTOR )
   1254            ZDO_RegisterForZDOMsg( ZDAppTaskID, NWK_addr_rsp );
   \                     ??CrossCallReturnLabel_69:
   \   000009                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000009   7A00         MOV     R2,#0x0
   \   00000B   12....       LCALL   ?Subroutine21 & 0xFFFF
   1255          #endif
   1256          #if ZG_BUILD_COORDINATOR_TYPE
   1257            ZDO_RegisterForZDOMsg( ZDAppTaskID, Bind_rsp );
   1258            ZDO_RegisterForZDOMsg( ZDAppTaskID, Unbind_rsp );
   1259            ZDO_RegisterForZDOMsg( ZDAppTaskID, End_Device_Bind_req );
   1260          #endif
   1261          #if defined ( REFLECTOR )
   1262            ZDO_RegisterForZDOMsg( ZDAppTaskID, Bind_req );
   \                     ??CrossCallReturnLabel_70:
   \   00000E                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00000E   7A21         MOV     R2,#0x21
   \   000010   7B00         MOV     R3,#0x0
   \   000012   12....       LCALL   ??Subroutine46_0 & 0xFFFF
   1263            ZDO_RegisterForZDOMsg( ZDAppTaskID, Unbind_req );
   \                     ??CrossCallReturnLabel_71:
   \   000015                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000015   7A22         MOV     R2,#0x22
   \   000017   7B00         MOV     R3,#0x0
   \   000019   12....       LCALL   ??Subroutine46_0 & 0xFFFF
   1264          #endif
   1265          }
   \                     ??CrossCallReturnLabel_72:
   \   00001C   02....       LJMP    ??Subroutine47_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine21:
   \   000000   7B80         MOV     R3,#-0x80
   \   000002                REQUIRE ??Subroutine46_0
   \   000002                ; // Fall through to label ??Subroutine46_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine46_0:
   \   000000   90....       MOV     DPTR,#ZDAppTaskID
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   \   000008   22           RET
   1266          
   1267          /*********************************************************************
   1268           * @fn      ZDApp_ProcessSecMsg()
   1269           *
   1270           * @brief   Process the incoming security message.
   1271           *
   1272           * @param   msgPtr - message to process
   1273           *
   1274           * @return  none
   1275           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1276          void ZDApp_ProcessSecMsg( osal_event_hdr_t *msgPtr )
   \                     ZDApp_ProcessSecMsg:
   1277          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1278            switch ( msgPtr->event )
   \   000004   8A82         MOV     DPL,R2
   \   000006   8B83         MOV     DPH,R3
   \   000008   E0           MOVX    A,@DPTR
   \   000009   24FA         ADD     A,#-0x6
   \   00000B   6006         JZ      ??ZDApp_ProcessSecMsg_0
   \   00000D   24FC         ADD     A,#-0x4
   \   00000F   6014         JZ      ??ZDApp_ProcessSecMsg_1
   \   000011   8022         SJMP    ??ZDApp_ProcessSecMsg_2
   1279            {
   1280              case ZDO_ESTABLISH_KEY_CFM:
   1281                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1282                {
   1283                  ZDSecMgrEstablishKeyCfm( (ZDO_EstablishKeyCfm_t*)msgPtr );
   1284                }
   1285                break;
   1286          
   1287              case ZDO_ESTABLISH_KEY_IND:
   1288                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1289                {
   1290                  if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   1291                  {
   1292                    ZDSecMgrEstablishKeyInd( (ZDO_EstablishKeyInd_t*)msgPtr );
   1293                  }
   1294                }
   1295                break;
   1296          
   1297              case ZDO_TRANSPORT_KEY_IND:
   1298                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessSecMsg_0:
   \   000013   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000016   E0           MOVX    A,@DPTR
   \   000017   6401         XRL     A,#0x1
   \   000019   6005         JZ      ??ZDApp_ProcessSecMsg_3
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   6402         XRL     A,#0x2
   \   00001E   7015         JNZ     ??ZDApp_ProcessSecMsg_2
   1299                {
   1300                  ZDSecMgrTransportKeyInd( (ZDO_TransportKeyInd_t*)msgPtr );
   \                     ??ZDApp_ProcessSecMsg_3:
   \   000020                ; Setup parameters for call to function ZDSecMgrTransportKeyInd
   \   000020   12....       LCALL   ??ZDSecMgrTransportKeyInd?relay
   \   000023   8010         SJMP    ??ZDApp_ProcessSecMsg_2
   1301                }
   1302                break;
   1303          
   1304              case ZDO_UPDATE_DEVICE_IND:
   1305                if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
   1306                {
   1307                  ZDSecMgrUpdateDeviceInd( (ZDO_UpdateDeviceInd_t*)msgPtr );
   1308                }
   1309                break;
   1310          
   1311              case ZDO_REMOVE_DEVICE_IND:
   1312                if ( ZG_BUILD_RTRONLY_TYPE && ( zgDeviceLogicalType == ZG_DEVICETYPE_ROUTER ) )
   1313                {
   1314                  ZDSecMgrRemoveDeviceInd( (ZDO_RemoveDeviceInd_t*)msgPtr );
   1315                }
   1316                break;
   1317          
   1318              case ZDO_REQUEST_KEY_IND:
   1319                if (( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH ) ||
   1320                    ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD ))
   1321                {
   1322                  if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
   1323                  {
   1324                    ZDSecMgrRequestKeyInd( (ZDO_RequestKeyInd_t*)msgPtr );
   1325                  }
   1326                }
   1327                break;
   1328          
   1329              case ZDO_SWITCH_KEY_IND:
   1330                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessSecMsg_1:
   \   000025   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000028   E0           MOVX    A,@DPTR
   \   000029   6401         XRL     A,#0x1
   \   00002B   6005         JZ      ??ZDApp_ProcessSecMsg_4
   \   00002D   E0           MOVX    A,@DPTR
   \   00002E   6402         XRL     A,#0x2
   \   000030   7003         JNZ     ??ZDApp_ProcessSecMsg_2
   1331                {
   1332                  ZDSecMgrSwitchKeyInd( (ZDO_SwitchKeyInd_t*)msgPtr );
   \                     ??ZDApp_ProcessSecMsg_4:
   \   000032                ; Setup parameters for call to function ZDSecMgrSwitchKeyInd
   \   000032   12....       LCALL   ??ZDSecMgrSwitchKeyInd?relay
   1333                }
   1334                break;
   1335          
   1336              case ZDO_AUTHENTICATE_IND:
   1337                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1338                {
   1339                  ZDSecMgrAuthenticateInd( (ZDO_AuthenticateInd_t*)msgPtr );
   1340                }
   1341                break;
   1342          
   1343              case ZDO_AUTHENTICATE_CFM:
   1344                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1345                {
   1346                  ZDSecMgrAuthenticateCfm( (ZDO_AuthenticateCfm_t*)msgPtr );
   1347                }
   1348                break;
   1349          
   1350              default:
   1351                // Unsupported messages
   1352                break;
   1353            }
   1354          }
   \                     ??ZDApp_ProcessSecMsg_2:
   \   000035   02....       LJMP    ??Subroutine47_0 & 0xFFFF
   1355          
   1356          /*********************************************************************
   1357           * @fn      ZDApp_ProcessNetworkJoin()
   1358           *
   1359           * @brief
   1360           *
   1361           *   Save off the Network key information.
   1362           *
   1363           * @param   none
   1364           *
   1365           * @return  none
   1366           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1367          void ZDApp_ProcessNetworkJoin( void )
   \                     ZDApp_ProcessNetworkJoin:
   1368          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1369            if ( (devState == DEV_NWK_JOINING) ||
   1370                ((devState == DEV_NWK_ORPHAN)  &&
   1371                 (ZDO_Config_Node_Descriptor.LogicalType == NODETYPE_ROUTER)) )
   \   00000A   90....       MOV     DPTR,#devState
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6403         XRL     A,#0x3
   \   000010   6015         JZ      ??ZDApp_ProcessNetworkJoin_0
   \   000012   E0           MOVX    A,@DPTR
   \   000013   640A         XRL     A,#0xa
   \   000015   6003         JZ      $+5
   \   000017   02....       LJMP    ??ZDApp_ProcessNetworkJoin_1 & 0xFFFF
   \   00001A   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   5407         ANL     A,#0x7
   \   000020   6401         XRL     A,#0x1
   \   000022   6003         JZ      $+5
   \   000024   02....       LJMP    ??ZDApp_ProcessNetworkJoin_2 & 0xFFFF
   1372            {
   1373              // Result of a Join attempt by this device.
   1374              if ( nwkStatus == ZSuccess )
   \                     ??ZDApp_ProcessNetworkJoin_0:
   \   000027   90....       MOV     DPTR,#nwkStatus
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   702A         JNZ     ??ZDApp_ProcessNetworkJoin_3
   1375              {
   1376                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00002D                ; Setup parameters for call to function osal_set_event
   \   00002D   12....       LCALL   ?Subroutine16 & 0xFFFF
   1377          
   1378          #if defined ( POWER_SAVING )
   1379               // osal_pwrmgr_device( PWRMGR_BATTERY );
   1380          #endif
   1381          
   1382                if ( ZG_SECURE_ENABLED && ( ZDApp_RestoreNwkKey() == false ) )
   \                     ??CrossCallReturnLabel_60:
   \   000030                ; Setup parameters for call to function ZDApp_RestoreNwkKey
   \   000030   12....       LCALL   ??ZDApp_RestoreNwkKey?relay
   \   000033   E9           MOV     A,R1
   \   000034   90....       MOV     DPTR,#devState
   \   000037   700D         JNZ     ??ZDApp_ProcessNetworkJoin_4
   1383                {
   1384                  // wait for auth from trust center!!
   1385                  devState = DEV_END_DEVICE_UNAUTH;
   \   000039   7405         MOV     A,#0x5
   \   00003B   F0           MOVX    @DPTR,A
   1386          
   1387                  // Start the reset timer for MAX UNAUTH time
   1388                  ZDApp_ResetTimerStart( 10000 );//MAX_DEVICE_UNAUTH_TIMEOUT );
   \   00003C                ; Setup parameters for call to function osal_start_timerEx
   \   00003C   7C10         MOV     R4,#0x10
   \   00003E   7D27         MOV     R5,#0x27
   \   000040   12....       LCALL   ?Subroutine17 & 0xFFFF
   1389                }
   \                     ??CrossCallReturnLabel_122:
   \   000043   02....       LJMP    ??CrossCallReturnLabel_61 & 0xFFFF
   1390                else
   1391                {
   1392                  if ( ZSTACK_ROUTER_BUILD )
   1393                  {
   1394                    if ( devState == DEV_NWK_ORPHAN
   1395                      && ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   1396                    {
   1397                      // Change NIB state to router for restore
   1398                      _NIB.nwkState = NWK_ROUTER;
   1399                    }
   1400                  }
   1401          
   1402                  if ( devState == DEV_NWK_JOINING )
   \                     ??ZDApp_ProcessNetworkJoin_4:
   \   000046   E0           MOVX    A,@DPTR
   \   000047   6403         XRL     A,#0x3
   \   000049   7003         JNZ     ??ZDApp_ProcessNetworkJoin_5
   1403                  {
   1404                    ZDApp_AnnounceNewAddress();
   \   00004B                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   00004B   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   1405                  }
   1406          
   1407                  devState = DEV_END_DEVICE;
   \                     ??ZDApp_ProcessNetworkJoin_5:
   \   00004E   90....       MOV     DPTR,#devState
   \   000051   7406         MOV     A,#0x6
   \   000053   F0           MOVX    @DPTR,A
   1408                  if ( ZSTACK_ROUTER_BUILD )
   \   000054   02....       LJMP    ??CrossCallReturnLabel_61 & 0xFFFF
   1409                  {
   1410                    // NOTE: first two parameters are not used, see NLMEDE.h for details
   1411                    if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   1412                    {
   1413                      NLME_StartRouterRequest( 0, 0, false );
   1414                    }
   1415                  }
   1416                }
   1417              }
   1418              else
   1419              {
   1420                if ( (devStartMode == MODE_RESUME) && (++retryCnt >= MAX_RESUME_RETRY) )
   \                     ??ZDApp_ProcessNetworkJoin_3:
   \   000057   90....       MOV     DPTR,#devStartMode
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   6401         XRL     A,#0x1
   \   00005D   7031         JNZ     ??ZDApp_ProcessNetworkJoin_6
   \   00005F   90....       MOV     DPTR,#retryCnt
   \   000062   E0           MOVX    A,@DPTR
   \   000063   04           INC     A
   \   000064   F0           MOVX    @DPTR,A
   \   000065   C3           CLR     C
   \   000066   9403         SUBB    A,#0x3
   \   000068   4026         JC      ??ZDApp_ProcessNetworkJoin_6
   1421                {
   1422                  if ( _NIB.nwkPanId == 0xFFFF || _NIB.nwkPanId == INVALID_PAN_ID )
   \   00006A   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_33:
   \   00006D   7003         JNZ     ??ZDApp_ProcessNetworkJoin_7
   \   00006F   74FF         MOV     A,#-0x1
   \   000071   69           XRL     A,R1
   \                     ??ZDApp_ProcessNetworkJoin_7:
   \   000072   600A         JZ      ??ZDApp_ProcessNetworkJoin_8
   \   000074   74FE         MOV     A,#-0x2
   \   000076   68           XRL     A,R0
   \   000077   7003         JNZ     ??ZDApp_ProcessNetworkJoin_9
   \   000079   74FF         MOV     A,#-0x1
   \   00007B   69           XRL     A,R1
   \                     ??ZDApp_ProcessNetworkJoin_9:
   \   00007C   7006         JNZ     ??ZDApp_ProcessNetworkJoin_10
   1423                    devStartMode = MODE_JOIN;
   \                     ??ZDApp_ProcessNetworkJoin_8:
   \   00007E   90....       MOV     DPTR,#devStartMode
   \   000081   E4           CLR     A
   \   000082   800B         SJMP    ??ZDApp_ProcessNetworkJoin_11
   1424                  else
   1425                  {
   1426                    devStartMode = MODE_REJOIN;
   \                     ??ZDApp_ProcessNetworkJoin_10:
   \   000084   90....       MOV     DPTR,#devStartMode
   \   000087   7403         MOV     A,#0x3
   \   000089   F0           MOVX    @DPTR,A
   1427                    _tmpRejoinState = true;
   \   00008A   90....       MOV     DPTR,#_tmpRejoinState
   \   00008D   7401         MOV     A,#0x1
   \                     ??ZDApp_ProcessNetworkJoin_11:
   \   00008F   F0           MOVX    @DPTR,A
   1428                  }
   1429                }
   1430          
   1431                if ( (NLME_GetShortAddr() != INVALID_NODE_ADDR) ||
   1432                     (_NIB.nwkDevAddress != INVALID_NODE_ADDR) )
   \                     ??ZDApp_ProcessNetworkJoin_6:
   \   000090                ; Setup parameters for call to function NLME_GetShortAddr
   \   000090   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000093   8A..         MOV     ?V0 + 0,R2
   \   000095   8B..         MOV     ?V0 + 1,R3
   \   000097   74FE         MOV     A,#-0x2
   \   000099   65..         XRL     A,?V0 + 0
   \   00009B   7004         JNZ     ??ZDApp_ProcessNetworkJoin_12
   \   00009D   74FF         MOV     A,#-0x1
   \   00009F   65..         XRL     A,?V0 + 1
   \                     ??ZDApp_ProcessNetworkJoin_12:
   \   0000A1   700D         JNZ     ??ZDApp_ProcessNetworkJoin_13
   \   0000A3   90....       MOV     DPTR,#_NIB + 20
   \   0000A6   E0           MOVX    A,@DPTR
   \   0000A7   64FE         XRL     A,#0xfe
   \   0000A9   7003         JNZ     ??ZDApp_ProcessNetworkJoin_14
   \   0000AB   A3           INC     DPTR
   \   0000AC   E0           MOVX    A,@DPTR
   \   0000AD   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_14:
   \   0000AE   601C         JZ      ??ZDApp_ProcessNetworkJoin_15
   1433                {
   1434                  uint16 addr = INVALID_NODE_ADDR;
   \                     ??ZDApp_ProcessNetworkJoin_13:
   \   0000B0   85..82       MOV     DPL,?XSP + 0
   \   0000B3   85..83       MOV     DPH,?XSP + 1
   \   0000B6   74FE         MOV     A,#-0x2
   \   0000B8   F0           MOVX    @DPTR,A
   \   0000B9   A3           INC     DPTR
   \   0000BA   04           INC     A
   \   0000BB   F0           MOVX    @DPTR,A
   1435                  // Invalidate nwk addr so end device does not use in its data reqs.
   1436                  _NIB.nwkDevAddress = INVALID_NODE_ADDR;
   \   0000BC   90....       MOV     DPTR,#_NIB + 20
   \   0000BF   14           DEC     A
   \   0000C0   12....       LCALL   ?Subroutine12 & 0xFFFF
   1437                  ZMacSetReq( ZMacShortAddress, (uint8 *)&addr );
   1438                }
   \                     ??CrossCallReturnLabel_4:
   \   0000C3   AA82         MOV     R2,DPL
   \   0000C5   AB83         MOV     R3,DPH
   \   0000C7   7953         MOV     R1,#0x53
   \   0000C9   12....       LCALL   ??ZMacSetReq?relay
   1439          
   1440                // Clear the neighbor Table and network discovery tables.
   1441                nwkNeighborInitTable();
   \                     ??ZDApp_ProcessNetworkJoin_15:
   \   0000CC                ; Setup parameters for call to function nwkNeighborInitTable
   \   0000CC   12....       LCALL   ??nwkNeighborInitTable?relay
   1442                NLME_NwkDiscTerm();
   \   0000CF                ; Setup parameters for call to function NLME_NwkDiscTerm
   \   0000CF   12....       LCALL   ??NLME_NwkDiscTerm?relay
   1443          
   1444                zdoDiscCounter = 1;
   \   0000D2   90....       MOV     DPTR,#zdoDiscCounter
   \   0000D5   7401         MOV     A,#0x1
   \   0000D7   F0           MOVX    @DPTR,A
   1445          
   1446          //      ZDApp_NetworkInit( (uint16)
   1447          //                         ((NWK_START_DELAY * (osal_rand() & 0x0F)) +
   1448          //                          (NWK_START_DELAY * 5)) );
   1449                ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1450                     + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   \   0000D8                ; Setup parameters for call to function ZDApp_NetworkInit
   \   0000D8                ; Setup parameters for call to function osal_rand
   1451              }
   1452            }
   \                     ??ZDApp_ProcessNetworkJoin_16:
   \   0000D8   12....       LCALL   ?Subroutine31 & 0xFFFF
   \                     ??CrossCallReturnLabel_40:
   \   0000DB   807A         SJMP    ??CrossCallReturnLabel_61
   1453            else if ( devState == DEV_NWK_ORPHAN || devState == DEV_NWK_REJOIN )
   \                     ??ZDApp_ProcessNetworkJoin_1:
   \   0000DD   E0           MOVX    A,@DPTR
   \   0000DE   6404         XRL     A,#0x4
   \   0000E0   7067         JNZ     ??ZDApp_ProcessNetworkJoin_17
   1454            {
   1455              // results of an orphaning attempt by this device
   1456              if (nwkStatus == ZSuccess)
   \                     ??ZDApp_ProcessNetworkJoin_2:
   \   0000E2   90....       MOV     DPTR,#nwkStatus
   \   0000E5   E0           MOVX    A,@DPTR
   \   0000E6   7016         JNZ     ??ZDApp_ProcessNetworkJoin_18
   1457              {
   1458                if ( ZG_SECURE_ENABLED )
   1459                {
   1460                  ZDApp_RestoreNwkKey();
   \   0000E8                ; Setup parameters for call to function ZDApp_RestoreNwkKey
   \   0000E8   12....       LCALL   ??ZDApp_RestoreNwkKey?relay
   1461                }
   1462          
   1463                devState = DEV_END_DEVICE;
   \   0000EB   12....       LCALL   ?Subroutine8 & 0xFFFF
   1464                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   1465                // setup Power Manager Device
   1466          #if defined ( POWER_SAVING )
   1467              //  osal_pwrmgr_device( PWRMGR_BATTERY );
   1468          #endif
   1469          
   1470                if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE )
   \                     ??CrossCallReturnLabel_67:
   \   0000EE   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   0000F1   E0           MOVX    A,@DPTR
   \   0000F2   A2E3         MOV     C,0xE0 /* A   */.3
   \   0000F4   5003         JNC     ??CrossCallReturnLabel_46
   1471                {
   1472                  // The receiver is on, turn network layer polling off.
   1473                  NLME_SetPollRate( 0 );
   \   0000F6                ; Setup parameters for call to function NLME_SetPollRate
   \   0000F6   12....       LCALL   ?Subroutine35 & 0xFFFF
   1474                  NLME_SetQueuedPollRate( 0 );
   1475                  NLME_SetResponseRate( 0 );
   1476                }
   1477          
   1478                if ( ZSTACK_ROUTER_BUILD )
   1479                {
   1480                  // NOTE: first two parameters are not used, see NLMEDE.h for details
   1481                  if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   1482                  {
   1483                    NLME_StartRouterRequest( 0, 0, false );
   1484                  }
   1485                }
   1486          
   1487                ZDApp_AnnounceNewAddress();
   \                     ??CrossCallReturnLabel_46:
   \   0000F9                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   0000F9   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   \   0000FC   8059         SJMP    ??CrossCallReturnLabel_61
   1488              }
   1489              else
   1490              {
   1491                if ( devStartMode == MODE_RESUME )
   \                     ??ZDApp_ProcessNetworkJoin_18:
   \   0000FE   90....       MOV     DPTR,#devStartMode
   \   000101   E0           MOVX    A,@DPTR
   \   000102   6401         XRL     A,#0x1
   \   000104   703B         JNZ     ??ZDApp_ProcessNetworkJoin_19
   1492                {
   1493                  if ( ++retryCnt <= MAX_RESUME_RETRY )
   \   000106   90....       MOV     DPTR,#retryCnt
   \   000109   E0           MOVX    A,@DPTR
   \   00010A   04           INC     A
   \   00010B   F0           MOVX    @DPTR,A
   \   00010C   C3           CLR     C
   \   00010D   9404         SUBB    A,#0x4
   \   00010F   5028         JNC     ??ZDApp_ProcessNetworkJoin_20
   1494                  {
   1495                    if ( _NIB.nwkPanId == 0xFFFF || _NIB.nwkPanId == INVALID_PAN_ID )
   \   000111   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_34:
   \   000114   7003         JNZ     ??ZDApp_ProcessNetworkJoin_21
   \   000116   74FF         MOV     A,#-0x1
   \   000118   69           XRL     A,R1
   \                     ??ZDApp_ProcessNetworkJoin_21:
   \   000119   600A         JZ      ??ZDApp_ProcessNetworkJoin_22
   \   00011B   74FE         MOV     A,#-0x2
   \   00011D   68           XRL     A,R0
   \   00011E   7003         JNZ     ??ZDApp_ProcessNetworkJoin_23
   \   000120   74FF         MOV     A,#-0x1
   \   000122   69           XRL     A,R1
   \                     ??ZDApp_ProcessNetworkJoin_23:
   \   000123   7007         JNZ     ??ZDApp_ProcessNetworkJoin_24
   1496                      devStartMode = MODE_JOIN;
   \                     ??ZDApp_ProcessNetworkJoin_22:
   \   000125   90....       MOV     DPTR,#devStartMode
   \   000128   E4           CLR     A
   \                     ??ZDApp_ProcessNetworkJoin_25:
   \   000129   F0           MOVX    @DPTR,A
   \   00012A   8015         SJMP    ??ZDApp_ProcessNetworkJoin_19
   1497                    else
   1498                    {
   1499                      devStartMode = MODE_REJOIN;
   \                     ??ZDApp_ProcessNetworkJoin_24:
   \   00012C   90....       MOV     DPTR,#devStartMode
   \   00012F   7403         MOV     A,#0x3
   \   000131   F0           MOVX    @DPTR,A
   1500                      _tmpRejoinState = true;
   \   000132   90....       MOV     DPTR,#_tmpRejoinState
   \   000135   7401         MOV     A,#0x1
   \   000137   80F0         SJMP    ??ZDApp_ProcessNetworkJoin_25
   1501                    }
   1502                  }
   1503                  // Do a normal join to the network after certain times of rejoin retries
   1504                  else if( AIB_apsUseInsecureJoin == true )
   \                     ??ZDApp_ProcessNetworkJoin_20:
   \   000139   90....       MOV     DPTR,#AIB_apsUseInsecureJoin
   \   00013C   E0           MOVX    A,@DPTR
   \   00013D   6401         XRL     A,#0x1
   \   00013F   60E4         JZ      ??ZDApp_ProcessNetworkJoin_22
   1505                  {
   1506                    devStartMode = MODE_JOIN;
   1507                  }
   1508                }
   1509          
   1510                // Clear the neighbor Table and network discovery tables.
   1511                nwkNeighborInitTable();
   \                     ??ZDApp_ProcessNetworkJoin_19:
   \   000141                ; Setup parameters for call to function nwkNeighborInitTable
   \   000141   12....       LCALL   ??nwkNeighborInitTable?relay
   1512                NLME_NwkDiscTerm();
   \   000144                ; Setup parameters for call to function NLME_NwkDiscTerm
   \   000144   12....       LCALL   ??NLME_NwkDiscTerm?relay
   1513          
   1514                // setup a retry for later...
   1515                ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1516                     + (osal_rand()& EXTENDED_JOINING_RANDOM_MASK)) );
   \   000147                ; Setup parameters for call to function ZDApp_NetworkInit
   \   000147                ; Setup parameters for call to function osal_rand
   \   000147   808F         SJMP    ??ZDApp_ProcessNetworkJoin_16
   1517              }
   1518            }
   1519          #if defined ( ZIGBEE_STOCHASTIC_ADDRESSING )
   1520            else
   1521            {
   1522              // Assume from address conflict
   1523              if ( _NIB.nwkAddrAlloc == NWK_ADDRESSING_STOCHASTIC )
   \                     ??ZDApp_ProcessNetworkJoin_17:
   \   000149   90....       MOV     DPTR,#_NIB + 96
   \   00014C   E0           MOVX    A,@DPTR
   \   00014D   6402         XRL     A,#0x2
   \   00014F   7006         JNZ     ??CrossCallReturnLabel_61
   1524              {
   1525                // Notify the network
   1526                ZDApp_AnnounceNewAddress();
   \   000151                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   000151   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   1527          
   1528                // Notify apps
   1529                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000154                ; Setup parameters for call to function osal_set_event
   \   000154   12....       LCALL   ?Subroutine16 & 0xFFFF
   1530              }
   1531            }
   1532          #endif
   1533          }
   \                     ??CrossCallReturnLabel_61:
   \   000157                REQUIRE ?Subroutine7
   \   000157                ; // Fall through to label ?Subroutine7

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   7402         MOV     A,#0x2
   \   000002   02....       LJMP    ??Subroutine49_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine27:
   \   000000   90....       MOV     DPTR,#_NIB + 33
   \   000003   12....       LCALL   ?Subroutine39 & 0xFFFF
   \                     ??CrossCallReturnLabel_120:
   \   000006   74FF         MOV     A,#-0x1
   \   000008   68           XRL     A,R0
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   A3           INC     DPTR
   \   000002   04           INC     A
   \   000003   F0           MOVX    @DPTR,A
   \   000004                ; Setup parameters for call to function ZMacSetReq
   \   000004                ; Setup parameters for call to function osal_nv_read
   \   000004   85..82       MOV     DPL,?XSP + 0
   \   000007   85..83       MOV     DPH,?XSP + 1
   \   00000A   22           RET
   1534          
   1535          /*********************************************************************
   1536           * @fn      ZDApp_SaveNwkKey()
   1537           *
   1538           * @brief   Save off the Network key information.
   1539           *
   1540           * @param   none
   1541           *
   1542           * @return  none
   1543           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7415         MOV     A,#0x15
   \   000002                REQUIRE ??Subroutine43_0
   \   000002                ; // Fall through to label ??Subroutine43_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1544          void ZDApp_SaveNwkKey( void )
   \                     ZDApp_SaveNwkKey:
   1545          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1546            nwkActiveKeyItems keyItems;
   1547          
   1548            SSP_ReadNwkActiveKey( &keyItems );
   \   00000A                ; Setup parameters for call to function SSP_ReadNwkActiveKey
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   AA82         MOV     R2,DPL
   \   000012   AB83         MOV     R3,DPH
   \   000014   12....       LCALL   ??SSP_ReadNwkActiveKey?relay
   1549            keyItems.frameCounter++;
   \   000017   90....       MOV     DPTR,#__Constant_1
   \   00001A   78..         MOV     R0,#?V0 + 0
   \   00001C   12....       LCALL   ?L_MOV_X
   \   00001F   7411         MOV     A,#0x11
   \   000021   12....       LCALL   ?XSTACK_DISP0_8
   \   000024   78..         MOV     R0,#?V0 + 0
   \   000026   12....       LCALL   ?L_ADD_TO_X
   1550          
   1551            osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof( nwkActiveKeyItems ),
   1552                          (void *)&keyItems );
   \   000029                ; Setup parameters for call to function osal_nv_write
   \   000029   85..82       MOV     DPL,?XSP + 0
   \   00002C   85..83       MOV     DPH,?XSP + 1
   \   00002F   8582..       MOV     ?V0 + 0,DPL
   \   000032   8583..       MOV     ?V0 + 1,DPH
   \   000035   78..         MOV     R0,#?V0 + 0
   \   000037   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003A   75..15       MOV     ?V0 + 0,#0x15
   \   00003D   75..00       MOV     ?V0 + 1,#0x0
   \   000040   78..         MOV     R0,#?V0 + 0
   \   000042   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000045   7C00         MOV     R4,#0x0
   \   000047   7D00         MOV     R5,#0x0
   \   000049   7A82         MOV     R2,#-0x7e
   \   00004B   7B00         MOV     R3,#0x0
   \   00004D   12....       LCALL   ??osal_nv_write?relay
   \   000050   7404         MOV     A,#0x4
   \   000052   12....       LCALL   ?DEALLOC_XSTACK8
   1553          
   1554            nwkFrameCounterChanges = 0;
   \   000055   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000058   E4           CLR     A
   \   000059   F0           MOVX    @DPTR,A
   \   00005A   A3           INC     DPTR
   \   00005B   F0           MOVX    @DPTR,A
   1555          
   1556            // Clear copy in RAM before return.
   1557            osal_memset( &keyItems, 0x00, sizeof(keyItems) );
   \   00005C                ; Setup parameters for call to function osal_memset
   \   00005C   7C15         MOV     R4,#0x15
   \   00005E   FD           MOV     R5,A
   \   00005F   F9           MOV     R1,A
   \   000060   85..82       MOV     DPL,?XSP + 0
   \   000063   85..83       MOV     DPH,?XSP + 1
   \   000066   AA82         MOV     R2,DPL
   \   000068   AB83         MOV     R3,DPH
   \   00006A   12....       LCALL   ??osal_memset?relay
   1558          
   1559          }
   \   00006D   02....       LJMP    ?Subroutine1 & 0xFFFF
   1560          
   1561          /*********************************************************************
   1562           * @fn      ZDApp_ResetNwkKey()
   1563           *
   1564           * @brief   Reset the Network key information in NV.
   1565           *
   1566           * @param   none
   1567           *
   1568           * @return  none
   1569           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1570          void ZDApp_ResetNwkKey( void )
   \                     ZDApp_ResetNwkKey:
   1571          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1572            nwkActiveKeyItems keyItems;
   1573          
   1574            osal_memset( &keyItems, 0, sizeof( nwkActiveKeyItems ) );
   \   00000A                ; Setup parameters for call to function osal_memset
   \   00000A   7C15         MOV     R4,#0x15
   \   00000C   12....       LCALL   ?Subroutine30 & 0xFFFF
   1575            osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof( nwkActiveKeyItems ),
   1576                          (void *)&keyItems );
   \                     ??CrossCallReturnLabel_38:
   \   00000F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000012   75..15       MOV     ?V0 + 0,#0x15
   \   000015   75..00       MOV     ?V0 + 1,#0x0
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001D   7C00         MOV     R4,#0x0
   \   00001F   7D00         MOV     R5,#0x0
   \   000021   7A82         MOV     R2,#-0x7e
   \   000023   7B00         MOV     R3,#0x0
   \   000025   12....       LCALL   ??osal_nv_write?relay
   \   000028   7404         MOV     A,#0x4
   \   00002A   12....       LCALL   ?DEALLOC_XSTACK8
   1577          }
   \   00002D   02....       LJMP    ?Subroutine6 & 0xFFFF
   1578          
   1579          /*********************************************************************
   1580           * @fn      ZDApp_RestoreNwkKey()
   1581           *
   1582           * @brief
   1583           *
   1584           *   Save off the Network key information.
   1585           *
   1586           * @param   none
   1587           *
   1588           * @return  true if restored from NV, false if not
   1589           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1590          uint8 ZDApp_RestoreNwkKey( void )
   \                     ZDApp_RestoreNwkKey:
   1591          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1592            nwkActiveKeyItems keyItems;
   1593            uint8 ret = false;
   \   00000A   7E00         MOV     R6,#0x0
   1594          
   1595            if ( osal_nv_read( ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), (void*)&keyItems )
   1596                == ZSUCCESS )
   \   00000C                ; Setup parameters for call to function osal_nv_read
   \   00000C   85..82       MOV     DPL,?XSP + 0
   \   00000F   85..83       MOV     DPH,?XSP + 1
   \   000012   8582..       MOV     ?V0 + 0,DPL
   \   000015   8583..       MOV     ?V0 + 1,DPH
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001D   75..15       MOV     ?V0 + 0,#0x15
   \   000020   8E..         MOV     ?V0 + 1,R6
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000027   7C00         MOV     R4,#0x0
   \   000029   7D00         MOV     R5,#0x0
   \   00002B   7A82         MOV     R2,#-0x7e
   \   00002D   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_48:
   \   000030   12....       LCALL   ?DEALLOC_XSTACK8
   \   000033   E9           MOV     A,R1
   \   000034   703F         JNZ     ??ZDApp_RestoreNwkKey_0
   1597            {
   1598              if ( keyItems.frameCounter > 0 )
   \   000036   7411         MOV     A,#0x11
   \   000038   12....       LCALL   ?XSTACK_DISP0_8
   \   00003B   78..         MOV     R0,#?V0 + 0
   \   00003D   12....       LCALL   ?L_MOV_X
   \   000040   E5..         MOV     A,?V0 + 0
   \   000042   45..         ORL     A,?V0 + 1
   \   000044   45..         ORL     A,?V0 + 2
   \   000046   45..         ORL     A,?V0 + 3
   \   000048   6021         JZ      ??ZDApp_RestoreNwkKey_1
   1599              {
   1600                // Restore the key information
   1601                keyItems.frameCounter += MAX_NWK_FRAMECOUNTER_CHANGES;
   \   00004A   90....       MOV     DPTR,#__Constant_3e8
   \   00004D   78..         MOV     R0,#?V0 + 0
   \   00004F   12....       LCALL   ?L_MOV_X
   \   000052   7411         MOV     A,#0x11
   \   000054   12....       LCALL   ?XSTACK_DISP0_8
   \   000057   78..         MOV     R0,#?V0 + 0
   \   000059   12....       LCALL   ?L_ADD_TO_X
   1602                nwkFrameCounter = keyItems.frameCounter;
   \   00005C   7411         MOV     A,#0x11
   \   00005E   12....       LCALL   ?XSTACK_DISP0_8
   \   000061   12....       LCALL   ?XLOAD_R2345
   \   000064   90....       MOV     DPTR,#nwkFrameCounter
   \   000067   12....       LCALL   ?XSTORE_R2345
   1603                ret = true;
   \   00006A   0E           INC     R6
   1604              }
   1605          
   1606              // Force a save for the first frame counter increment
   1607              nwkFrameCounterChanges = MAX_NWK_FRAMECOUNTER_CHANGES + 1;
   \                     ??ZDApp_RestoreNwkKey_1:
   \   00006B   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   00006E   74E9         MOV     A,#-0x17
   \   000070   F0           MOVX    @DPTR,A
   \   000071   A3           INC     DPTR
   \   000072   7403         MOV     A,#0x3
   \   000074   F0           MOVX    @DPTR,A
   1608            }
   1609            // Clear copy in RAM before return.
   1610            osal_memset( &keyItems, 0x00, sizeof(keyItems) );
   \                     ??ZDApp_RestoreNwkKey_0:
   \   000075                ; Setup parameters for call to function osal_memset
   \   000075   7C15         MOV     R4,#0x15
   \   000077   7D00         MOV     R5,#0x0
   \   000079   7900         MOV     R1,#0x0
   \   00007B   85..82       MOV     DPL,?XSP + 0
   \   00007E   85..83       MOV     DPH,?XSP + 1
   \   000081   AA82         MOV     R2,DPL
   \   000083   AB83         MOV     R3,DPH
   \   000085   12....       LCALL   ??osal_memset?relay
   1611          
   1612            return ( ret );
   \   000088   EE           MOV     A,R6
   \   000089   F9           MOV     R1,A
   \   00008A   02....       LJMP    ?Subroutine1 & 0xFFFF
   1613          }
   1614          
   1615          /*********************************************************************
   1616           * @fn      ZDApp_ResetTimerStart
   1617           *
   1618           * @brief   Start the reset timer.
   1619           *
   1620           * @param   delay - delay time(ms) before reset
   1621           *
   1622           * @return  none
   1623           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1624          void ZDApp_ResetTimerStart( uint16 delay )
   \                     ZDApp_ResetTimerStart:
   1625          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1626            // Start the rest timer
   1627            osal_start_timerEx( ZDAppTaskID, ZDO_DEVICE_RESET, delay );
   \   000004                ; Setup parameters for call to function osal_start_timerEx
   \   000004   EA           MOV     A,R2
   \   000005   FC           MOV     R4,A
   \   000006   EB           MOV     A,R3
   \   000007   FD           MOV     R5,A
   \   000008   7A04         MOV     R2,#0x4
   \   00000A   7B00         MOV     R3,#0x0
   \   00000C   02....       LJMP    ?Subroutine2 & 0xFFFF
   1628          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   12....       LCALL   ??Subroutine60_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_126:
   \   000003                REQUIRE ??Subroutine47_0
   \   000003                ; // Fall through to label ??Subroutine47_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine60_0:
   \   000000   90....       MOV     DPTR,#ZDAppTaskID
   \   000003                REQUIRE ??Subroutine61_0
   \   000003                ; // Fall through to label ??Subroutine61_0
   1629          
   1630          /*********************************************************************
   1631           * @fn      ZDApp_ResetTimerCancel
   1632           *
   1633           * @brief   Cancel the reset timer.
   1634           *
   1635           * @param   none
   1636           *
   1637           * @return  none
   1638           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1639          void ZDApp_ResetTimerCancel( void )
   \                     ZDApp_ResetTimerCancel:
   1640          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1641            // Cancel the reset timer
   1642            osal_stop_timerEx( ZDAppTaskID, ZDO_DEVICE_RESET );
   \   000004                ; Setup parameters for call to function osal_stop_timerEx
   \   000004   7A04         MOV     R2,#0x4
   \   000006   7B00         MOV     R3,#0x0
   \   000008   90....       MOV     DPTR,#ZDAppTaskID
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   12....       LCALL   ??osal_stop_timerEx?relay
   1643          }
   \   000010   02....       LJMP    ??Subroutine47_0 & 0xFFFF
   1644          
   1645          /*********************************************************************
   1646           * @fn      ZDApp_LeaveCtrlInit
   1647           *
   1648           * @brief   Initialize the leave control logic.
   1649           *
   1650           * @param   none
   1651           *
   1652           * @return  none
   1653           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1654          void ZDApp_LeaveCtrlInit( void )
   \                     ZDApp_LeaveCtrlInit:
   1655          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1656            uint8 status;
   1657          
   1658          
   1659            // Initialize control state
   1660            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_INIT;
   \   000005   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000008   E4           CLR     A
   \   000009   F0           MOVX    @DPTR,A
   1661          
   1662            status = osal_nv_item_init( ZCD_NV_LEAVE_CTRL,
   1663                                        sizeof(ZDApp_LeaveCtrl),
   1664                                        &ZDApp_LeaveCtrl );
   1665          
   1666            if ( status == ZSUCCESS )
   \   00000A                ; Setup parameters for call to function osal_nv_item_init
   \   00000A   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   00000D   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   000010   78..         MOV     R0,#?V0 + 0
   \   000012   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000015   7C01         MOV     R4,#0x1
   \   000017   7D00         MOV     R5,#0x0
   \   000019   7A85         MOV     R2,#-0x7b
   \   00001B   7B00         MOV     R3,#0x0
   \   00001D   12....       LCALL   ??osal_nv_item_init?relay
   \   000020   7402         MOV     A,#0x2
   \   000022   12....       LCALL   ?DEALLOC_XSTACK8
   \   000025   E9           MOV     A,R1
   \   000026   701C         JNZ     ??ZDApp_LeaveCtrlInit_0
   1667            {
   1668              // Read saved control
   1669              osal_nv_read( ZCD_NV_LEAVE_CTRL,
   1670                            0,
   1671                            sizeof( uint8 ),
   1672                            &ZDApp_LeaveCtrl);
   \   000028                ; Setup parameters for call to function osal_nv_read
   \   000028   78..         MOV     R0,#?V0 + 0
   \   00002A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002D   75..01       MOV     ?V0 + 0,#0x1
   \   000030   75..00       MOV     ?V0 + 1,#0x0
   \   000033   78..         MOV     R0,#?V0 + 0
   \   000035   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000038   7C00         MOV     R4,#0x0
   \   00003A   7D00         MOV     R5,#0x0
   \   00003C   7A85         MOV     R2,#-0x7b
   \   00003E   12....       LCALL   ?Subroutine36 & 0xFFFF
   1673            }
   \                     ??CrossCallReturnLabel_49:
   \   000041   12....       LCALL   ?DEALLOC_XSTACK8
   1674          }
   \                     ??ZDApp_LeaveCtrlInit_0:
   \   000044   02....       LJMP    ??Subroutine50_0 & 0xFFFF
   1675          
   1676          /*********************************************************************
   1677           * @fn      ZDApp_LeaveCtrlSet
   1678           *
   1679           * @brief   Set the leave control logic.
   1680           *
   1681           * @param   ra - reassociate flag
   1682           *
   1683           * @return  none
   1684           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1685          void ZDApp_LeaveCtrlSet( uint8 ra )
   \                     ZDApp_LeaveCtrlSet:
   1686          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   1687            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_SET;
   \   000007   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   00000A   7401         MOV     A,#0x1
   \   00000C   F0           MOVX    @DPTR,A
   1688          
   1689            if ( ra == TRUE )
   \   00000D   6E           XRL     A,R6
   \   00000E   7003         JNZ     ??ZDApp_LeaveCtrlSet_0
   1690            {
   1691              ZDApp_LeaveCtrl |= ZDAPP_LEAVE_CTRL_RA;
   \   000010   7403         MOV     A,#0x3
   \   000012   F0           MOVX    @DPTR,A
   1692            }
   1693          
   1694            // Write the leave control
   1695            osal_nv_write( ZCD_NV_LEAVE_CTRL,
   1696                           0,
   1697                           sizeof( uint8 ),
   1698                           &ZDApp_LeaveCtrl);
   \                     ??ZDApp_LeaveCtrlSet_0:
   \   000013                ; Setup parameters for call to function osal_nv_write
   \   000013   02....       LJMP    ?Subroutine3 & 0xFFFF
   1699          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   000003   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   000006   78..         MOV     R0,#?V0 + 0
   \   000008   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00000B   75..01       MOV     ?V0 + 0,#0x1
   \   00000E   75..00       MOV     ?V0 + 1,#0x0
   \   000011   78..         MOV     R0,#?V0 + 0
   \   000013   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000016   7C00         MOV     R4,#0x0
   \   000018   7D00         MOV     R5,#0x0
   \   00001A   7A85         MOV     R2,#-0x7b
   \   00001C   7B00         MOV     R3,#0x0
   \   00001E   12....       LCALL   ??osal_nv_write?relay
   \   000021   7404         MOV     A,#0x4
   \   000023                REQUIRE ??Subroutine49_0
   \   000023                ; // Fall through to label ??Subroutine49_0
   1700          
   1701          /*********************************************************************
   1702           * @fn      ZDApp_LeaveCtrlReset
   1703           *
   1704           * @brief   Re-initialize the leave control logic.
   1705           *
   1706           * @param   none
   1707           *
   1708           * @return  none
   1709           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1710          void ZDApp_LeaveCtrlReset( void )
   \                     ZDApp_LeaveCtrlReset:
   1711          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1712            // Set leave control to initialized state
   1713            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_INIT;
   \   000005   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000008   E4           CLR     A
   \   000009   F0           MOVX    @DPTR,A
   1714          
   1715            // Write initialized control
   1716            osal_nv_write( ZCD_NV_LEAVE_CTRL,
   1717                          0,
   1718                          sizeof( uint8 ),
   1719                          &ZDApp_LeaveCtrl);
   \   00000A                ; Setup parameters for call to function osal_nv_write
   \   00000A   02....       LJMP    ?Subroutine3 & 0xFFFF
   1720          }
   1721          
   1722          /*********************************************************************
   1723           * @fn      ZDApp_LeaveCtrlBypass
   1724           *
   1725           * @brief   Check if NV restore should be skipped during a leave reset.
   1726           *
   1727           * @param   none
   1728           *
   1729           * @return  uint8 - (TRUE bypass:FALSE do not bypass)
   1730           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1731          uint8 ZDApp_LeaveCtrlBypass( void )
   \                     ZDApp_LeaveCtrlBypass:
   1732          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1733            uint8 bypass;
   1734          
   1735            if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_SET )
   1736            {
   1737              bypass = TRUE;
   1738            }
   1739            else
   1740            {
   1741              bypass = FALSE;
   1742            }
   1743          
   1744            return bypass;
   \   000004   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000007   E0           MOVX    A,@DPTR
   \   000008   A2E0         MOV     C,0xE0 /* A   */.0
   \   00000A   E4           CLR     A
   \   00000B   33           RLC     A
   \   00000C   F9           MOV     R1,A
   \   00000D   80..         SJMP    ??Subroutine47_0
   1745          }
   1746          
   1747          /*********************************************************************
   1748           * @fn      ZDApp_LeaveCtrlStartup
   1749           *
   1750           * @brief   Check for startup conditions during a leave reset.
   1751           *
   1752           * @param   state      - devState_t determined by leave control logic
   1753           * @param   startDelay - startup delay
   1754           *
   1755           * @return  none
   1756           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1757          void ZDApp_LeaveCtrlStartup( devStates_t* state, uint16* startDelay )
   \                     ZDApp_LeaveCtrlStartup:
   1758          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1759            *startDelay = 0;
   \   000004   8C82         MOV     DPL,R4
   \   000006   8D83         MOV     DPH,R5
   \   000008   E4           CLR     A
   \   000009   F0           MOVX    @DPTR,A
   \   00000A   A3           INC     DPTR
   \   00000B   F0           MOVX    @DPTR,A
   1760          
   1761            if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_SET )
   \   00000C   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   A2E0         MOV     C,0xE0 /* A   */.0
   \   000012   5019         JNC     ??ZDApp_LeaveCtrlStartup_0
   1762            {
   1763              if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_RA )
   \   000014   A2E1         MOV     C,0xE0 /* A   */.1
   \   000016   500C         JNC     ??ZDApp_LeaveCtrlStartup_1
   1764              {
   1765                *startDelay = LEAVE_RESET_DELAY;
   \   000018   8C82         MOV     DPL,R4
   \   00001A   8D83         MOV     DPH,R5
   \   00001C   7488         MOV     A,#-0x78
   \   00001E   F0           MOVX    @DPTR,A
   \   00001F   A3           INC     DPTR
   \   000020   7413         MOV     A,#0x13
   \   000022   8005         SJMP    ??ZDApp_LeaveCtrlStartup_2
   1766              }
   1767              else
   1768              {
   1769                *state = DEV_HOLD;
   \                     ??ZDApp_LeaveCtrlStartup_1:
   \   000024   8A82         MOV     DPL,R2
   \   000026   8B83         MOV     DPH,R3
   \   000028   E4           CLR     A
   \                     ??ZDApp_LeaveCtrlStartup_2:
   \   000029   F0           MOVX    @DPTR,A
   1770              }
   1771          
   1772              // Reset leave control logic
   1773              ZDApp_LeaveCtrlReset();
   \   00002A                ; Setup parameters for call to function ZDApp_LeaveCtrlReset
   \   00002A   12....       LCALL   ??ZDApp_LeaveCtrlReset?relay
   1774            }
   1775          }
   \                     ??ZDApp_LeaveCtrlStartup_0:
   \   00002D   80..         SJMP    ??Subroutine47_0
   1776          
   1777          /*********************************************************************
   1778           * @fn      ZDApp_LeaveReset
   1779           *
   1780           * @brief   Setup a device reset due to a leave indication/confirm.
   1781           *
   1782           * @param   ra - reassociate flag
   1783           *
   1784           * @return  none
   1785           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1786          void ZDApp_LeaveReset( uint8 ra )
   \                     ZDApp_LeaveReset:
   1787          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   1788            ZDApp_LeaveCtrlSet( ra );
   \   000005                ; Setup parameters for call to function ZDApp_LeaveCtrlSet
   \   000005   12....       LCALL   ??ZDApp_LeaveCtrlSet?relay
   1789          
   1790            ZDApp_ResetTimerStart( LEAVE_RESET_DELAY );
   \   000008                ; Setup parameters for call to function osal_start_timerEx
   \   000008   7C88         MOV     R4,#-0x78
   \   00000A   7D13         MOV     R5,#0x13
   \   00000C   12....       LCALL   ?Subroutine17 & 0xFFFF
   1791          }
   \                     ??CrossCallReturnLabel_123:
   \   00000F   02....       LJMP    ??Subroutine51_0 & 0xFFFF
   1792          
   1793          /*********************************************************************
   1794           * @fn      ZDApp_LeaveUpdate
   1795           *
   1796           * @brief   Update local device data related to leaving device.
   1797           *
   1798           * @param   nwkAddr        - NWK address of leaving device
   1799           * @param   extAddr        - EXT address of leaving device
   1800           * @param   removeChildren - remove children of leaving device
   1801           *
   1802           * @return  none
   1803           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1804          void ZDApp_LeaveUpdate( uint16 nwkAddr, uint8* extAddr,
   \                     ZDApp_LeaveUpdate:
   1805                                  uint8 removeChildren )
   1806          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
   1807            // Remove Apps Key for leaving device
   1808            ZDSecMgrDeviceRemoveByExtAddr(extAddr);
   \   000012                ; Setup parameters for call to function ZDSecMgrDeviceRemoveByExtAddr
   \   000012   EE           MOV     A,R6
   \   000013   FA           MOV     R2,A
   \   000014   EF           MOV     A,R7
   \   000015   FB           MOV     R3,A
   \   000016   12....       LCALL   ??ZDSecMgrDeviceRemoveByExtAddr?relay
   1809          
   1810            // Clear SECURITY bit from Address Manager
   1811            ZDSecMgrAddrClear( extAddr );
   \   000019                ; Setup parameters for call to function ZDSecMgrAddrClear
   \   000019   EE           MOV     A,R6
   \   00001A   FA           MOV     R2,A
   \   00001B   EF           MOV     A,R7
   \   00001C   FB           MOV     R3,A
   \   00001D   12....       LCALL   ??ZDSecMgrAddrClear?relay
   1812          
   1813            if ( pbindRemoveDev )
   \   000020   90....       MOV     DPTR,#pbindRemoveDev
   \   000023   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   000026   603C         JZ      ??ZDApp_LeaveUpdate_0
   1814            {
   1815              zAddrType_t devAddr;
   1816          
   1817              // Remove bind entry and all related data
   1818              devAddr.addrMode = Addr64Bit;
   \   000028   7408         MOV     A,#0x8
   \   00002A   12....       LCALL   ?XSTACK_DISP0_8
   \   00002D   7403         MOV     A,#0x3
   \   00002F   F0           MOVX    @DPTR,A
   1819              osal_memcpy(devAddr.addr.extAddr, extAddr, Z_EXTADDR_LEN);
   \   000030                ; Setup parameters for call to function osal_memcpy
   \   000030   8E..         MOV     ?V0 + 4,R6
   \   000032   8F..         MOV     ?V0 + 5,R7
   \   000034   75..00       MOV     ?V0 + 6,#0x0
   \   000037   78..         MOV     R0,#?V0 + 4
   \   000039   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00003C   7C08         MOV     R4,#0x8
   \   00003E   7D00         MOV     R5,#0x0
   \   000040   7403         MOV     A,#0x3
   \   000042   12....       LCALL   ?XSTACK_DISP0_8
   \   000045   AA82         MOV     R2,DPL
   \   000047   AB83         MOV     R3,DPH
   \   000049   12....       LCALL   ??osal_memcpy?relay
   \   00004C   7403         MOV     A,#0x3
   \   00004E   12....       LCALL   ?DEALLOC_XSTACK8
   1820          
   1821              pbindRemoveDev(&devAddr);
   \   000051                ; Setup parameters for indirect call
   \   000051   85..82       MOV     DPL,?XSP + 0
   \   000054   85..83       MOV     DPH,?XSP + 1
   \   000057   AA82         MOV     R2,DPL
   \   000059   AB83         MOV     R3,DPH
   \   00005B   90....       MOV     DPTR,#pbindRemoveDev
   \   00005E   12....       LCALL   ?Subroutine20 & 0xFFFF
   1822            }
   \                     ??CrossCallReturnLabel_74:
   \   000061   12....       LCALL   ?CALL_IND
   1823          
   1824            // Remove if child
   1825            if ( ZSTACK_ROUTER_BUILD )
   1826            {
   1827              NLME_RemoveChild( extAddr, removeChildren );
   1828            }
   1829          
   1830            // Remove Routing table related entry
   1831            RTG_RemoveRtgEntry( nwkAddr, 0 );
   \                     ??ZDApp_LeaveUpdate_0:
   \   000064                ; Setup parameters for call to function RTG_RemoveRtgEntry
   \   000064   7900         MOV     R1,#0x0
   \   000066   AA..         MOV     R2,?V0 + 0
   \   000068   AB..         MOV     R3,?V0 + 1
   \   00006A   12....       LCALL   ??RTG_RemoveRtgEntry?relay
   1832          
   1833            // Remove entry from neighborTable
   1834            nwkNeighborRemove( nwkAddr, _NIB.nwkPanId );
   \   00006D                ; Setup parameters for call to function nwkNeighborRemove
   \   00006D   90....       MOV     DPTR,#_NIB + 33
   \   000070   12....       LCALL   ??Subroutine52_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_78:
   \   000073   AA..         MOV     R2,?V0 + 0
   \   000075   AB..         MOV     R3,?V0 + 1
   \   000077   12....       LCALL   ??nwkNeighborRemove?relay
   1835          
   1836            // Schedule to save data to NV
   1837            ZDApp_NwkWriteNVRequest();
   \   00007A                ; Setup parameters for call to function AddrMgrWriteNVRequest
   \   00007A   12....       LCALL   ??AddrMgrWriteNVRequest?relay
   1838          }
   \   00007D   7409         MOV     A,#0x9
   \   00007F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000082   7F07         MOV     R7,#0x7
   \   000084   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine20:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003                REQUIRE ??Subroutine48_0
   \   000003                ; // Fall through to label ??Subroutine48_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine48_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F583         MOV     DPH,A
   \   000003   8882         MOV     DPL,R0
   \   000005   22           RET
   1839          
   1840          /*********************************************************************
   1841           * @fn      ZDApp_NetworkDiscoveryReq
   1842           *
   1843           * @brief   Request a network discovery.
   1844           *
   1845           * @param  scanChannels -
   1846           * @param  scanDuration -
   1847           *
   1848           * @return  ZStatus_t
   1849           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1850          ZStatus_t ZDApp_NetworkDiscoveryReq( uint32 scanChannels, uint8 scanDuration)
   \                     ZDApp_NetworkDiscoveryReq:
   1851          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   1852            // Setup optional filters - tbd
   1853          
   1854            // Request NLME network discovery
   1855            return NLME_NetworkDiscoveryRequest(scanChannels, scanDuration);
   \   000005                ; Setup parameters for call to function NLME_NetworkDiscoveryRequest
   \   000005   12....       LCALL   ??NLME_NetworkDiscoveryRequest?relay
   \   000008   02....       LJMP    ??Subroutine44_0 & 0xFFFF
   1856          }
   1857          
   1858          /*********************************************************************
   1859           * @fn      ZDApp_JoinReq
   1860           *
   1861           * @brief   Request the device to join a parent in a network.
   1862           *
   1863           * @param   channel -
   1864           * @param   panID -
   1865           *
   1866           * @return  ZStatus_t
   1867           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1868          ZStatus_t ZDApp_JoinReq( uint8 channel, uint16 panID, uint8 *extendedPanID,
   \                     ZDApp_JoinReq:
   1869                                   uint16 chosenParent, uint8 parentDepth, uint8 stackProfile )
   1870          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 4,R1
   \   000007   8A..         MOV     ?V0 + 0,R2
   \   000009   8B..         MOV     ?V0 + 1,R3
   \   00000B   EC           MOV     A,R4
   \   00000C   FE           MOV     R6,A
   \   00000D   ED           MOV     A,R5
   \   00000E   FF           MOV     R7,A
   \   00000F   740E         MOV     A,#0xe
   \   000011   12....       LCALL   ?XSTACK_DISP0_8
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F5..         MOV     ?V0 + 2,A
   \   000017   A3           INC     DPTR
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F5..         MOV     ?V0 + 3,A
   \   00001B   7410         MOV     A,#0x10
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   E0           MOVX    A,@DPTR
   \   000021   F5..         MOV     ?V0 + 5,A
   \   000023   7411         MOV     A,#0x11
   \   000025   12....       LCALL   ?XSTACK_DISP0_8
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F9           MOV     R1,A
   1871            // Sync up the node with the stack profile (In the case where a pro device
   1872            // joins a non-pro network, or verse versa)
   1873            ZDApp_NodeProfileSync( stackProfile);
   \   00002A                ; Setup parameters for call to function ZDApp_NodeProfileSync
   \   00002A   12....       LCALL   ??ZDApp_NodeProfileSync?relay
   1874          
   1875            // Request NLME Join Request
   1876            return NLME_JoinRequest(extendedPanID, panID,channel,
   1877                                    ZDO_Config_Node_Descriptor.CapabilityFlags,
   1878                                    chosenParent, parentDepth);
   \   00002D                ; Setup parameters for call to function NLME_JoinRequest
   \   00002D   78..         MOV     R0,#?V0 + 5
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000032   78..         MOV     R0,#?V0 + 2
   \   000034   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000037   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   F5..         MOV     ?V0 + 2,A
   \   00003D   78..         MOV     R0,#?V0 + 2
   \   00003F   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000042   A9..         MOV     R1,?V0 + 4
   \   000044   AC..         MOV     R4,?V0 + 0
   \   000046   AD..         MOV     R5,?V0 + 1
   \   000048   EE           MOV     A,R6
   \   000049   FA           MOV     R2,A
   \   00004A   EF           MOV     A,R7
   \   00004B   FB           MOV     R3,A
   \   00004C   12....       LCALL   ??NLME_JoinRequest?relay
   \   00004F   7404         MOV     A,#0x4
   \   000051   12....       LCALL   ?DEALLOC_XSTACK8
   \   000054   02....       LJMP    ?Subroutine4 & 0xFFFF
   1879          
   1880          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   7F06         MOV     R7,#0x6
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
   1881          
   1882          /*********************************************************************
   1883           * @fn      ZDApp_DeviceConfigured
   1884           *
   1885           * @brief   Check to see if the local device is configured (i.e., part
   1886           *          of a network).
   1887           *
   1888           * @param   none
   1889           *
   1890           * @return  TRUE if configured. FALSE, otherwise.
   1891           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1892          uint8 ZDApp_DeviceConfigured( void )
   \                     ZDApp_DeviceConfigured:
   1893          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1894            uint16 nwkAddr = INVALID_NODE_ADDR;
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   74FE         MOV     A,#-0x2
   \   000012   12....       LCALL   ?Subroutine12 & 0xFFFF
   1895          
   1896            osal_nv_read( ZCD_NV_NIB, osal_offsetof( nwkIB_t, nwkDevAddress ),
   1897                          sizeof( uint16), &nwkAddr );
   \                     ??CrossCallReturnLabel_5:
   \   000015   8582..       MOV     ?V0 + 0,DPL
   \   000018   8583..       MOV     ?V0 + 1,DPH
   \   00001B   78..         MOV     R0,#?V0 + 0
   \   00001D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000020   75..02       MOV     ?V0 + 0,#0x2
   \   000023   75..00       MOV     ?V0 + 1,#0x0
   \   000026   78..         MOV     R0,#?V0 + 0
   \   000028   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002B   7C14         MOV     R4,#0x14
   \   00002D   7D00         MOV     R5,#0x0
   \   00002F   7A21         MOV     R2,#0x21
   \   000031   12....       LCALL   ?Subroutine36 & 0xFFFF
   \                     ??CrossCallReturnLabel_50:
   \   000034   12....       LCALL   ?DEALLOC_XSTACK8
   1898          
   1899            // Does the NIB have anything more than default?
   1900            return ( nwkAddr == INVALID_NODE_ADDR ? FALSE : TRUE );
   \   000037   85..82       MOV     DPL,?XSP + 0
   \   00003A   85..83       MOV     DPH,?XSP + 1
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   64FE         XRL     A,#0xfe
   \   000040   7003         JNZ     ??ZDApp_DeviceConfigured_0
   \   000042   A3           INC     DPTR
   \   000043   E0           MOVX    A,@DPTR
   \   000044   F4           CPL     A
   \                     ??ZDApp_DeviceConfigured_0:
   \   000045   7004         JNZ     ??ZDApp_DeviceConfigured_1
   \   000047   7900         MOV     R1,#0x0
   \   000049   8002         SJMP    ??ZDApp_DeviceConfigured_2
   \                     ??ZDApp_DeviceConfigured_1:
   \   00004B   7901         MOV     R1,#0x1
   \                     ??ZDApp_DeviceConfigured_2:
   \   00004D   02....       LJMP    ?Subroutine7 & 0xFFFF
   1901          }
   1902          
   1903          /*********************************************************************
   1904           * CALLBACK FUNCTIONS
   1905           */
   1906          
   1907          
   1908          /*********************************************************************
   1909           * @fn      ZDApp_SendEventMsg()
   1910           *
   1911           * @brief
   1912           *
   1913           *   Sends a Network Join message
   1914           *
   1915           * @param  cmd - command ID
   1916           * @param  len - length (in bytes) of the buf field
   1917           * @param  buf - buffer for the rest of the message.
   1918           *
   1919           * @return  none
   1920           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1921          void ZDApp_SendEventMsg( uint8 cmd, uint8 len, uint8 *buf )
   \                     ZDApp_SendEventMsg:
   1922          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   EA           MOV     A,R2
   1923            ZDApp_SendMsg( ZDAppTaskID, cmd, len, buf );
   \   000008                ; Setup parameters for call to function ZDApp_SendMsg
   \   000008   FB           MOV     R3,A
   \   000009   EE           MOV     A,R6
   \   00000A   FA           MOV     R2,A
   \   00000B   12....       LCALL   ?Subroutine22 & 0xFFFF
   1924          }
   \                     ??CrossCallReturnLabel_20:
   \   00000E   80..         SJMP    ??Subroutine51_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine22:
   \   000000   90....       MOV     DPTR,#ZDAppTaskID
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??ZDApp_SendMsg?relay
   \   000008   22           RET
   1925          
   1926          /*********************************************************************
   1927           * @fn      ZDApp_SendMsg()
   1928           *
   1929           * @brief   Sends a OSAL message
   1930           *
   1931           * @param  taskID - Where to send the message
   1932           * @param  cmd - command ID
   1933           * @param  len - length (in bytes) of the buf field
   1934           * @param  buf - buffer for the rest of the message.
   1935           *
   1936           * @return  none
   1937           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1938          void ZDApp_SendMsg( uint8 taskID, uint8 cmd, uint8 len, uint8 *buf )
   \                     ZDApp_SendMsg:
   1939          {
   \   000000   74ED         MOV     A,#-0x13
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 19
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 4,R1
   \   000007   8A..         MOV     ?V0 + 6,R2
   \   000009   8B..         MOV     ?V0 + 5,R3
   \   00000B   8C..         MOV     ?V0 + 2,R4
   \   00000D   8D..         MOV     ?V0 + 3,R5
   1940            osal_event_hdr_t *msgPtr;
   1941          
   1942            // Send the address to the task
   1943            msgPtr = (osal_event_hdr_t *)osal_msg_allocate( len );
   \   00000F   8B82         MOV     DPL,R3
   \   000011   8582..       MOV     ?V0 + 0,DPL
   \   000014   75..00       MOV     ?V0 + 1,#0x0
   \   000017                ; Setup parameters for call to function osal_msg_allocate
   \   000017   AA..         MOV     R2,?V0 + 0
   \   000019   AB..         MOV     R3,?V0 + 1
   \   00001B   12....       LCALL   ??osal_msg_allocate?relay
   \   00001E   8A..         MOV     ?V0 + 8,R2
   \   000020   8B..         MOV     ?V0 + 9,R3
   \   000022   AE..         MOV     R6,?V0 + 8
   \   000024   AF..         MOV     R7,?V0 + 9
   1944            if ( msgPtr )
   \   000026   EE           MOV     A,R6
   \   000027   4F           ORL     A,R7
   \   000028   6034         JZ      ??ZDApp_SendMsg_0
   1945            {
   1946              if ( (len > 0) && (buf != NULL) )
   \   00002A   E5..         MOV     A,?V0 + 5
   \   00002C   6020         JZ      ??ZDApp_SendMsg_1
   \   00002E   E5..         MOV     A,?V0 + 2
   \   000030   45..         ORL     A,?V0 + 3
   \   000032   601A         JZ      ??ZDApp_SendMsg_1
   1947                osal_memcpy( msgPtr, buf, len );
   \   000034                ; Setup parameters for call to function osal_memcpy
   \   000034   85....       MOV     ?V0 + 8,?V0 + 2
   \   000037   85....       MOV     ?V0 + 9,?V0 + 3
   \   00003A   75..00       MOV     ?V0 + 10,#0x0
   \   00003D   78..         MOV     R0,#?V0 + 8
   \   00003F   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000042   AC..         MOV     R4,?V0 + 0
   \   000044   AD..         MOV     R5,?V0 + 1
   \   000046   12....       LCALL   ??osal_memcpy?relay
   \   000049   7403         MOV     A,#0x3
   \   00004B   12....       LCALL   ?DEALLOC_XSTACK8
   1948          
   1949              msgPtr->event = cmd;
   \                     ??ZDApp_SendMsg_1:
   \   00004E   8E82         MOV     DPL,R6
   \   000050   8F83         MOV     DPH,R7
   \   000052   E5..         MOV     A,?V0 + 6
   \   000054   F0           MOVX    @DPTR,A
   1950              osal_msg_send( taskID, (uint8 *)msgPtr );
   \   000055                ; Setup parameters for call to function osal_msg_send
   \   000055   EE           MOV     A,R6
   \   000056   FA           MOV     R2,A
   \   000057   EF           MOV     A,R7
   \   000058   FB           MOV     R3,A
   \   000059   A9..         MOV     R1,?V0 + 4
   \   00005B   12....       LCALL   ??osal_msg_send?relay
   1951            }
   1952          }
   \                     ??ZDApp_SendMsg_0:
   \   00005E   7F0B         MOV     R7,#0xb
   \   000060   02....       LJMP    ?BANKED_LEAVE_XDATA
   1953          
   1954          /*********************************************************************
   1955           * Call Back Functions from NWK  - API
   1956           */
   1957          
   1958          /*********************************************************************
   1959           * @fn          ZDO_NetworkDiscoveryConfirmCB
   1960           *
   1961           * @brief       This function returns a choice of PAN to join.
   1962           *
   1963           * @param       status - return status of the nwk discovery confirm
   1964           *
   1965           * @return      ZStatus_t
   1966           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1967          ZStatus_t ZDO_NetworkDiscoveryConfirmCB(uint8 status)
   \                     ZDO_NetworkDiscoveryConfirmCB:
   1968          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 3
   \   000004   74FD         MOV     A,#-0x3
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
   \   000009   E9           MOV     A,R1
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   F0           MOVX    @DPTR,A
   1969            osal_event_hdr_t msg;
   1970          
   1971            // If Scan is initiated by ZDO_MGMT_NWK_DISC_REQ
   1972            // Send ZDO_MGMT_NWK_DISC_RSP back
   1973          #if defined ( ZDO_MGMT_NWKDISC_RESPONSE )
   1974            if ( zdappMgmtNwkDiscReqInProgress )
   1975            {
   1976              zdappMgmtNwkDiscReqInProgress = false;
   1977              ZDO_FinishProcessingMgmtNwkDiscReq();
   1978            }
   1979            else
   1980          #endif
   1981            {
   1982              // Pass the confirm to another task if it registers the callback
   1983              // Otherwise, pass the confirm to ZDApp.
   1984              if (zdoCBFunc[ZDO_NWK_DISCOVERY_CNF_CBID] != NULL )
   \   000011   90....       MOV     DPTR,#zdoCBFunc + 4
   \   000014   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_10:
   \   000017   6013         JZ      ??ZDO_NetworkDiscoveryConfirmCB_0
   1985              {
   1986                zdoCBFunc[ZDO_NWK_DISCOVERY_CNF_CBID]( (void*)&status );
   \   000019                ; Setup parameters for indirect call
   \   000019   85..82       MOV     DPL,?XSP + 0
   \   00001C   85..83       MOV     DPH,?XSP + 1
   \   00001F   AA82         MOV     R2,DPL
   \   000021   AB83         MOV     R3,DPH
   \   000023   8882         MOV     DPL,R0
   \   000025   8983         MOV     DPH,R1
   \   000027   12....       LCALL   ?CALL_IND
   \   00002A   8016         SJMP    ??CrossCallReturnLabel_21
   1987              }
   1988              else
   1989              {
   1990                // Otherwise, send scan confirm to ZDApp task to proceed
   1991                msg.status = ZDO_SUCCESS;
   \                     ??ZDO_NetworkDiscoveryConfirmCB_0:
   \   00002C   7402         MOV     A,#0x2
   \   00002E   12....       LCALL   ?XSTACK_DISP0_8
   \   000031   E4           CLR     A
   \   000032   F0           MOVX    @DPTR,A
   1992                ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_DISC_CNF, sizeof(osal_event_hdr_t), (uint8 *)&msg );
   \   000033                ; Setup parameters for call to function ZDApp_SendMsg
   \   000033   04           INC     A
   \   000034   12....       LCALL   ?XSTACK_DISP0_8
   \   000037   AC82         MOV     R4,DPL
   \   000039   AD83         MOV     R5,DPH
   \   00003B   7B02         MOV     R3,#0x2
   \   00003D   7A01         MOV     R2,#0x1
   \   00003F   12....       LCALL   ?Subroutine22 & 0xFFFF
   1993              }
   1994            }
   1995            return (ZSuccess);
   \                     ??CrossCallReturnLabel_21:
   \   000042   7900         MOV     R1,#0x0
   \   000044   7403         MOV     A,#0x3
   \   000046   12....       LCALL   ?DEALLOC_XSTACK8
   \   000049   02....       LJMP    ??Subroutine47_0 & 0xFFFF
   1996          }  // ZDO_NetworkDiscoveryConfirmCB
   1997          
   1998          /*********************************************************************
   1999           * @fn          ZDApp_NwkDescListProcessing
   2000           *
   2001           * @brief       This function process the network discovery result and select
   2002           *              a parent device to join itself.
   2003           *
   2004           * @param       none
   2005           *
   2006           * @return      ZStatus_t
   2007           */
   2008          #define STACK_PROFILE_MAX 2

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2009          networkDesc_t* ZDApp_NwkDescListProcessing(void)
   \                     ZDApp_NwkDescListProcessing:
   2010          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   2011            networkDesc_t *pNwkDesc;
   2012            uint8 i, ResultCount = 0;
   \   000005   75..00       MOV     ?V0 + 0,#0x0
   2013            uint8 stackProfile;
   2014            uint8 stackProfilePro;
   2015            uint8 selected;
   2016          
   2017            // Count the number of nwk descriptors in the list
   2018            pNwkDesc = nwk_getNwkDescList();
   \   000008                ; Setup parameters for call to function nwk_getNwkDescList
   \   000008   12....       LCALL   ??nwk_getNwkDescList?relay
   \   00000B   8A..         MOV     ?V0 + 2,R2
   \   00000D   8B..         MOV     ?V0 + 3,R3
   \   00000F   AE..         MOV     R6,?V0 + 2
   \   000011   AF..         MOV     R7,?V0 + 3
   2019            while (pNwkDesc)
   \   000013   EE           MOV     A,R6
   \   000014   4F           ORL     A,R7
   \   000015   6009         JZ      ??ZDApp_NwkDescListProcessing_0
   2020            {
   2021              ResultCount++;
   \                     ??ZDApp_NwkDescListProcessing_1:
   \   000017   05..         INC     ?V0 + 0
   2022              pNwkDesc = pNwkDesc->nextDesc;
   \   000019   12....       LCALL   ?Subroutine19 & 0xFFFF
   2023            }
   \                     ??CrossCallReturnLabel_95:
   \   00001C   EE           MOV     A,R6
   \   00001D   4F           ORL     A,R7
   \   00001E   70F7         JNZ     ??ZDApp_NwkDescListProcessing_1
   2024          
   2025            // process discovery results
   2026            stackProfilePro = FALSE;
   \                     ??ZDApp_NwkDescListProcessing_0:
   \   000020   75..00       MOV     ?V0 + 3,#0x0
   2027            selected = FALSE;
   2028          
   2029          
   2030            for ( stackProfile = 0; stackProfile < STACK_PROFILE_MAX; stackProfile++ )
   \   000023   75..00       MOV     ?V0 + 1,#0x0
   2031            {
   2032              pNwkDesc = nwk_getNwkDescList();
   \                     ??ZDApp_NwkDescListProcessing_2:
   \   000026                ; Setup parameters for call to function nwk_getNwkDescList
   \   000026   12....       LCALL   ??nwk_getNwkDescList?relay
   \   000029   8A..         MOV     ?V0 + 4,R2
   \   00002B   8B..         MOV     ?V0 + 5,R3
   \   00002D   AE..         MOV     R6,?V0 + 4
   \   00002F   AF..         MOV     R7,?V0 + 5
   2033              for ( i = 0; i < ResultCount; i++, pNwkDesc = pNwkDesc->nextDesc )
   \   000031   75..00       MOV     ?V0 + 2,#0x0
   \   000034   E5..         MOV     A,?V0 + 0
   \   000036   7003         JNZ     $+5
   \   000038   02....       LJMP    ??ZDApp_NwkDescListProcessing_3 & 0xFFFF
   2034              {
   2035                if ( zgConfigPANID != 0xFFFF )
   \                     ??ZDApp_NwkDescListProcessing_4:
   \   00003B   90....       MOV     DPTR,#zgConfigPANID
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   F4           CPL     A
   \   000040   7003         JNZ     ??ZDApp_NwkDescListProcessing_5
   \   000042   A3           INC     DPTR
   \   000043   E0           MOVX    A,@DPTR
   \   000044   F4           CPL     A
   \                     ??ZDApp_NwkDescListProcessing_5:
   \   000045   600F         JZ      ??ZDApp_NwkDescListProcessing_6
   2036                {
   2037                  // PAN Id is preconfigured. check if it matches
   2038                  if ( pNwkDesc->panId != zgConfigPANID )
   \   000047   12....       LCALL   ?Subroutine28 & 0xFFFF
   2039                    continue;
   2040                }
   \                     ??CrossCallReturnLabel_117:
   \   00004A   90....       MOV     DPTR,#zgConfigPANID
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   68           XRL     A,R0
   \   00004F   7003         JNZ     ??ZDApp_NwkDescListProcessing_7
   \   000051   A3           INC     DPTR
   \   000052   E0           MOVX    A,@DPTR
   \   000053   69           XRL     A,R1
   \                     ??ZDApp_NwkDescListProcessing_7:
   \   000054   706B         JNZ     ??ZDApp_NwkDescListProcessing_8
   2041          
   2042                if ( nwk_ExtPANIDValid( ZDO_UseExtendedPANID) == true )
   \                     ??ZDApp_NwkDescListProcessing_6:
   \   000056                ; Setup parameters for call to function nwk_ExtPANIDValid
   \   000056   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   000058   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   00005A   12....       LCALL   ??nwk_ExtPANIDValid?relay
   \   00005D   E9           MOV     A,R1
   \   00005E   6401         XRL     A,#0x1
   \   000060   7012         JNZ     ??ZDApp_NwkDescListProcessing_9
   2043                {
   2044                  // If the extended Pan ID is commissioned to a non zero value
   2045                  // Only join the Pan that has match EPID
   2046                  if ( osal_ExtAddrEqual( ZDO_UseExtendedPANID, pNwkDesc->extendedPANID) == false )
   \   000062                ; Setup parameters for call to function sAddrExtCmp
   \   000062   EE           MOV     A,R6
   \   000063   240B         ADD     A,#0xb
   \   000065   FC           MOV     R4,A
   \   000066   EF           MOV     A,R7
   \   000067   3400         ADDC    A,#0x0
   \   000069   FD           MOV     R5,A
   \   00006A   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   00006C   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   00006E   12....       LCALL   ??sAddrExtCmp?relay
   \   000071   E9           MOV     A,R1
   \   000072   604D         JZ      ??ZDApp_NwkDescListProcessing_8
   2047                    continue;
   2048          
   2049                }
   2050          
   2051                // check that network is allowing joining
   2052                if ( ZSTACK_ROUTER_BUILD )
   2053                {
   2054                  if ( stackProfilePro == FALSE )
   2055                  {
   2056                    if ( !pNwkDesc->routerCapacity )
   2057                    {
   2058                      continue;
   2059                    }
   2060                  }
   2061                  else
   2062                  {
   2063                    if ( !pNwkDesc->deviceCapacity )
   2064                    {
   2065                      continue;
   2066                    }
   2067                  }
   2068                }
   2069                else if ( ZSTACK_END_DEVICE_BUILD )
   2070                {
   2071                  if ( !pNwkDesc->deviceCapacity )
   \                     ??ZDApp_NwkDescListProcessing_9:
   \   000074   8E82         MOV     DPL,R6
   \   000076   8F83         MOV     DPH,R7
   \   000078   A3           INC     DPTR
   \   000079   A3           INC     DPTR
   \   00007A   A3           INC     DPTR
   \   00007B   A3           INC     DPTR
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   6042         JZ      ??ZDApp_NwkDescListProcessing_8
   2072                  {
   2073                    continue;
   2074                  }
   2075                }
   2076          
   2077                // check version of zigbee protocol
   2078                if ( pNwkDesc->version != _NIB.nwkProtocolVersion )
   \   00007F   8E82         MOV     DPL,R6
   \   000081   8F83         MOV     DPH,R7
   \   000083   A3           INC     DPTR
   \   000084   A3           INC     DPTR
   \   000085   A3           INC     DPTR
   \   000086   A3           INC     DPTR
   \   000087   A3           INC     DPTR
   \   000088   E0           MOVX    A,@DPTR
   \   000089   F8           MOV     R0,A
   \   00008A   90....       MOV     DPTR,#_NIB + 17
   \   00008D   E0           MOVX    A,@DPTR
   \   00008E   68           XRL     A,R0
   \   00008F   7030         JNZ     ??ZDApp_NwkDescListProcessing_8
   2079                  continue;
   2080          
   2081                // check version of stack profile
   2082                if ( pNwkDesc->stackProfile != zgStackProfile  )
   \   000091   8E82         MOV     DPL,R6
   \   000093   8F83         MOV     DPH,R7
   \   000095   A3           INC     DPTR
   \   000096   A3           INC     DPTR
   \   000097   A3           INC     DPTR
   \   000098   A3           INC     DPTR
   \   000099   A3           INC     DPTR
   \   00009A   A3           INC     DPTR
   \   00009B   E0           MOVX    A,@DPTR
   \   00009C   F8           MOV     R0,A
   \   00009D   90....       MOV     DPTR,#zgStackProfile
   \   0000A0   E0           MOVX    A,@DPTR
   \   0000A1   68           XRL     A,R0
   \   0000A2   602C         JZ      ??ZDApp_NwkDescListProcessing_10
   2083                {
   2084                  if ( ((zgStackProfile == HOME_CONTROLS) && (pNwkDesc->stackProfile == ZIGBEEPRO_PROFILE))
   2085                      || ((zgStackProfile == ZIGBEEPRO_PROFILE) && (pNwkDesc->stackProfile == HOME_CONTROLS))  )
   \   0000A4   E0           MOVX    A,@DPTR
   \   0000A5   6401         XRL     A,#0x1
   \   0000A7   7007         JNZ     ??ZDApp_NwkDescListProcessing_11
   \   0000A9   7402         MOV     A,#0x2
   \   0000AB   68           XRL     A,R0
   \   0000AC   700F         JNZ     ??ZDApp_NwkDescListProcessing_12
   \   0000AE   800A         SJMP    ??ZDApp_NwkDescListProcessing_13
   \                     ??ZDApp_NwkDescListProcessing_11:
   \   0000B0   E0           MOVX    A,@DPTR
   \   0000B1   6402         XRL     A,#0x2
   \   0000B3   7008         JNZ     ??ZDApp_NwkDescListProcessing_12
   \   0000B5   7401         MOV     A,#0x1
   \   0000B7   68           XRL     A,R0
   \   0000B8   7003         JNZ     ??ZDApp_NwkDescListProcessing_12
   2086                  {
   2087                    stackProfilePro = TRUE;
   \                     ??ZDApp_NwkDescListProcessing_13:
   \   0000BA   75..01       MOV     ?V0 + 3,#0x1
   2088                  }
   2089          
   2090                  if ( stackProfile == 0 )
   \                     ??ZDApp_NwkDescListProcessing_12:
   \   0000BD   E5..         MOV     A,?V0 + 1
   \   0000BF   700F         JNZ     ??ZDApp_NwkDescListProcessing_10
   2091                  {
   2092                    continue;
   2093                  }
   2094                }
   2095          
   2096                break;
   2097              }
   \                     ??ZDApp_NwkDescListProcessing_8:
   \   0000C1   05..         INC     ?V0 + 2
   \   0000C3   12....       LCALL   ?Subroutine19 & 0xFFFF
   \                     ??CrossCallReturnLabel_96:
   \   0000C6   E5..         MOV     A,?V0 + 2
   \   0000C8   C3           CLR     C
   \   0000C9   95..         SUBB    A,?V0 + 0
   \   0000CB   5003         JNC     $+5
   \   0000CD   02....       LJMP    ??ZDApp_NwkDescListProcessing_4 & 0xFFFF
   2098          
   2099              if (i < ResultCount)
   \                     ??ZDApp_NwkDescListProcessing_10:
   \   0000D0   E5..         MOV     A,?V0 + 2
   \   0000D2   C3           CLR     C
   \   0000D3   95..         SUBB    A,?V0 + 0
   \   0000D5   4010         JC      ??ZDApp_NwkDescListProcessing_14
   2100              {
   2101               selected = TRUE;
   2102                break;
   2103              }
   2104          
   2105              // break if selected or stack profile pro wasn't found
   2106              if ( (selected == TRUE) || (stackProfilePro == FALSE) )
   \                     ??ZDApp_NwkDescListProcessing_3:
   \   0000D7   E5..         MOV     A,?V0 + 3
   \   0000D9   600C         JZ      ??ZDApp_NwkDescListProcessing_14
   2107              {
   2108                break;
   2109              }
   2110            }
   \   0000DB   05..         INC     ?V0 + 1
   \   0000DD   E5..         MOV     A,?V0 + 1
   \   0000DF   C3           CLR     C
   \   0000E0   9402         SUBB    A,#0x2
   \   0000E2   5003         JNC     $+5
   \   0000E4   02....       LJMP    ??ZDApp_NwkDescListProcessing_2 & 0xFFFF
   2111          
   2112            if ( i == ResultCount )
   \                     ??ZDApp_NwkDescListProcessing_14:
   \   0000E7   E5..         MOV     A,?V0 + 0
   \   0000E9   65..         XRL     A,?V0 + 2
   \   0000EB   7006         JNZ     ??ZDApp_NwkDescListProcessing_15
   2113            {
   2114              return (NULL);   // couldn't find appropriate PAN to join !
   \   0000ED   7A00         MOV     R2,#0x0
   \   0000EF   7B00         MOV     R3,#0x0
   \   0000F1   8004         SJMP    ??ZDApp_NwkDescListProcessing_16
   2115            }
   2116            else
   2117            {
   2118              return (pNwkDesc);
   \                     ??ZDApp_NwkDescListProcessing_15:
   \   0000F3   EE           MOV     A,R6
   \   0000F4   FA           MOV     R2,A
   \   0000F5   EF           MOV     A,R7
   \   0000F6   FB           MOV     R3,A
   2119            }
   \                     ??ZDApp_NwkDescListProcessing_16:
   \   0000F7   02....       LJMP    ?Subroutine4 & 0xFFFF
   2120          }// ZDApp_NwkDescListProcessing()

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine19:
   \   000000   EE           MOV     A,R6
   \   000001   2414         ADD     A,#0x14
   \   000003   12....       LCALL   ?Subroutine41 & 0xFFFF
   \                     ??CrossCallReturnLabel_110:
   \   000006                REQUIRE ??Subroutine54_0
   \   000006                ; // Fall through to label ??Subroutine54_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine54_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FE           MOV     R6,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FF           MOV     R7,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine41:
   \   000000   F582         MOV     DPL,A
   \   000002   EF           MOV     A,R7
   \   000003                REQUIRE ??Subroutine55_0
   \   000003                ; // Fall through to label ??Subroutine55_0
   2121          
   2122          /*********************************************************************
   2123           * @fn          ZDO_NetworkFormationConfirmCB
   2124           *
   2125           * @brief       This function reports the results of the request to
   2126           *              initialize a coordinator in a network.
   2127           *
   2128           * @param       Status - Result of NLME_NetworkFormationRequest()
   2129           *
   2130           * @return      none
   2131           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL   ??Subroutine42_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_64:
   \   000003                REQUIRE ??Subroutine51_0
   \   000003                ; // Fall through to label ??Subroutine51_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2132          void ZDO_NetworkFormationConfirmCB( ZStatus_t Status )
   \                     ZDO_NetworkFormationConfirmCB:
   2133          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   2134            nwkStatus = (byte)Status;
   \   000006   90....       MOV     DPTR,#nwkStatus
   \   000009   F0           MOVX    @DPTR,A
   2135          
   2136            if ( Status == ZSUCCESS )
   \   00000A   7008         JNZ     ??ZDO_NetworkFormationConfirmCB_0
   2137            {
   2138              // LED on shows Coordinator started
   2139              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   12....       LCALL   ?Subroutine38 & 0xFFFF
   2140          
   2141              // LED off forgets HOLD_AUTO_START
   2142              HalLedSet (HAL_LED_4, HAL_LED_MODE_OFF);
   2143          
   2144          #if defined ( ZBIT )
   2145              SIM_SetColor(0xd0ffd0);
   2146          #endif
   2147          
   2148              if ( devState == DEV_HOLD )
   \                     ??CrossCallReturnLabel_54:
   \   00000F   7003         JNZ     ??ZDO_NetworkFormationConfirmCB_0
   2149              {
   2150                // Began with HOLD_AUTO_START
   2151                devState = DEV_COORD_STARTING;
   \   000011   7408         MOV     A,#0x8
   \   000013   F0           MOVX    @DPTR,A
   2152              }
   2153            }
   2154          #if defined(BLINK_LEDS)
   2155            else
   2156            {
   2157              HalLedSet ( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   2158            }
   2159          #endif
   2160          
   2161            osal_set_event( ZDAppTaskID, ZDO_NETWORK_START );
   \                     ??ZDO_NetworkFormationConfirmCB_0:
   \   000014                ; Setup parameters for call to function osal_set_event
   \   000014   7A02         MOV     R2,#0x2
   \   000016   02....       LJMP    ?Subroutine0 & 0xFFFF
   2162          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine38:
   \   000000   7A01         MOV     R2,#0x1
   \   000002   7904         MOV     R1,#0x4
   \   000004   12....       LCALL   ??HalLedSet?relay
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007   7A00         MOV     R2,#0x0
   \   000009   7908         MOV     R1,#0x8
   \   00000B   12....       LCALL   ??HalLedSet?relay
   \   00000E   90....       MOV     DPTR,#devState
   \   000011   E0           MOVX    A,@DPTR
   \   000012   22           RET
   2163          
   2164          /****************************************************************************
   2165           * @fn          ZDApp_beaconIndProcessing
   2166           *
   2167           * @brief       This function processes the incoming beacon indication.
   2168           *
   2169           *              When another task (MT or App) is registered to process
   2170           *              beacon indication themselves, this function will parse the
   2171           *              beacon payload and pass the beacon descriptor to that task
   2172           *              If no other tasks registered, this function will process
   2173           *              the beacon payload and generate the network descriptor link
   2174           *              list.
   2175           *
   2176           * @param
   2177           *
   2178           * @return      none
   2179           *
   2180           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2181          void ZDO_beaconNotifyIndCB( NLME_beaconInd_t *pBeacon )
   \                     ZDO_beaconNotifyIndCB:
   2182          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   2183            // Pass the beacon Indication to another task if it registers the callback
   2184            // Otherwise, process the beacon notification here.
   2185            if (zdoCBFunc[ZDO_BEACON_NOTIFY_IND_CBID] != NULL )
   \   000009   90....       MOV     DPTR,#zdoCBFunc + 6
   \   00000C   12....       LCALL   ?Subroutine15 & 0xFFFF
   \                     ??CrossCallReturnLabel_15:
   \   00000F   6006         JZ      ??ZDO_beaconNotifyIndCB_0
   2186            {
   2187              zdoCBFunc[ZDO_BEACON_NOTIFY_IND_CBID]( (void*)pBeacon );
   \   000011                ; Setup parameters for indirect call
   \   000011   12....       LCALL   ?CALL_IND
   \   000014   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   2188            }
   2189            else
   2190            {
   2191              networkDesc_t *pNwkDesc;
   2192              networkDesc_t *pLastNwkDesc;
   2193              uint8 found = false;
   2194          
   2195              // Add the network to the Network Descriptor List
   2196              pNwkDesc = NwkDescList;
   \                     ??ZDO_beaconNotifyIndCB_0:
   \   000017   90....       MOV     DPTR,#NwkDescList
   \   00001A   12....       LCALL   ??Subroutine54_0 & 0xFFFF
   2197              pLastNwkDesc = NwkDescList;
   \                     ??CrossCallReturnLabel_92:
   \   00001D   90....       MOV     DPTR,#NwkDescList
   \   000020   E0           MOVX    A,@DPTR
   \   000021   F5..         MOV     ?V0 + 2,A
   \   000023   A3           INC     DPTR
   \   000024   E0           MOVX    A,@DPTR
   \   000025   F5..         MOV     ?V0 + 3,A
   \   000027   EA           MOV     A,R2
   \   000028   2404         ADD     A,#0x4
   \   00002A   F8           MOV     R0,A
   \   00002B   EB           MOV     A,R3
   \   00002C   3400         ADDC    A,#0x0
   \   00002E   F9           MOV     R1,A
   \   00002F   EA           MOV     A,R2
   \   000030   2402         ADD     A,#0x2
   \   000032   0A           INC     R2
   \   000033   0A           INC     R2
   \   000034   EB           MOV     A,R3
   \   000035   3400         ADDC    A,#0x0
   \   000037   FB           MOV     R3,A
   \   000038   8027         SJMP    ??CrossCallReturnLabel_97
   2198              while (pNwkDesc)
   2199              {
   2200                if ((pNwkDesc->panId == pBeacon->panID) &&
   2201                    (pNwkDesc->logicalChannel == pBeacon->logicalChannel))
   \                     ??ZDO_beaconNotifyIndCB_2:
   \   00003A   12....       LCALL   ?Subroutine26 & 0xFFFF
   \                     ??CrossCallReturnLabel_81:
   \   00003D   8A82         MOV     DPL,R2
   \   00003F   8B83         MOV     DPH,R3
   \   000041   E0           MOVX    A,@DPTR
   \   000042   6C           XRL     A,R4
   \   000043   7003         JNZ     ??ZDO_beaconNotifyIndCB_3
   \   000045   A3           INC     DPTR
   \   000046   E0           MOVX    A,@DPTR
   \   000047   6D           XRL     A,R5
   \                     ??ZDO_beaconNotifyIndCB_3:
   \   000048   7010         JNZ     ??ZDO_beaconNotifyIndCB_4
   \   00004A   8E82         MOV     DPL,R6
   \   00004C   8F83         MOV     DPH,R7
   \   00004E   A3           INC     DPTR
   \   00004F   A3           INC     DPTR
   \   000050   E0           MOVX    A,@DPTR
   \   000051   FC           MOV     R4,A
   \   000052   8882         MOV     DPL,R0
   \   000054   8983         MOV     DPH,R1
   \   000056   E0           MOVX    A,@DPTR
   \   000057   6C           XRL     A,R4
   \   000058   605F         JZ      ??ZDO_beaconNotifyIndCB_5
   2202                {
   2203                  found = true;
   2204                  break;
   2205                }
   2206                pLastNwkDesc = pNwkDesc;
   \                     ??ZDO_beaconNotifyIndCB_4:
   \   00005A   8E..         MOV     ?V0 + 2,R6
   \   00005C   8F..         MOV     ?V0 + 3,R7
   2207                pNwkDesc = pNwkDesc->nextDesc;
   \   00005E   12....       LCALL   ?Subroutine19 & 0xFFFF
   2208              }
   \                     ??CrossCallReturnLabel_97:
   \   000061   EE           MOV     A,R6
   \   000062   4F           ORL     A,R7
   \   000063   70D5         JNZ     ??ZDO_beaconNotifyIndCB_2
   2209          
   2210              // If no existing descriptor found, make a new one and add to the list
   2211              if (found == false)
   2212              {
   2213                pNwkDesc = osal_mem_alloc( sizeof(networkDesc_t)  );
   \   000065                ; Setup parameters for call to function osal_mem_alloc
   \   000065   7A16         MOV     R2,#0x16
   \   000067   7B00         MOV     R3,#0x0
   \   000069   12....       LCALL   ??osal_mem_alloc?relay
   \   00006C   8A..         MOV     ?V0 + 4,R2
   \   00006E   8B..         MOV     ?V0 + 5,R3
   \   000070   AE..         MOV     R6,?V0 + 4
   \   000072   AF..         MOV     R7,?V0 + 5
   2214                if ( !pNwkDesc )
   \   000074   EE           MOV     A,R6
   \   000075   4F           ORL     A,R7
   \   000076   7003         JNZ     $+5
   \   000078   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   2215                {
   2216                  // Memory alloc failed, discard this beacon
   2217                  return;
   2218                }
   2219          
   2220                // Clear the network descriptor
   2221                osal_memset( pNwkDesc, 0, sizeof(networkDesc_t)  );
   \   00007B                ; Setup parameters for call to function osal_memset
   \   00007B   7C16         MOV     R4,#0x16
   \   00007D   7D00         MOV     R5,#0x0
   \   00007F   7900         MOV     R1,#0x0
   \   000081   12....       LCALL   ??osal_memset?relay
   2222          
   2223                // Initialize the descriptor
   2224                pNwkDesc->chosenRouter = INVALID_NODE_ADDR;
   \   000084   8E82         MOV     DPL,R6
   \   000086   8F83         MOV     DPH,R7
   \   000088   A3           INC     DPTR
   \   000089   A3           INC     DPTR
   \   00008A   A3           INC     DPTR
   \   00008B   A3           INC     DPTR
   \   00008C   A3           INC     DPTR
   \   00008D   A3           INC     DPTR
   \   00008E   A3           INC     DPTR
   \   00008F   74FE         MOV     A,#-0x2
   \   000091   F0           MOVX    @DPTR,A
   \   000092   A3           INC     DPTR
   \   000093   04           INC     A
   \   000094   12....       LCALL   ?Subroutine11 & 0xFFFF
   2225                pNwkDesc->chosenRouterDepth = 0xFF;
   \                     ??CrossCallReturnLabel_3:
   \   000097   A3           INC     DPTR
   \   000098   A3           INC     DPTR
   \   000099   A3           INC     DPTR
   \   00009A   A3           INC     DPTR
   \   00009B   F0           MOVX    @DPTR,A
   2226          
   2227                // Save new entry into the descriptor list
   2228                if ( !NwkDescList )
   \   00009C   90....       MOV     DPTR,#NwkDescList
   \   00009F   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_11:
   \   0000A2   7005         JNZ     ??ZDO_beaconNotifyIndCB_6
   2229                {
   2230                  NwkDescList = pNwkDesc;
   \   0000A4   90....       MOV     DPTR,#NwkDescList
   \   0000A7   800B         SJMP    ??CrossCallReturnLabel_106
   2231                }
   2232                else
   2233                {
   2234                  pLastNwkDesc->nextDesc = pNwkDesc;
   \                     ??ZDO_beaconNotifyIndCB_6:
   \   0000A9   E5..         MOV     A,?V0 + 2
   \   0000AB   2414         ADD     A,#0x14
   \   0000AD   F582         MOV     DPL,A
   \   0000AF   E5..         MOV     A,?V0 + 3
   \   0000B1   12....       LCALL   ??Subroutine55_0 & 0xFFFF
   2235                }
   2236              }
   \                     ??CrossCallReturnLabel_106:
   \   0000B4   EE           MOV     A,R6
   \   0000B5   F0           MOVX    @DPTR,A
   \   0000B6   A3           INC     DPTR
   \   0000B7   EF           MOV     A,R7
   \   0000B8   F0           MOVX    @DPTR,A
   2237          
   2238              // Update the descriptor with the incoming beacon
   2239              pNwkDesc->stackProfile   = pBeacon->stackProfile;
   \                     ??ZDO_beaconNotifyIndCB_5:
   \   0000B9   85..82       MOV     DPL,?V0 + 0
   \   0000BC   85..83       MOV     DPH,?V0 + 1
   \   0000BF   A3           INC     DPTR
   \   0000C0   A3           INC     DPTR
   \   0000C1   A3           INC     DPTR
   \   0000C2   A3           INC     DPTR
   \   0000C3   A3           INC     DPTR
   \   0000C4   A3           INC     DPTR
   \   0000C5   A3           INC     DPTR
   \   0000C6   A3           INC     DPTR
   \   0000C7   A3           INC     DPTR
   \   0000C8   12....       LCALL   ?Subroutine29 & 0xFFFF
   \                     ??CrossCallReturnLabel_35:
   \   0000CB   A3           INC     DPTR
   \   0000CC   A3           INC     DPTR
   \   0000CD   A3           INC     DPTR
   \   0000CE   F0           MOVX    @DPTR,A
   2240              pNwkDesc->version        = pBeacon->protocolVersion;
   \   0000CF   E5..         MOV     A,?V0 + 0
   \   0000D1   2408         ADD     A,#0x8
   \   0000D3   F8           MOV     R0,A
   \   0000D4   E5..         MOV     A,?V0 + 1
   \   0000D6   3400         ADDC    A,#0x0
   \   0000D8   F9           MOV     R1,A
   \   0000D9   8882         MOV     DPL,R0
   \   0000DB   8983         MOV     DPH,R1
   \   0000DD   12....       LCALL   ?Subroutine29 & 0xFFFF
   \                     ??CrossCallReturnLabel_36:
   \   0000E0   12....       LCALL   ?Subroutine13 & 0xFFFF
   2241              pNwkDesc->logicalChannel = pBeacon->logicalChannel;
   \                     ??CrossCallReturnLabel_6:
   \   0000E3   A3           INC     DPTR
   \   0000E4   A3           INC     DPTR
   \   0000E5   E0           MOVX    A,@DPTR
   \   0000E6   8E82         MOV     DPL,R6
   \   0000E8   8F83         MOV     DPH,R7
   \   0000EA   12....       LCALL   ?Subroutine13 & 0xFFFF
   2242              pNwkDesc->panId          = pBeacon->panID;
   \                     ??CrossCallReturnLabel_7:
   \   0000ED   12....       LCALL   ?Subroutine25 & 0xFFFF
   \                     ??CrossCallReturnLabel_29:
   \   0000F0   8E82         MOV     DPL,R6
   \   0000F2   8F83         MOV     DPH,R7
   \   0000F4   12....       LCALL   ??Subroutine53_0 & 0xFFFF
   2243              pNwkDesc->updateId       = pBeacon->updateID;
   \                     ??CrossCallReturnLabel_85:
   \   0000F7   E5..         MOV     A,?V0 + 0
   \   0000F9   240C         ADD     A,#0xc
   \   0000FB   F582         MOV     DPL,A
   \   0000FD   E5..         MOV     A,?V0 + 1
   \   0000FF   12....       LCALL   ??Subroutine57_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_98:
   \   000102   C0E0         PUSH    A
   \   000104   EE           MOV     A,R6
   \   000105   2413         ADD     A,#0x13
   \   000107   12....       LCALL   ?Subroutine41 & 0xFFFF
   \                     ??CrossCallReturnLabel_108:
   \   00010A   D0E0         POP     A
   \   00010C   F0           MOVX    @DPTR,A
   2244          
   2245              // Save the extended PAN ID from the beacon payload only if 1.1 version network
   2246              if ( pBeacon->protocolVersion != ZB_PROT_V1_0 )
   \   00010D   EE           MOV     A,R6
   \   00010E   240B         ADD     A,#0xb
   \   000110   FA           MOV     R2,A
   \   000111   EF           MOV     A,R7
   \   000112   3400         ADDC    A,#0x0
   \   000114   FB           MOV     R3,A
   \   000115   8882         MOV     DPL,R0
   \   000117   8983         MOV     DPH,R1
   \   000119   E0           MOVX    A,@DPTR
   \   00011A   6401         XRL     A,#0x1
   \   00011C   600F         JZ      ??ZDO_beaconNotifyIndCB_7
   2247              {
   2248                osal_cpyExtAddr( pNwkDesc->extendedPANID, pBeacon->extendedPanID );
   \   00011E                ; Setup parameters for call to function sAddrExtCpy
   \   00011E   E5..         MOV     A,?V0 + 0
   \   000120   240D         ADD     A,#0xd
   \   000122   FC           MOV     R4,A
   \   000123   E5..         MOV     A,?V0 + 1
   \   000125   3400         ADDC    A,#0x0
   \   000127   FD           MOV     R5,A
   \   000128   12....       LCALL   ??sAddrExtCpy?relay
   \   00012B   8009         SJMP    ??ZDO_beaconNotifyIndCB_8
   2249              }
   2250              else
   2251              {
   2252                osal_memset( pNwkDesc->extendedPANID, 0xFF, Z_EXTADDR_LEN );
   \                     ??ZDO_beaconNotifyIndCB_7:
   \   00012D                ; Setup parameters for call to function osal_memset
   \   00012D   7C08         MOV     R4,#0x8
   \   00012F   7D00         MOV     R5,#0x0
   \   000131   79FF         MOV     R1,#-0x1
   \   000133   12....       LCALL   ??osal_memset?relay
   2253              }
   2254          
   2255              // check if this device is a better choice to join...
   2256              // ...dont bother checking assocPermit flag is doing a rejoin
   2257              if ( ( pBeacon->LQI > gMIN_TREE_LINK_COST ) &&
   2258                  ( ( pBeacon->permitJoining == TRUE ) || ( _tmpRejoinState ) ) )
   \                     ??ZDO_beaconNotifyIndCB_8:
   \   000136   E5..         MOV     A,?V0 + 0
   \   000138   240A         ADD     A,#0xa
   \   00013A   F8           MOV     R0,A
   \   00013B   E5..         MOV     A,?V0 + 1
   \   00013D   3400         ADDC    A,#0x0
   \   00013F   F9           MOV     R1,A
   \   000140   8882         MOV     DPL,R0
   \   000142   8983         MOV     DPH,R1
   \   000144   E0           MOVX    A,@DPTR
   \   000145   FA           MOV     R2,A
   \   000146   90....       MOV     DPTR,#gMIN_TREE_LINK_COST
   \   000149   E0           MOVX    A,@DPTR
   \   00014A   C3           CLR     C
   \   00014B   9A           SUBB    A,R2
   \   00014C   4003         JC      $+5
   \   00014E   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   \   000151   85..82       MOV     DPL,?V0 + 0
   \   000154   85..83       MOV     DPH,?V0 + 1
   \   000157   A3           INC     DPTR
   \   000158   A3           INC     DPTR
   \   000159   A3           INC     DPTR
   \   00015A   A3           INC     DPTR
   \   00015B   A3           INC     DPTR
   \   00015C   E0           MOVX    A,@DPTR
   \   00015D   6401         XRL     A,#0x1
   \   00015F   6009         JZ      ??ZDO_beaconNotifyIndCB_9
   \   000161   90....       MOV     DPTR,#_tmpRejoinState
   \   000164   E0           MOVX    A,@DPTR
   \   000165   7003         JNZ     $+5
   \   000167   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   2259              {
   2260                uint8 selected = FALSE;
   \                     ??ZDO_beaconNotifyIndCB_9:
   \   00016A   7C00         MOV     R4,#0x0
   2261                uint8 capacity = FALSE;
   2262          
   2263                if ( _NIB.nwkAddrAlloc == NWK_ADDRESSING_STOCHASTIC )
   \   00016C   90....       MOV     DPTR,#_NIB + 96
   \   00016F   E0           MOVX    A,@DPTR
   \   000170   6402         XRL     A,#0x2
   \   000172   7024         JNZ     ??ZDO_beaconNotifyIndCB_10
   \   000174   8E82         MOV     DPL,R6
   \   000176   8F83         MOV     DPH,R7
   \   000178   A3           INC     DPTR
   \   000179   A3           INC     DPTR
   \   00017A   A3           INC     DPTR
   \   00017B   A3           INC     DPTR
   \   00017C   A3           INC     DPTR
   \   00017D   A3           INC     DPTR
   \   00017E   A3           INC     DPTR
   \   00017F   A3           INC     DPTR
   \   000180   A3           INC     DPTR
   \   000181   E0           MOVX    A,@DPTR
   \   000182   FB           MOV     R3,A
   \   000183   C3           CLR     C
   \   000184   9A           SUBB    A,R2
   \   000185   500D         JNC     ??ZDO_beaconNotifyIndCB_11
   \   000187   12....       LCALL   ?Subroutine37 & 0xFFFF
   \                     ??CrossCallReturnLabel_51:
   \   00018A   12....       LCALL   ??Subroutine57_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_99:
   \   00018D   C3           CLR     C
   \   00018E   9414         SUBB    A,#0x14
   \   000190   4020         JC      ??ZDO_beaconNotifyIndCB_12
   \   000192   801F         SJMP    ??ZDO_beaconNotifyIndCB_13
   \                     ??ZDO_beaconNotifyIndCB_11:
   \   000194   EB           MOV     A,R3
   \   000195   6A           XRL     A,R2
   \   000196   701B         JNZ     ??ZDO_beaconNotifyIndCB_13
   \                     ??ZDO_beaconNotifyIndCB_10:
   \   000198   8E82         MOV     DPL,R6
   \   00019A   8F83         MOV     DPH,R7
   \   00019C   A3           INC     DPTR
   \   00019D   A3           INC     DPTR
   \   00019E   A3           INC     DPTR
   \   00019F   A3           INC     DPTR
   \   0001A0   A3           INC     DPTR
   \   0001A1   A3           INC     DPTR
   \   0001A2   A3           INC     DPTR
   \   0001A3   A3           INC     DPTR
   \   0001A4   A3           INC     DPTR
   \   0001A5   A3           INC     DPTR
   \   0001A6   E0           MOVX    A,@DPTR
   \   0001A7   FA           MOV     R2,A
   \   0001A8   12....       LCALL   ?Subroutine37 & 0xFFFF
   \                     ??CrossCallReturnLabel_52:
   \   0001AB   12....       LCALL   ??Subroutine57_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_100:
   \   0001AE   C3           CLR     C
   \   0001AF   9A           SUBB    A,R2
   \   0001B0   5001         JNC     ??ZDO_beaconNotifyIndCB_13
   2264                {
   2265                  if ( ((pBeacon->LQI   > pNwkDesc->chosenRouterLinkQuality) &&
   2266                        (pBeacon->depth < MAX_NODE_DEPTH)) ||
   2267                      ((pBeacon->LQI   == pNwkDesc->chosenRouterLinkQuality) &&
   2268                       (pBeacon->depth < pNwkDesc->chosenRouterDepth)) )
   2269                  {
   2270                    selected = TRUE;
   \                     ??ZDO_beaconNotifyIndCB_12:
   \   0001B2   0C           INC     R4
   2271                  }
   2272                }
   2273                else
   2274                {
   2275                  if ( pBeacon->depth < pNwkDesc->chosenRouterDepth )
   2276                  {
   2277                    selected = TRUE;
   2278                  }
   2279                }
   2280          
   2281                if ( ZSTACK_ROUTER_BUILD )
   2282                {
   2283                  capacity = pBeacon->routerCapacity;
   2284                }
   2285                else if ( ZSTACK_END_DEVICE_BUILD )
   2286                {
   2287                  capacity = pBeacon->deviceCapacity;
   2288                }
   2289          
   2290                if ( (capacity) && (selected) )
   \                     ??ZDO_beaconNotifyIndCB_13:
   \   0001B3   E5..         MOV     A,?V0 + 0
   \   0001B5   2407         ADD     A,#0x7
   \   0001B7   FA           MOV     R2,A
   \   0001B8   E5..         MOV     A,?V0 + 1
   \   0001BA   3400         ADDC    A,#0x0
   \   0001BC   FB           MOV     R3,A
   \   0001BD   8A82         MOV     DPL,R2
   \   0001BF   8B83         MOV     DPH,R3
   \   0001C1   E0           MOVX    A,@DPTR
   \   0001C2   6043         JZ      ??ZDO_beaconNotifyIndCB_14
   \   0001C4   EC           MOV     A,R4
   \   0001C5   A2E0         MOV     C,0xE0 /* A   */.0
   \   0001C7   5033         JNC     ??ZDO_beaconNotifyIndCB_15
   2291                {
   2292                  // this is the new chosen router for joining...
   2293                  pNwkDesc->chosenRouter            = pBeacon->sourceAddr;
   \   0001C9   85..82       MOV     DPL,?V0 + 0
   \   0001CC   85..83       MOV     DPH,?V0 + 1
   \   0001CF   12....       LCALL   ??Subroutine52_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_79:
   \   0001D2   8E82         MOV     DPL,R6
   \   0001D4   8F83         MOV     DPH,R7
   \   0001D6   A3           INC     DPTR
   \   0001D7   A3           INC     DPTR
   \   0001D8   A3           INC     DPTR
   \   0001D9   A3           INC     DPTR
   \   0001DA   A3           INC     DPTR
   \   0001DB   A3           INC     DPTR
   \   0001DC   A3           INC     DPTR
   \   0001DD   EC           MOV     A,R4
   \   0001DE   F0           MOVX    @DPTR,A
   \   0001DF   A3           INC     DPTR
   \   0001E0   ED           MOV     A,R5
   \   0001E1   F0           MOVX    @DPTR,A
   2294                  pNwkDesc->chosenRouterLinkQuality = pBeacon->LQI;
   \   0001E2   8882         MOV     DPL,R0
   \   0001E4   8983         MOV     DPH,R1
   \   0001E6   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_18:
   \   0001E9   F0           MOVX    @DPTR,A
   2295                  pNwkDesc->chosenRouterDepth       = pBeacon->depth;
   \   0001EA   12....       LCALL   ?Subroutine37 & 0xFFFF
   2296                }
   \                     ??CrossCallReturnLabel_53:
   \   0001ED   12....       LCALL   ??Subroutine55_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_107:
   \   0001F0   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_19:
   \   0001F3   A3           INC     DPTR
   \   0001F4   F0           MOVX    @DPTR,A
   2297          
   2298                if ( pBeacon->deviceCapacity )
   \   0001F5   8A82         MOV     DPL,R2
   \   0001F7   8B83         MOV     DPH,R3
   \   0001F9   E0           MOVX    A,@DPTR
   \   0001FA   600B         JZ      ??ZDO_beaconNotifyIndCB_14
   2299                  pNwkDesc->deviceCapacity = 1;
   \                     ??ZDO_beaconNotifyIndCB_15:
   \   0001FC   8E82         MOV     DPL,R6
   \   0001FE   8F83         MOV     DPH,R7
   \   000200   A3           INC     DPTR
   \   000201   A3           INC     DPTR
   \   000202   A3           INC     DPTR
   \   000203   A3           INC     DPTR
   \   000204   7401         MOV     A,#0x1
   \   000206   F0           MOVX    @DPTR,A
   2300          
   2301                if ( pBeacon->routerCapacity )
   \                     ??ZDO_beaconNotifyIndCB_14:
   \   000207   85..82       MOV     DPL,?V0 + 0
   \   00020A   85..83       MOV     DPH,?V0 + 1
   \   00020D   A3           INC     DPTR
   \   00020E   A3           INC     DPTR
   \   00020F   A3           INC     DPTR
   \   000210   A3           INC     DPTR
   \   000211   A3           INC     DPTR
   \   000212   A3           INC     DPTR
   \   000213   E0           MOVX    A,@DPTR
   \   000214   600A         JZ      ??ZDO_beaconNotifyIndCB_1
   2302                  pNwkDesc->routerCapacity = 1;
   \   000216   8E82         MOV     DPL,R6
   \   000218   8F83         MOV     DPH,R7
   \   00021A   A3           INC     DPTR
   \   00021B   A3           INC     DPTR
   \   00021C   A3           INC     DPTR
   \   00021D   7401         MOV     A,#0x1
   \   00021F   F0           MOVX    @DPTR,A
   2303              }
   2304            }
   \                     ??ZDO_beaconNotifyIndCB_1:
   \   000220                REQUIRE ?Subroutine4
   \   000220                ; // Fall through to label ?Subroutine4
   2305          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine37:
   \   000000   E5..         MOV     A,?V0 + 0
   \   000002   240B         ADD     A,#0xb
   \   000004   F582         MOV     DPL,A
   \   000006   E5..         MOV     A,?V0 + 1
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine29:
   \   000000   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_58:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine40:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   8E82         MOV     DPL,R6
   \   000003   8F83         MOV     DPH,R7
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine18:
   \   000000   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_57:
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   A3           INC     DPTR
   \   000001   A3           INC     DPTR
   \   000002   F0           MOVX    @DPTR,A
   \   000003   85..82       MOV     DPL,?V0 + 0
   \   000006   85..83       MOV     DPH,?V0 + 1
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine15:
   \   000000   12....       LCALL   ?Subroutine39 & 0xFFFF
   \                     ??CrossCallReturnLabel_119:
   \   000003   8882         MOV     DPL,R0
   \   000005   8983         MOV     DPH,R1
   \   000007   E582         MOV     A,DPL
   \   000009   4583         ORL     A,DPH
   \   00000B   22           RET
   2306          
   2307          /*********************************************************************
   2308           * @fn          ZDO_StartRouterConfirmCB
   2309           *
   2310           * @brief       This function reports the results of the request to
   2311           *              start functioning as a router in a network.
   2312           *
   2313           * @param       Status - Result of NLME_StartRouterRequest()
   2314           *
   2315           * @return      none
   2316           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2317          void ZDO_StartRouterConfirmCB( ZStatus_t Status )
   \                     ZDO_StartRouterConfirmCB:
   2318          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   2319            nwkStatus = (byte)Status;
   \   000006   90....       MOV     DPTR,#nwkStatus
   \   000009   F0           MOVX    @DPTR,A
   2320          
   2321            if ( Status == ZSUCCESS )
   \   00000A   7008         JNZ     ??ZDO_StartRouterConfirmCB_0
   2322            {
   2323              // LED on shows Router started
   2324              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   12....       LCALL   ?Subroutine38 & 0xFFFF
   2325              // LED off forgets HOLD_AUTO_START
   2326              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF);
   2327              if ( devState == DEV_HOLD )
   \                     ??CrossCallReturnLabel_55:
   \   00000F   7003         JNZ     ??ZDO_StartRouterConfirmCB_0
   2328              {
   2329                // Began with HOLD_AUTO_START
   2330                devState = DEV_END_DEVICE;
   \   000011   7406         MOV     A,#0x6
   \   000013   F0           MOVX    @DPTR,A
   2331              }
   2332            }
   2333          #if defined(BLINK_LEDS)
   2334            else
   2335            {
   2336              HalLedSet( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   2337            }
   2338          #endif
   2339          
   2340            osal_set_event( ZDAppTaskID, ZDO_ROUTER_START );
   \                     ??ZDO_StartRouterConfirmCB_0:
   \   000014                ; Setup parameters for call to function osal_set_event
   \   000014   7A20         MOV     R2,#0x20
   \   000016   02....       LJMP    ?Subroutine0 & 0xFFFF
   2341          }
   2342          
   2343          /*********************************************************************
   2344           * @fn          ZDO_JoinConfirmCB
   2345           *
   2346           * @brief       This function allows the next hight layer to be notified
   2347           *              of the results of its request to join itself or another
   2348           *              device to a network.
   2349           *
   2350           * @param       Status - Result of NLME_JoinRequest()
   2351           *
   2352           * @return      none
   2353           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2354          void ZDO_JoinConfirmCB( uint16 PanId, ZStatus_t Status )
   \                     ZDO_JoinConfirmCB:
   2355          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
   2356            (void)PanId;  // remove if this parameter is used.
   2357          
   2358            nwkStatus = (byte)Status;
   \   00000C   90....       MOV     DPTR,#nwkStatus
   \   00000F   F0           MOVX    @DPTR,A
   2359          
   2360            if ( Status == ZSUCCESS )
   \   000010   7008         JNZ     ??ZDO_JoinConfirmCB_0
   2361            {
   2362              // LED on shows device joined
   2363              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   000012                ; Setup parameters for call to function HalLedSet
   \   000012   12....       LCALL   ?Subroutine38 & 0xFFFF
   2364              // LED off forgets HOLD_AUTO_START
   2365              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF);
   2366              if ( (devState == DEV_HOLD) )
   \                     ??CrossCallReturnLabel_56:
   \   000015   7003         JNZ     ??ZDO_JoinConfirmCB_0
   2367              {
   2368                // Began with HOLD_AUTO_START
   2369                devState = DEV_NWK_JOINING;
   \   000017   7403         MOV     A,#0x3
   \   000019   F0           MOVX    @DPTR,A
   2370              }
   2371          
   2372              if ( !ZG_SECURE_ENABLED )
   2373              {
   2374                // Notify to save info into NV
   2375                ZDApp_NVUpdate();
   2376              }
   2377            }
   2378            else
   2379            {
   2380          #if defined(BLINK_LEDS)
   2381              HalLedSet ( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   2382          #endif
   2383            }
   2384          
   2385            // Pass the join confirm to higher layer if callback registered
   2386            if (zdoCBFunc[ZDO_JOIN_CNF_CBID] != NULL )
   \                     ??ZDO_JoinConfirmCB_0:
   \   00001A   90....       MOV     DPTR,#zdoCBFunc + 8
   \   00001D   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   000020   6035         JZ      ??ZDO_JoinConfirmCB_1
   2387            {
   2388              zdoJoinCnf_t joinCnf;
   2389          
   2390              joinCnf.status = Status;
   \   000022   EE           MOV     A,R6
   \   000023   85..82       MOV     DPL,?XSP + 0
   \   000026   85..83       MOV     DPH,?XSP + 1
   \   000029   F0           MOVX    @DPTR,A
   2391              joinCnf.deviceAddr = _NIB.nwkDevAddress;
   \   00002A   90....       MOV     DPTR,#_NIB + 20
   \   00002D   12....       LCALL   ?Subroutine25 & 0xFFFF
   \                     ??CrossCallReturnLabel_30:
   \   000030   7401         MOV     A,#0x1
   \   000032   12....       LCALL   ?XSTACK_DISP0_8
   \   000035   12....       LCALL   ??Subroutine53_0 & 0xFFFF
   2392              joinCnf.parentAddr = _NIB.nwkCoordAddress;
   \                     ??CrossCallReturnLabel_86:
   \   000038   90....       MOV     DPTR,#_NIB + 23
   \   00003B   12....       LCALL   ?Subroutine25 & 0xFFFF
   \                     ??CrossCallReturnLabel_31:
   \   00003E   7403         MOV     A,#0x3
   \   000040   12....       LCALL   ?XSTACK_DISP0_8
   \   000043   12....       LCALL   ??Subroutine53_0 & 0xFFFF
   2393          
   2394              zdoCBFunc[ZDO_JOIN_CNF_CBID]( (void*)&joinCnf );
   \                     ??CrossCallReturnLabel_87:
   \   000046                ; Setup parameters for indirect call
   \   000046   85..82       MOV     DPL,?XSP + 0
   \   000049   85..83       MOV     DPH,?XSP + 1
   \   00004C   AA82         MOV     R2,DPL
   \   00004E   AB83         MOV     R3,DPH
   \   000050   8882         MOV     DPL,R0
   \   000052   8983         MOV     DPH,R1
   \   000054   12....       LCALL   ?CALL_IND
   2395            }
   2396          
   2397            // Notify ZDApp
   2398            ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_JOIN_IND, sizeof(osal_event_hdr_t), (byte*)NULL );
   \                     ??ZDO_JoinConfirmCB_1:
   \   000057                ; Setup parameters for call to function ZDApp_SendMsg
   \   000057   7C00         MOV     R4,#0x0
   \   000059   7D00         MOV     R5,#0x0
   \   00005B   7B02         MOV     R3,#0x2
   \   00005D   7A02         MOV     R2,#0x2
   \   00005F   12....       LCALL   ?Subroutine22 & 0xFFFF
   2399          
   2400          }
   \                     ??CrossCallReturnLabel_22:
   \   000062   02....       LJMP    ?Subroutine5 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   7405         MOV     A,#0x5
   \   000002                REQUIRE ??Subroutine62_0
   \   000002                ; // Fall through to label ??Subroutine62_0
   2401          
   2402          /*********************************************************************
   2403           * @fn          ZDO_AddrChangeIndicationCB
   2404           *
   2405           * @brief       This function notifies the application that this
   2406           *              device's address has changed.  Could happen in
   2407           *              a network with stochastic addressing (PRO).
   2408           *
   2409           * @param       newAddr - the new address
   2410           *
   2411           * @return      none
   2412           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2413          void ZDO_AddrChangeIndicationCB( uint16 newAddr )
   \                     ZDO_AddrChangeIndicationCB:
   2414          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   2415            ZDO_AddrChangeInd_t *pZDOAddrChangeMsg;
   2416            epList_t *pItem = epList;
   \   000009   90....       MOV     DPTR,#epList
   \   00000C   12....       LCALL   ??Subroutine54_0 & 0xFFFF
   2417          
   2418            // Notify to save info into NV
   2419            ZDApp_NVUpdate();
   \                     ??CrossCallReturnLabel_93:
   \   00000F                ; Setup parameters for call to function ZDApp_NVUpdate
   \   00000F   12....       LCALL   ??ZDApp_NVUpdate?relay
   2420          
   2421            // Notify the applications
   2422            osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000012                ; Setup parameters for call to function osal_set_event
   \   000012   12....       LCALL   ?Subroutine16 & 0xFFFF
   2423          
   2424            while (pItem != NULL)
   \                     ??CrossCallReturnLabel_62:
   \   000015   EE           MOV     A,R6
   \   000016   4F           ORL     A,R7
   \   000017   604E         JZ      ??ZDO_AddrChangeIndicationCB_0
   2425            {
   2426              if (pItem->epDesc->endPoint != ZDO_EP)
   \                     ??ZDO_AddrChangeIndicationCB_1:
   \   000019   EE           MOV     A,R6
   \   00001A   2402         ADD     A,#0x2
   \   00001C   F8           MOV     R0,A
   \   00001D   EF           MOV     A,R7
   \   00001E   3400         ADDC    A,#0x0
   \   000020   F9           MOV     R1,A
   \   000021   88..         MOV     ?V0 + 2,R0
   \   000023   89..         MOV     ?V0 + 3,R1
   \   000025   8882         MOV     DPL,R0
   \   000027   F583         MOV     DPH,A
   \   000029   12....       LCALL   ?Subroutine20 & 0xFFFF
   \                     ??CrossCallReturnLabel_75:
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   602D         JZ      ??ZDO_AddrChangeIndicationCB_2
   2427              {
   2428                pZDOAddrChangeMsg = (ZDO_AddrChangeInd_t *)osal_msg_allocate( sizeof( ZDO_AddrChangeInd_t ) );
   \   00002F                ; Setup parameters for call to function osal_msg_allocate
   \   00002F   7A04         MOV     R2,#0x4
   \   000031   7B00         MOV     R3,#0x0
   \   000033   12....       LCALL   ??osal_msg_allocate?relay
   2429                if (pZDOAddrChangeMsg != NULL)
   \   000036   EA           MOV     A,R2
   \   000037   4B           ORL     A,R3
   \   000038   6022         JZ      ??ZDO_AddrChangeIndicationCB_2
   2430                {
   2431                  pZDOAddrChangeMsg->hdr.event = ZDO_ADDR_CHANGE_IND;
   \   00003A   8A82         MOV     DPL,R2
   \   00003C   8B83         MOV     DPH,R3
   \   00003E   74D6         MOV     A,#-0x2a
   \   000040   F0           MOVX    @DPTR,A
   2432                  pZDOAddrChangeMsg->shortAddr = newAddr;
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   E5..         MOV     A,?V0 + 0
   \   000045   F0           MOVX    @DPTR,A
   \   000046   A3           INC     DPTR
   \   000047   E5..         MOV     A,?V0 + 1
   \   000049   F0           MOVX    @DPTR,A
   2433                  osal_msg_send( *(pItem->epDesc->task_id), (uint8 *)pZDOAddrChangeMsg );
   \   00004A                ; Setup parameters for call to function osal_msg_send
   \   00004A   85..82       MOV     DPL,?V0 + 2
   \   00004D   85..83       MOV     DPH,?V0 + 3
   \   000050   12....       LCALL   ?Subroutine20 & 0xFFFF
   2434                }
   2435              }
   \                     ??CrossCallReturnLabel_76:
   \   000053   A3           INC     DPTR
   \   000054   12....       LCALL   ?Subroutine20 & 0xFFFF
   \                     ??CrossCallReturnLabel_77:
   \   000057   E0           MOVX    A,@DPTR
   \   000058   F9           MOV     R1,A
   \   000059   12....       LCALL   ??osal_msg_send?relay
   2436              pItem = pItem->nextDesc;
   \                     ??ZDO_AddrChangeIndicationCB_2:
   \   00005C   8E82         MOV     DPL,R6
   \   00005E   8F83         MOV     DPH,R7
   \   000060   12....       LCALL   ??Subroutine54_0 & 0xFFFF
   2437            }
   \                     ??CrossCallReturnLabel_94:
   \   000063   EE           MOV     A,R6
   \   000064   4F           ORL     A,R7
   \   000065   70B2         JNZ     ??ZDO_AddrChangeIndicationCB_1
   2438          
   2439            // Send out a device announce
   2440            ZDApp_AnnounceNewAddress();
   \                     ??ZDO_AddrChangeIndicationCB_0:
   \   000067                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   000067   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   2441          }
   \   00006A   02....       LJMP    ?Subroutine4 & 0xFFFF
   2442          
   2443          /*********************************************************************
   2444           * @fn          ZDO_JoinIndicationCB
   2445           *
   2446           * @brief       This function allows the next higher layer of a
   2447           *              coordinator to be notified of a remote join request.
   2448           *
   2449           * @param       ShortAddress - 16-bit address
   2450           * @param       ExtendedAddress - IEEE (64-bit) address
   2451           * @param       CapabilityFlags - Association Capability Flags
   2452           * @param       type - of joining -
   2453           *                          NWK_ASSOC_JOIN
   2454           *                          NWK_ASSOC_REJOIN_UNSECURE
   2455           *                          NWK_ASSOC_REJOIN_SECURE
   2456           *
   2457           * @return      ZStatus_t
   2458           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2459          ZStatus_t ZDO_JoinIndicationCB(uint16 ShortAddress, uint8 *ExtendedAddress,
   \                     ZDO_JoinIndicationCB:
   2460                                          uint8 CapabilityFlags, uint8 type)
   2461          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   7409         MOV     A,#0x9
   \   000007   12....       LCALL   ?XSTACK_DISP0_8
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   FE           MOV     R6,A
   2462            (void)ShortAddress;
   2463            (void)ExtendedAddress;
   2464          #if ZDO_NV_SAVE_RFDs
   2465            (void)CapabilityFlags;
   2466          
   2467          #else  // if !ZDO_NV_SAVE_RFDs
   2468            if (CapabilityFlags & CAPINFO_DEVICETYPE_FFD)
   2469          #endif
   2470            {
   2471              ZDApp_NVUpdate();  // Notify to save info into NV.
   \   00000C                ; Setup parameters for call to function ZDApp_NVUpdate
   \   00000C   12....       LCALL   ??ZDApp_NVUpdate?relay
   2472            }
   2473          
   2474            if (ZG_SECURE_ENABLED)  // Send notification to TC of new device.
   2475            {
   2476              if (type == NWK_ASSOC_JOIN || type == NWK_ASSOC_REJOIN_UNSECURE)
   \   00000F   EE           MOV     A,R6
   \   000010   6005         JZ      ??ZDO_JoinIndicationCB_0
   \   000012   7401         MOV     A,#0x1
   \   000014   6E           XRL     A,R6
   \   000015   7009         JNZ     ??CrossCallReturnLabel_124
   2477              {
   2478                osal_start_timerEx( ZDAppTaskID, ZDO_NEW_DEVICE, 600 );
   \                     ??ZDO_JoinIndicationCB_0:
   \   000017                ; Setup parameters for call to function osal_start_timerEx
   \   000017   7C58         MOV     R4,#0x58
   \   000019   7D02         MOV     R5,#0x2
   \   00001B   7A40         MOV     R2,#0x40
   \   00001D   12....       LCALL   ??Subroutine59_0 & 0xFFFF
   2479              }
   2480            }
   2481          
   2482            return ZSuccess;
   \                     ??CrossCallReturnLabel_124:
   \   000020   7900         MOV     R1,#0x0
   \   000022   02....       LJMP    ??Subroutine51_0 & 0xFFFF
   2483          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine59_0:
   \   000000   7B00         MOV     R3,#0x0
   \   000002                REQUIRE ??Subroutine60_0
   \   000002                ; // Fall through to label ??Subroutine60_0
   2484          
   2485          /*********************************************************************
   2486           * @fn          ZDO_ConcentratorIndicationCB
   2487           *
   2488           * @brief       This function allows the next higher layer of a
   2489           *              device to be notified of existence of the concentrator.
   2490           *
   2491           * @param       nwkAddr - 16-bit NWK address of the concentrator
   2492           * @param       extAddr - pointer to extended Address
   2493           *                        NULL if not available
   2494           * @param       pktCost - PktCost from RREQ
   2495           *
   2496           * @return      void
   2497           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2498          void ZDO_ConcentratorIndicationCB( uint16 nwkAddr, uint8 *extAddr, uint8 pktCost )
   \                     ZDO_ConcentratorIndicationCB:
   2499          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   2500            zdoConcentratorInd_t conInd;
   2501          
   2502            conInd.nwkAddr = nwkAddr;
   \   00000A   12....       LCALL   ?Subroutine10 & 0xFFFF
   2503            conInd.extAddr = extAddr;
   \                     ??CrossCallReturnLabel_90:
   \   00000D   7402         MOV     A,#0x2
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   EC           MOV     A,R4
   \   000013   F0           MOVX    @DPTR,A
   \   000014   A3           INC     DPTR
   \   000015   ED           MOV     A,R5
   \   000016   F0           MOVX    @DPTR,A
   2504            conInd.pktCost = pktCost;
   \   000017   7404         MOV     A,#0x4
   \   000019   12....       LCALL   ?XSTACK_DISP0_8
   \   00001C   E9           MOV     A,R1
   \   00001D   F0           MOVX    @DPTR,A
   2505          
   2506            if( zdoCBFunc[ZDO_CONCENTRATOR_IND_CBID] != NULL )
   \   00001E   90....       MOV     DPTR,#zdoCBFunc + 2
   \   000021   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_13:
   \   000024   6011         JZ      ??ZDO_ConcentratorIndicationCB_0
   2507            {
   2508              zdoCBFunc[ZDO_CONCENTRATOR_IND_CBID]( (void*)&conInd );
   \   000026                ; Setup parameters for indirect call
   \   000026   85..82       MOV     DPL,?XSP + 0
   \   000029   85..83       MOV     DPH,?XSP + 1
   \   00002C   AA82         MOV     R2,DPL
   \   00002E   AB83         MOV     R3,DPH
   \   000030   8882         MOV     DPL,R0
   \   000032   8983         MOV     DPH,R1
   \   000034   12....       LCALL   ?CALL_IND
   2509            }
   2510          }
   \                     ??ZDO_ConcentratorIndicationCB_0:
   \   000037   02....       LJMP    ?Subroutine5 & 0xFFFF
   2511          
   2512          /*********************************************************************
   2513           * @fn          ZDO_LeaveCnf
   2514           *
   2515           * @brief       This function allows the next higher layer to be
   2516           *              notified of the results of its request for this or
   2517           *              a child device to leave the network.
   2518           *
   2519           * @param       cnf - NLME_LeaveCnf_t
   2520           *
   2521           * @return      none
   2522           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2523          void ZDO_LeaveCnf( NLME_LeaveCnf_t* cnf )
   \                     ZDO_LeaveCnf:
   2524          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2525            // Check for this device
   2526            if ( osal_ExtAddrEqual( cnf->extAddr,
   2527                                    NLME_GetExtAddr() ) == TRUE )
   \   000009                ; Setup parameters for call to function sAddrExtCmp
   \   000009                ; Setup parameters for call to function NLME_GetExtAddr
   \   000009   12....       LCALL   ??NLME_GetExtAddr?relay
   \   00000C   EA           MOV     A,R2
   \   00000D   FC           MOV     R4,A
   \   00000E   EB           MOV     A,R3
   \   00000F   FD           MOV     R5,A
   \   000010   EE           MOV     A,R6
   \   000011   2402         ADD     A,#0x2
   \   000013   FA           MOV     R2,A
   \   000014   EF           MOV     A,R7
   \   000015   3400         ADDC    A,#0x0
   \   000017   FB           MOV     R3,A
   \   000018   12....       LCALL   ??sAddrExtCmp?relay
   \   00001B   E9           MOV     A,R1
   \   00001C   6401         XRL     A,#0x1
   \   00001E   701C         JNZ     ??CrossCallReturnLabel_41
   2528            {
   2529              // Pass the leave confirm to higher layer if callback registered
   2530              if ( ( zdoCBFunc[ZDO_LEAVE_CNF_CBID] == NULL ) ||
   2531                   ( (*zdoCBFunc[ZDO_LEAVE_CNF_CBID])( cnf ) == NULL ) )
   \   000020   90....       MOV     DPTR,#zdoCBFunc + 10
   \   000023   12....       LCALL   ?Subroutine15 & 0xFFFF
   \                     ??CrossCallReturnLabel_16:
   \   000026   600E         JZ      ??ZDO_LeaveCnf_0
   \   000028                ; Setup parameters for indirect call
   \   000028   EE           MOV     A,R6
   \   000029   FA           MOV     R2,A
   \   00002A   EF           MOV     A,R7
   \   00002B   FB           MOV     R3,A
   \   00002C   12....       LCALL   ?CALL_IND
   \   00002F   8B..         MOV     ?V0 + 1,R3
   \   000031   EA           MOV     A,R2
   \   000032   45..         ORL     A,?V0 + 1
   \   000034   7006         JNZ     ??CrossCallReturnLabel_41
   2532              {
   2533                // Prepare to leave with reset
   2534                ZDApp_LeaveReset( cnf->rejoin );
   \                     ??ZDO_LeaveCnf_0:
   \   000036                ; Setup parameters for call to function ZDApp_LeaveReset
   \   000036   EE           MOV     A,R6
   \   000037   240B         ADD     A,#0xb
   \   000039   12....       LCALL   ?Subroutine32 & 0xFFFF
   2535              }
   2536            }
   2537            else if ( ZSTACK_ROUTER_BUILD )
   2538            {
   2539              // Remove device address(optionally descendents) from data
   2540              ZDApp_LeaveUpdate( cnf->dstAddr,
   2541                                 cnf->extAddr,
   2542                                 cnf->removeChildren );
   2543            }
   2544          }
   \                     ??CrossCallReturnLabel_41:
   \   00003C   02....       LJMP    ??Subroutine50_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine32:
   \   000000   12....       LCALL   ?Subroutine41 & 0xFFFF
   \                     ??CrossCallReturnLabel_111:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??ZDApp_LeaveReset?relay
   \   000008   22           RET
   2545          
   2546          /*********************************************************************
   2547           * @fn          ZDO_LeaveInd
   2548           *
   2549           * @brief       This function allows the next higher layer of a
   2550           *              device to be notified of a remote leave request or
   2551           *              indication.
   2552           *
   2553           * @param       ind - NLME_LeaveInd_t
   2554           *
   2555           * @return      none
   2556           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2557          void ZDO_LeaveInd( NLME_LeaveInd_t* ind )
   \                     ZDO_LeaveInd:
   2558          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2559            uint8 leave;
   2560          
   2561          
   2562            // Parent is requesting the leave - NWK layer filters out illegal
   2563            // requests
   2564            if ( ind->request == TRUE )
   \   000009   8E82         MOV     DPL,R6
   \   00000B   8F83         MOV     DPH,R7
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   A3           INC     DPTR
   \   000012   A3           INC     DPTR
   \   000013   A3           INC     DPTR
   \   000014   A3           INC     DPTR
   \   000015   A3           INC     DPTR
   \   000016   A3           INC     DPTR
   \   000017   E0           MOVX    A,@DPTR
   \   000018   6401         XRL     A,#0x1
   \   00001A   7008         JNZ     ??ZDO_LeaveInd_0
   2565            {
   2566              // Notify network of leave
   2567              if ( ZSTACK_ROUTER_BUILD )
   2568              {
   2569                NLME_LeaveRsp_t rsp;
   2570                rsp.rejoin         = ind->rejoin;
   2571                rsp.removeChildren = ind->removeChildren;
   2572                NLME_LeaveRsp( &rsp );
   2573              }
   2574          
   2575              // Prepare to leave with reset
   2576              ZDApp_LeaveReset( ind->rejoin );
   \                     ??ZDO_LeaveInd_1:
   \   00001C                ; Setup parameters for call to function ZDApp_LeaveReset
   \   00001C   EE           MOV     A,R6
   \   00001D   240C         ADD     A,#0xc
   \   00001F   12....       LCALL   ?Subroutine32 & 0xFFFF
   2577            }
   \                     ??CrossCallReturnLabel_42:
   \   000022   8036         SJMP    ??ZDO_LeaveInd_2
   2578            else
   2579            {
   2580              leave = FALSE;
   2581          
   2582              // Check if this device needs to leave as a child or descendent
   2583              if ( ind->srcAddr == NLME_GetCoordShortAddr() )
   \                     ??ZDO_LeaveInd_0:
   \   000024                ; Setup parameters for call to function NLME_GetCoordShortAddr
   \   000024   12....       LCALL   ??NLME_GetCoordShortAddr?relay
   \   000027   8A..         MOV     ?V0 + 0,R2
   \   000029   8B..         MOV     ?V0 + 1,R3
   \   00002B   12....       LCALL   ?Subroutine33 & 0xFFFF
   \                     ??CrossCallReturnLabel_104:
   \   00002E   F9           MOV     R1,A
   \   00002F   8E82         MOV     DPL,R6
   \   000031   8F83         MOV     DPH,R7
   \   000033   12....       LCALL   ?Subroutine25 & 0xFFFF
   \                     ??CrossCallReturnLabel_32:
   \   000036   E5..         MOV     A,?V0 + 0
   \   000038   6A           XRL     A,R2
   \   000039   7003         JNZ     ??ZDO_LeaveInd_3
   \   00003B   E5..         MOV     A,?V0 + 1
   \   00003D   6B           XRL     A,R3
   \                     ??ZDO_LeaveInd_3:
   \   00003E   700F         JNZ     ??ZDO_LeaveInd_4
   2584              {
   2585                if ( ( ind->removeChildren == TRUE               ) ||
   2586                     ( ZDO_Config_Node_Descriptor.LogicalType ==
   2587                       NODETYPE_DEVICE                           )    )
   \   000040   7401         MOV     A,#0x1
   \   000042   69           XRL     A,R1
   \   000043   60D7         JZ      ??ZDO_LeaveInd_1
   \   000045   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000048   E0           MOVX    A,@DPTR
   \   000049   5407         ANL     A,#0x7
   \   00004B   6402         XRL     A,#0x2
   \   00004D   60CD         JZ      ??ZDO_LeaveInd_1
   2588                {
   2589                  leave = TRUE;
   2590                }
   2591              }
   2592              else if ( ind->removeChildren == TRUE )
   2593              {
   2594                // Check NWK address allocation algorithm
   2595                //leave = RTG_ANCESTOR(nwkAddr,thisAddr);
   2596              }
   2597          
   2598              if ( leave == TRUE )
   2599              {
   2600                // Prepare to leave with reset
   2601                ZDApp_LeaveReset( ind->rejoin );
   2602              }
   2603              else
   2604              {
   2605                // Remove device address(optionally descendents) from data
   2606                ZDApp_LeaveUpdate( ind->srcAddr,
   2607                                   ind->extAddr,
   2608                                   ind->removeChildren );
   \                     ??ZDO_LeaveInd_4:
   \   00004F                ; Setup parameters for call to function ZDApp_LeaveUpdate
   \   00004F   EE           MOV     A,R6
   \   000050   2402         ADD     A,#0x2
   \   000052   FC           MOV     R4,A
   \   000053   EF           MOV     A,R7
   \   000054   3400         ADDC    A,#0x0
   \   000056   FD           MOV     R5,A
   \   000057   12....       LCALL   ??ZDApp_LeaveUpdate?relay
   2609              }
   2610            }
   2611          
   2612            // Pass the leave indication to higher layer if callback registered.
   2613            if (zdoCBFunc[ZDO_LEAVE_IND_CBID] != NULL)
   \                     ??ZDO_LeaveInd_2:
   \   00005A   90....       MOV     DPTR,#zdoCBFunc + 12
   \   00005D   12....       LCALL   ?Subroutine15 & 0xFFFF
   \                     ??CrossCallReturnLabel_17:
   \   000060   6007         JZ      ??ZDO_LeaveInd_5
   2614            {
   2615              (void)zdoCBFunc[ZDO_LEAVE_IND_CBID](ind);
   \   000062                ; Setup parameters for indirect call
   \   000062   EE           MOV     A,R6
   \   000063   FA           MOV     R2,A
   \   000064   EF           MOV     A,R7
   \   000065   FB           MOV     R3,A
   \   000066   12....       LCALL   ?CALL_IND
   2616            }
   2617          }
   \                     ??ZDO_LeaveInd_5:
   \   000069   02....       LJMP    ??Subroutine50_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine33:
   \   000000   EE           MOV     A,R6
   \   000001   240B         ADD     A,#0xb
   \   000003                REQUIRE ??Subroutine56_0
   \   000003                ; // Fall through to label ??Subroutine56_0
   2618          
   2619          /*********************************************************************
   2620           * @fn          ZDO_SyncIndicationCB
   2621           *
   2622           * @brief       This function allows the next higher layer of a
   2623           *              coordinator to be notified of a loss of synchronization
   2624           *                          with the parent/child device.
   2625           *
   2626           * @param       type: 0 - child; 1 - parent
   2627           *
   2628           *
   2629           * @return      none
   2630           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2631          void ZDO_SyncIndicationCB( uint8 type, uint16 shortAddr )
   \                     ZDO_SyncIndicationCB:
   2632          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   2633            (void)shortAddr;  // Remove this line if this parameter is used.
   2634          
   2635            if ( ZSTACK_END_DEVICE_BUILD
   2636              || (ZSTACK_ROUTER_BUILD && ((_NIB.CapabilityFlags & ZMAC_ASSOC_CAPINFO_FFD_TYPE) == 0)))
   2637            {
   2638              if ( type == 1 )
   \   000007   7401         MOV     A,#0x1
   \   000009   6E           XRL     A,R6
   \   00000A   700E         JNZ     ??CrossCallReturnLabel_23
   2639              {
   2640                // We lost contact with our parent.  Clear the neighbor Table.
   2641                nwkNeighborInitTable();
   \   00000C                ; Setup parameters for call to function nwkNeighborInitTable
   \   00000C   12....       LCALL   ??nwkNeighborInitTable?relay
   2642          
   2643                // Start the rejoin process.
   2644                ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_JOIN_REQ, sizeof(osal_event_hdr_t), NULL );
   \   00000F                ; Setup parameters for call to function ZDApp_SendMsg
   \   00000F   7C00         MOV     R4,#0x0
   \   000011   7D00         MOV     R5,#0x0
   \   000013   7B02         MOV     R3,#0x2
   \   000015   7A03         MOV     R2,#0x3
   \   000017   12....       LCALL   ?Subroutine22 & 0xFFFF
   2645              }
   2646            }
   2647          }
   \                     ??CrossCallReturnLabel_23:
   \   00001A   02....       LJMP    ??Subroutine51_0 & 0xFFFF
   2648          
   2649          /*********************************************************************
   2650           * @fn          ZDO_ManytoOneFailureIndicationCB
   2651           *
   2652           * @brief       This function allows the next higher layer of a
   2653           *              concentrator to be notified of a many-to-one route
   2654           *              failure.
   2655           *
   2656           * @param       none
   2657           *
   2658           *
   2659           * @return      none
   2660           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2661          void ZDO_ManytoOneFailureIndicationCB()
   \                     ZDO_ManytoOneFailureIndicationCB:
   2662          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2663            // By default, the concentrator automatically redo many-to-one route
   2664            // discovery to update all many-to-one routes in the network
   2665            // If you want anything processing other than the default,
   2666            // please replace the following code.
   2667          
   2668            RTG_MTORouteReq();
   \   000004                ; Setup parameters for call to function RTG_MTORouteReq
   \   000004   12....       LCALL   ??RTG_MTORouteReq?relay
   2669          }
   \   000007   02....       LJMP    ??Subroutine47_0 & 0xFFFF
   2670          
   2671          /*********************************************************************
   2672           * @fn          ZDO_PollConfirmCB
   2673           *
   2674           * @brief       This function allows the next higher layer to be
   2675           *              notified of a Poll Confirm.
   2676           *
   2677           * @param       none
   2678           *
   2679           * @return      none
   2680           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2681          void ZDO_PollConfirmCB( uint8 status )
   \                     ZDO_PollConfirmCB:
   2682          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2683            (void)status;  // Remove this line if this parameter is used.
   2684            return;
   \   000000   02....       LJMP    ?BRET
   2685          }
   2686          
   2687          /******************************************************************************
   2688           * @fn          ZDApp_NwkWriteNVRequest (stubs AddrMgrWriteNVRequest)
   2689           *
   2690           * @brief       Stub routine implemented by NHLE. NHLE should call
   2691           *              <AddrMgrWriteNV> when appropriate.
   2692           *
   2693           * @param       none
   2694           *
   2695           * @return      none
   2696           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2697          void ZDApp_NwkWriteNVRequest( void )
   \                     AddrMgrWriteNVRequest:
   2698          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2699          #if defined ( NV_RESTORE )
   2700            if ( !osal_get_timeoutEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV ) )
   \   000005                ; Setup parameters for call to function osal_get_timeoutEx
   \   000005   12....       LCALL   ?Subroutine23 & 0xFFFF
   \                     ??CrossCallReturnLabel_24:
   \   000008   7003         JNZ     ??AddrMgrWriteNVRequest_0
   2701            {
   2702              // Trigger to save info into NV
   2703              ZDApp_NVUpdate();
   \   00000A                ; Setup parameters for call to function ZDApp_NVUpdate
   \   00000A   12....       LCALL   ??ZDApp_NVUpdate?relay
   2704            }
   2705          #endif
   2706          }
   \                     ??AddrMgrWriteNVRequest_0:
   \   00000D   02....       LJMP    ??Subroutine50_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine23:
   \   000000   7A00         MOV     R2,#0x0
   \   000002   7B02         MOV     R3,#0x2
   \   000004   90....       MOV     DPTR,#ZDAppTaskID
   \   000007   E0           MOVX    A,@DPTR
   \   000008   F9           MOV     R1,A
   \   000009   12....       LCALL   ??osal_get_timeoutEx?relay
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   EA           MOV     A,R2
   \   00000F   45..         ORL     A,?V0 + 1
   \   000011   22           RET
   2707          
   2708          /*********************************************************************
   2709           * Call Back Functions from Security  - API
   2710           */
   2711          
   2712           /*********************************************************************
   2713           * @fn          ZDO_UpdateDeviceIndication
   2714           *
   2715           * @brief       This function notifies the "Trust Center" of a
   2716           *              network when a device joins or leaves the network.
   2717           *
   2718           * @param       extAddr - pointer to 64 bit address of new device
   2719           * @param       status  - 0 if a new device joined securely
   2720           *                      - 1 if a new device joined un-securely
   2721           *                      - 2 if a device left the network
   2722           *
   2723           * @return      true if newly joined device should be allowed to
   2724           *                                              remain on network
   2725           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2726          ZStatus_t ZDO_UpdateDeviceIndication( uint8 *extAddr, uint8 status )
   \                     ZDO_UpdateDeviceIndication:
   2727          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2728            // can implement a network access policy based on the
   2729            // IEEE address of newly joining devices...
   2730            (void)extAddr;
   2731            (void)status;
   2732          
   2733            return ZSuccess;
   \   000000   7900         MOV     R1,#0x0
   \   000002   02....       LJMP    ?BRET
   2734          }
   2735          
   2736          /*********************************************************************
   2737           * @fn          ZDApp_InMsgCB
   2738           *
   2739           * @brief       This function is called to pass up any message that is
   2740           *              not yet supported.  This allows for the developer to
   2741           *              support features themselves..
   2742           *
   2743           * @return      none
   2744           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2745          void ZDApp_InMsgCB( zdoIncomingMsg_t *inMsg )
   \                     ZDApp_InMsgCB:
   2746          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2747            if ( inMsg->clusterID & ZDO_RESPONSE_BIT )
   \   000009   EE           MOV     A,R6
   \   00000A   240C         ADD     A,#0xc
   \   00000C   12....       LCALL   ?Subroutine41 & 0xFFFF
   \                     ??CrossCallReturnLabel_109:
   \   00000F   12....       LCALL   ??Subroutine58_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_115:
   \   000012   5480         ANL     A,#0x80
   \   000014   7045         JNZ     ??ZDApp_InMsgCB_0
   2748            {
   2749              // Handle the response message
   2750            }
   2751            else
   2752            {
   2753              // Handle the request message by sending a generic "not supported".
   2754              // Device Announce doesn't have a response.
   2755              if ( !(inMsg->wasBroadcast) && inMsg->clusterID != Device_annce )
   \   000016   12....       LCALL   ?Subroutine33 & 0xFFFF
   \                     ??CrossCallReturnLabel_105:
   \   000019   7040         JNZ     ??ZDApp_InMsgCB_0
   \   00001B   7413         MOV     A,#0x13
   \   00001D   68           XRL     A,R0
   \   00001E   7001         JNZ     ??ZDApp_InMsgCB_1
   \   000020   E9           MOV     A,R1
   \                     ??ZDApp_InMsgCB_1:
   \   000021   6038         JZ      ??ZDApp_InMsgCB_0
   2756              {
   2757                ZDP_GenericRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZDP_NOT_SUPPORTED, 0,
   2758                                (uint16)(inMsg->clusterID | ZDO_RESPONSE_BIT), inMsg->SecurityUse );
   \   000023                ; Setup parameters for call to function ZDP_GenericRsp
   \   000023   E8           MOV     A,R0
   \   000024   F5..         MOV     ?V0 + 0,A
   \   000026   E9           MOV     A,R1
   \   000027   4480         ORL     A,#0x80
   \   000029   F5..         MOV     ?V0 + 1,A
   \   00002B   78..         MOV     R0,#?V0 + 0
   \   00002D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000030   E4           CLR     A
   \   000031   F5..         MOV     ?V0 + 0,A
   \   000033   F5..         MOV     ?V0 + 1,A
   \   000035   78..         MOV     R0,#?V0 + 0
   \   000037   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003A   EE           MOV     A,R6
   \   00003B   240E         ADD     A,#0xe
   \   00003D   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   2759              }
   2760            }
   \                     ??CrossCallReturnLabel_102:
   \   000040   FD           MOV     R5,A
   \   000041   7C84         MOV     R4,#-0x7c
   \   000043   EE           MOV     A,R6
   \   000044   2402         ADD     A,#0x2
   \   000046   0A           INC     R2
   \   000047   0A           INC     R2
   \   000048   EF           MOV     A,R7
   \   000049   3400         ADDC    A,#0x0
   \   00004B   FB           MOV     R3,A
   \   00004C   EE           MOV     A,R6
   \   00004D   240F         ADD     A,#0xf
   \   00004F   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_103:
   \   000052   F9           MOV     R1,A
   \   000053   12....       LCALL   ??ZDP_GenericRsp?relay
   \   000056   7404         MOV     A,#0x4
   \   000058   12....       LCALL   ?DEALLOC_XSTACK8
   2761          }
   \                     ??ZDApp_InMsgCB_0:
   \   00005B   02....       LJMP    ??Subroutine50_0 & 0xFFFF
   2762          
   2763          
   2764          /*********************************************************************
   2765           * @fn      ZDApp_ChangeMatchDescRespPermission()
   2766           *
   2767           * @brief   Changes the Match Descriptor Response permission.
   2768           *
   2769           * @param   endpoint - endpoint to allow responses
   2770           * @param   action - true to allow responses, false to not
   2771           *
   2772           * @return  none
   2773           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2774          void ZDApp_ChangeMatchDescRespPermission( uint8 endpoint, uint8 action )
   \                     ZDApp_ChangeMatchDescRespPermission:
   2775          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   2776            // Store the action
   2777            afSetMatch( endpoint, action );
   \   000005                ; Setup parameters for call to function afSetMatch
   \   000005   12....       LCALL   ??afSetMatch?relay
   2778          }
   \   000008   02....       LJMP    ??Subroutine51_0 & 0xFFFF
   2779          
   2780          /*********************************************************************
   2781           * @fn      ZDApp_NetworkInit()
   2782           *
   2783           * @brief   Used to start the network joining process
   2784           *
   2785           * @param   delay - mSec delay to wait before starting
   2786           *
   2787           * @return  none
   2788           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2789          void ZDApp_NetworkInit( uint16 delay )
   \                     ZDApp_NetworkInit:
   2790          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2791            if ( delay )
   \   000004   EA           MOV     A,R2
   \   000005   4B           ORL     A,R3
   \   000006   600B         JZ      ??ZDApp_NetworkInit_0
   2792            {
   2793              // Wait awhile before starting the device
   2794              osal_start_timerEx( ZDAppTaskID, ZDO_NETWORK_INIT, delay );
   \   000008                ; Setup parameters for call to function osal_start_timerEx
   \   000008   EA           MOV     A,R2
   \   000009   FC           MOV     R4,A
   \   00000A   EB           MOV     A,R3
   \   00000B   FD           MOV     R5,A
   \   00000C   7A01         MOV     R2,#0x1
   \   00000E   12....       LCALL   ??Subroutine59_0 & 0xFFFF
   2795            }
   \                     ??CrossCallReturnLabel_125:
   \   000011   8005         SJMP    ??CrossCallReturnLabel_65
   2796            else
   2797            {
   2798              osal_set_event( ZDAppTaskID, ZDO_NETWORK_INIT );
   \                     ??ZDApp_NetworkInit_0:
   \   000013                ; Setup parameters for call to function osal_set_event
   \   000013   7A01         MOV     R2,#0x1
   \   000015   12....       LCALL   ??Subroutine42_0 & 0xFFFF
   2799            }
   2800          }
   \                     ??CrossCallReturnLabel_65:
   \   000018   02....       LJMP    ??Subroutine47_0 & 0xFFFF
   2801          
   2802          /*********************************************************************
   2803           * @fn      ZDApp_NwkStateUpdateCB()
   2804           *
   2805           * @brief   This function notifies that this device's network
   2806           *          state info has been changed.
   2807           *
   2808           * @param   none
   2809           *
   2810           * @return  none
   2811           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2812          void ZDApp_NwkStateUpdateCB( void )
   \                     ZDApp_NwkStateUpdateCB:
   2813          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2814            // Notify to save info into NV
   2815            if ( !osal_get_timeoutEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV ) )
   \   000005                ; Setup parameters for call to function osal_get_timeoutEx
   \   000005   12....       LCALL   ?Subroutine23 & 0xFFFF
   \                     ??CrossCallReturnLabel_25:
   \   000008   7003         JNZ     ??ZDApp_NwkStateUpdateCB_0
   2816            {
   2817              // Trigger to save info into NV
   2818              ZDApp_NVUpdate();
   \   00000A                ; Setup parameters for call to function ZDApp_NVUpdate
   \   00000A   12....       LCALL   ??ZDApp_NVUpdate?relay
   2819            }
   2820          }
   \                     ??ZDApp_NwkStateUpdateCB_0:
   \   00000D   02....       LJMP    ??Subroutine50_0 & 0xFFFF
   2821          
   2822          /*********************************************************************
   2823           * @fn      ZDApp_NodeProfileSync()
   2824           *
   2825           * @brief   Sync node with stack profile.
   2826           *
   2827           * @param   stackProfile - stack profile of the network to join
   2828           *
   2829           * @return  none
   2830           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2831          void ZDApp_NodeProfileSync( uint8 stackProfile )
   \                     ZDApp_NodeProfileSync:
   2832          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   2833            if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_DEVICETYPE_FFD  )
   \   000007   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000D   501A         JNC     ??ZDApp_NodeProfileSync_0
   2834            {
   2835              if ( stackProfile != zgStackProfile )
   \   00000F   90....       MOV     DPTR,#zgStackProfile
   \   000012   E0           MOVX    A,@DPTR
   \   000013   6E           XRL     A,R6
   \   000014   6013         JZ      ??ZDApp_NodeProfileSync_0
   2836              {
   2837                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_DEVICE;
   \   000016   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   54F8         ANL     A,#0xf8
   \   00001C   4402         ORL     A,#0x2
   \   00001E   F0           MOVX    @DPTR,A
   2838                ZDO_Config_Node_Descriptor.CapabilityFlags = CAPINFO_DEVICETYPE_RFD | CAPINFO_POWER_AC | CAPINFO_RCVR_ON_IDLE;
   \   00001F   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000022   740C         MOV     A,#0xc
   \   000024   F0           MOVX    @DPTR,A
   2839                NLME_SetBroadcastFilter( ZDO_Config_Node_Descriptor.CapabilityFlags );
   \   000025                ; Setup parameters for call to function NLME_SetBroadcastFilter
   \   000025   F9           MOV     R1,A
   \   000026   12....       LCALL   ??NLME_SetBroadcastFilter?relay
   2840              }
   2841            }
   2842          }
   \                     ??ZDApp_NodeProfileSync_0:
   \   000029   02....       LJMP    ??Subroutine51_0 & 0xFFFF
   2843          
   2844          /*********************************************************************
   2845           * @fn      ZDApp_StartJoiningCycle()
   2846           *
   2847           * @brief   Starts the joining cycle of a device.  This will only
   2848           *          continue an already started (or stopped) joining cycle.
   2849           *
   2850           * @param   none
   2851           *
   2852           * @return  TRUE if joining stopped, FALSE if joining or rejoining
   2853           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2854          uint8 ZDApp_StartJoiningCycle( void )
   \                     ZDApp_StartJoiningCycle:
   2855          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2856            if ( devState == DEV_INIT || devState == DEV_NWK_DISC )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6401         XRL     A,#0x1
   \   00000A   6005         JZ      ??ZDApp_StartJoiningCycle_0
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6402         XRL     A,#0x2
   \   00000F   7011         JNZ     ??ZDApp_StartJoiningCycle_1
   2857            {
   2858              continueJoining = TRUE;
   \                     ??ZDApp_StartJoiningCycle_0:
   \   000011   90....       MOV     DPTR,#continueJoining
   \   000014   7401         MOV     A,#0x1
   \   000016   F0           MOVX    @DPTR,A
   2859              ZDApp_NetworkInit( 0 );
   \   000017                ; Setup parameters for call to function ZDApp_NetworkInit
   \   000017   7A00         MOV     R2,#0x0
   \   000019   7B00         MOV     R3,#0x0
   \   00001B   12....       LCALL   ??ZDApp_NetworkInit?relay
   2860          
   2861              return ( TRUE );
   \   00001E   7901         MOV     R1,#0x1
   \   000020   8002         SJMP    ??ZDApp_StartJoiningCycle_2
   2862            }
   2863            else
   2864              return ( FALSE );
   \                     ??ZDApp_StartJoiningCycle_1:
   \   000022   7900         MOV     R1,#0x0
   \                     ??ZDApp_StartJoiningCycle_2:
   \   000024   02....       LJMP    ??Subroutine47_0 & 0xFFFF
   2865          }
   2866          
   2867          /*********************************************************************
   2868           * @fn      ZDApp_StopJoiningCycle()
   2869           *
   2870           * @brief   Stops the joining or rejoining process of a device.
   2871           *
   2872           * @param   none
   2873           *
   2874           * @return  TRUE if joining stopped, FALSE if joining or rejoining
   2875           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2876          uint8 ZDApp_StopJoiningCycle( void )
   \                     ZDApp_StopJoiningCycle:
   2877          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2878            if ( devState == DEV_INIT || devState == DEV_NWK_DISC )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6401         XRL     A,#0x1
   \   00000A   6005         JZ      ??ZDApp_StopJoiningCycle_0
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6402         XRL     A,#0x2
   \   00000F   7009         JNZ     ??ZDApp_StopJoiningCycle_1
   2879            {
   2880              continueJoining = FALSE;
   \                     ??ZDApp_StopJoiningCycle_0:
   \   000011   90....       MOV     DPTR,#continueJoining
   \   000014   E4           CLR     A
   \   000015   F0           MOVX    @DPTR,A
   2881              return ( TRUE );
   \   000016   7901         MOV     R1,#0x1
   \   000018   8002         SJMP    ??ZDApp_StopJoiningCycle_2
   2882            }
   2883            else
   2884              return ( FALSE );
   \                     ??ZDApp_StopJoiningCycle_1:
   \   00001A   7900         MOV     R1,#0x0
   \                     ??ZDApp_StopJoiningCycle_2:
   \   00001C   02....       LJMP    ??Subroutine47_0 & 0xFFFF
   2885          }
   2886          
   2887          /*********************************************************************
   2888           * @fn      ZDApp_AnnounceNewAddress()
   2889           *
   2890           * @brief   Send Device Announce and hold all transmissions for
   2891           *          new address timeout.
   2892           *
   2893           * @param   none
   2894           *
   2895           * @return  none
   2896           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2897          void ZDApp_AnnounceNewAddress( void )
   \                     ZDApp_AnnounceNewAddress:
   2898          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2899          #if defined ( ZIGBEE_NWK_UNIQUE_ADDR_CHECK )
   2900            // Turn off data request hold
   2901            APSME_HoldDataRequests( 0 );
   \   000005                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000005   7A00         MOV     R2,#0x0
   \   000007   7B00         MOV     R3,#0x0
   \   000009   12....       LCALL   ??APSME_HoldDataRequests?relay
   2902          #endif
   2903          
   2904            ZDP_DeviceAnnce( NLME_GetShortAddr(), NLME_GetExtAddr(),
   2905                               ZDO_Config_Node_Descriptor.CapabilityFlags, 0 );
   \   00000C                ; Setup parameters for call to function NLME_GetExtAddr
   \   00000C   12....       LCALL   ??NLME_GetExtAddr?relay
   \   00000F   8A..         MOV     ?V0 + 0,R2
   \   000011   8B..         MOV     ?V0 + 1,R3
   \   000013   AE..         MOV     R6,?V0 + 0
   \   000015                ; Setup parameters for call to function NLME_GetShortAddr
   \   000015   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000018                ; Setup parameters for call to function ZDP_DeviceAnnce
   \   000018   75..00       MOV     ?V0 + 0,#0x0
   \   00001B   78..         MOV     R0,#?V0 + 0
   \   00001D   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000020   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F9           MOV     R1,A
   \   000025   EE           MOV     A,R6
   \   000026   FC           MOV     R4,A
   \   000027   AD..         MOV     R5,?V0 + 1
   \   000029   12....       LCALL   ??ZDP_DeviceAnnce?relay
   \   00002C   7401         MOV     A,#0x1
   \   00002E   12....       LCALL   ?DEALLOC_XSTACK8
   2906          
   2907          #if defined ( ZIGBEE_NWK_UNIQUE_ADDR_CHECK )
   2908            // Setup the timeout
   2909            APSME_HoldDataRequests( ZDAPP_HOLD_DATA_REQUESTS_TIMEOUT );
   \   000031                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000031   7A00         MOV     R2,#0x0
   \   000033   7B00         MOV     R3,#0x0
   \   000035   12....       LCALL   ??APSME_HoldDataRequests?relay
   2910          #endif
   2911          }
   \   000038   02....       LJMP    ??Subroutine50_0 & 0xFFFF
   2912          
   2913          /*********************************************************************
   2914           * @fn          ZDApp_NVUpdate
   2915           *
   2916           * @brief       Set the NV Update Timer.
   2917           *
   2918           * @param       none
   2919           *
   2920           * @return      none
   2921           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2922          void ZDApp_NVUpdate( void )
   \                     ZDApp_NVUpdate:
   2923          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2924          #if defined ( NV_RESTORE )
   2925            osal_start_timerEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV, ZDAPP_UPDATE_NWK_NV_TIME );
   \   000004                ; Setup parameters for call to function osal_start_timerEx
   \   000004   7CBC         MOV     R4,#-0x44
   \   000006   7D02         MOV     R5,#0x2
   \   000008   7A00         MOV     R2,#0x0
   \   00000A   7B02         MOV     R3,#0x2
   \   00000C   02....       LJMP    ?Subroutine2 & 0xFFFF
   2926          #endif
   2927          }
   2928          
   2929          /*********************************************************************
   2930           * @fn      ZDApp_CoordStartPANIDConflictCB()
   2931           *
   2932           * @brief   Returns a PAN ID for the network layer to use during
   2933           *          a coordinator start and there is another network with
   2934           *          the intended PANID.
   2935           *
   2936           * @param   panid - the intended PAN ID
   2937           *
   2938           * @return  PANID to try
   2939           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2940          uint16 ZDApp_CoordStartPANIDConflictCB( uint16 panid )
   \                     ZDApp_CoordStartPANIDConflictCB:
   2941          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2942            return ( panid + 1 );
   \   000000   EA           MOV     A,R2
   \   000001   2401         ADD     A,#0x1
   \   000003   0A           INC     R2
   \   000004   EB           MOV     A,R3
   \   000005   3400         ADDC    A,#0x0
   \   000007   FB           MOV     R3,A
   \   000008   02....       LJMP    ?BRET
   2943          }
   2944          
   2945          /*********************************************************************
   2946           * @fn          ZDO_SrcRtgIndCB
   2947           *
   2948           * @brief       This function notifies the ZDO available src route record received.
   2949           *
   2950           * @param       srcAddr - source address of the source route
   2951           * @param       relayCnt - number of devices in the relay list
   2952           * @param       relayList - relay list of the source route
   2953           *
   2954           * @return      none
   2955           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2956          void ZDO_SrcRtgIndCB (uint16 srcAddr, uint8 relayCnt, uint16* pRelayList )
   \                     ZDO_SrcRtgIndCB:
   2957          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   2958            zdoSrcRtg_t srcRtg;
   2959          
   2960            srcRtg.srcAddr = srcAddr;
   \   00000A   12....       LCALL   ?Subroutine10 & 0xFFFF
   2961            srcRtg.relayCnt = relayCnt;
   \                     ??CrossCallReturnLabel_91:
   \   00000D   7402         MOV     A,#0x2
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   E9           MOV     A,R1
   \   000013   F0           MOVX    @DPTR,A
   2962            srcRtg.pRelayList = pRelayList;
   \   000014   7403         MOV     A,#0x3
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   EC           MOV     A,R4
   \   00001A   F0           MOVX    @DPTR,A
   \   00001B   A3           INC     DPTR
   \   00001C   ED           MOV     A,R5
   \   00001D   F0           MOVX    @DPTR,A
   2963          
   2964            if( zdoCBFunc[ZDO_SRC_RTG_IND_CBID] != NULL )
   \   00001E   90....       MOV     DPTR,#zdoCBFunc
   \   000021   12....       LCALL   ?Subroutine14 & 0xFFFF
   \                     ??CrossCallReturnLabel_14:
   \   000024   6013         JZ      ??ZDO_SrcRtgIndCB_0
   2965            {
   2966              zdoCBFunc[ZDO_SRC_RTG_IND_CBID]( (void*)&srcRtg );
   \   000026                ; Setup parameters for indirect call
   \   000026   85..82       MOV     DPL,?XSP + 0
   \   000029   85..83       MOV     DPH,?XSP + 1
   \   00002C   AA82         MOV     R2,DPL
   \   00002E   AB83         MOV     R3,DPH
   \   000030   90....       MOV     DPTR,#zdoCBFunc + 1
   \   000033   12....       LCALL   ??Subroutine48_0 & 0xFFFF
   2967            }
   \                     ??CrossCallReturnLabel_73:
   \   000036   12....       LCALL   ?CALL_IND
   2968          }
   \                     ??ZDO_SrcRtgIndCB_0:
   \   000039                REQUIRE ?Subroutine5
   \   000039                ; // Fall through to label ?Subroutine5
   2969          
   2970          /*********************************************************************
   2971           * @fn          ZDApp_InitZdoCBFunc
   2972           *
   2973           * @brief       Call this function to initialize zdoCBFunc[]
   2974           *
   2975           * @param       none
   2976           *
   2977           * @return      none
   2978           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2979          void ZDApp_InitZdoCBFunc( void )
   \                     ZDApp_InitZdoCBFunc:
   2980          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2981            uint8 i;
   2982          
   2983            for ( i=0; i< MAX_ZDO_CB_FUNC; i++ )
   \   000004   78..         MOV     R0,#zdoCBFunc & 0xff
   \   000006   79..         MOV     R1,#(zdoCBFunc >> 8) & 0xff
   2984            {
   2985              zdoCBFunc[i] = NULL;
   \                     ??ZDApp_InitZdoCBFunc_0:
   \   000008   8882         MOV     DPL,R0
   \   00000A   8983         MOV     DPH,R1
   \   00000C   E4           CLR     A
   \   00000D   F0           MOVX    @DPTR,A
   \   00000E   A3           INC     DPTR
   \   00000F   F0           MOVX    @DPTR,A
   2986            }
   \   000010   E8           MOV     A,R0
   \   000011   2402         ADD     A,#0x2
   \   000013   08           INC     R0
   \   000014   08           INC     R0
   \   000015   E9           MOV     A,R1
   \   000016   3400         ADDC    A,#0x0
   \   000018   F9           MOV     R1,A
   \   000019   E8           MOV     A,R0
   \   00001A   B4..03       CJNE    A,#(zdoCBFunc + 14) & 0xff,??ZDApp_InitZdoCBFunc_1
   \   00001D   E9           MOV     A,R1
   \   00001E   64..         XRL     A,#((zdoCBFunc + 14) >> 8) & 0xff
   \                     ??ZDApp_InitZdoCBFunc_1:
   \   000020   70E6         JNZ     ??ZDApp_InitZdoCBFunc_0
   2987          }
   \   000022   02....       LJMP    ??Subroutine47_0 & 0xFFFF
   2988          
   2989          /*********************************************************************
   2990           * @fn          ZDO_RegisterForZdoCB
   2991           *
   2992           * @brief       Call this function to register the higher layer (for
   2993           *              example, the Application layer or MT layer) with ZDO
   2994           *              callbacks to get notified of some ZDO indication like
   2995           *              existence of a concentrator or receipt of a source
   2996           *              route record.
   2997           *
   2998           * @param       indID - ZDO Indication ID
   2999           * @param       pFn   - Callback function pointer
   3000           *
   3001           * @return      ZSuccess - successful, ZInvalidParameter if not
   3002           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   3003          ZStatus_t ZDO_RegisterForZdoCB( uint8 indID, pfnZdoCb pFn )
   \                     ZDO_RegisterForZdoCB:
   3004          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FC           MOV     R4,A
   3005            // Check the range of the indication ID
   3006            if ( indID < MAX_ZDO_CB_FUNC )
   \   000006   C3           CLR     C
   \   000007   9407         SUBB    A,#0x7
   \   000009   500B         JNC     ??ZDO_RegisterForZdoCB_0
   3007            {
   3008              zdoCBFunc[indID] = pFn;
   \   00000B   EC           MOV     A,R4
   \   00000C   12....       LCALL   ?Subroutine34 & 0xFFFF
   \                     ??CrossCallReturnLabel_43:
   \   00000F   12....       LCALL   ??Subroutine53_0 & 0xFFFF
   3009              return ZSuccess;
   \                     ??CrossCallReturnLabel_88:
   \   000012   7900         MOV     R1,#0x0
   \   000014   8002         SJMP    ??ZDO_RegisterForZdoCB_1
   3010            }
   3011          
   3012            return ZInvalidParameter;
   \                     ??ZDO_RegisterForZdoCB_0:
   \   000016   7902         MOV     R1,#0x2
   \                     ??ZDO_RegisterForZdoCB_1:
   \   000018   02....       LJMP    ??Subroutine47_0 & 0xFFFF
   3013          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine34:
   \   000000   C3           CLR     C
   \   000001   33           RLC     A
   \   000002   F8           MOV     R0,A
   \   000003   E4           CLR     A
   \   000004   33           RLC     A
   \   000005   F9           MOV     R1,A
   \   000006   74..         MOV     A,#zdoCBFunc & 0xff
   \   000008   28           ADD     A,R0
   \   000009   F582         MOV     DPL,A
   \   00000B   74..         MOV     A,#(zdoCBFunc >> 8) & 0xff
   \   00000D   39           ADDC    A,R1
   \   00000E   F583         MOV     DPH,A
   \   000010   22           RET
   3014          
   3015          /*********************************************************************
   3016           * @fn          ZDO_DeregisterForZdoCB
   3017           *
   3018           * @brief       Call this function to de-register the higher layer (for
   3019           *              example, the Application layer or MT layer) with ZDO
   3020           *              callbacks to get notified of some ZDO indication like
   3021           *              existence of a concentrator or receipt of a source
   3022           *              route record.
   3023           *
   3024           * @param       indID - ZDO Indication ID
   3025           *
   3026           * @return      ZSuccess - successful, ZInvalidParameter if not
   3027           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   3028          ZStatus_t ZDO_DeregisterForZdoCB( uint8 indID )
   \                     ZDO_DeregisterForZdoCB:
   3029          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FA           MOV     R2,A
   3030            // Check the range of the indication ID
   3031            if ( indID < MAX_ZDO_CB_FUNC )
   \   000006   C3           CLR     C
   \   000007   9407         SUBB    A,#0x7
   \   000009   500B         JNC     ??ZDO_DeregisterForZdoCB_0
   3032            {
   3033              zdoCBFunc[indID] = NULL;
   \   00000B   EA           MOV     A,R2
   \   00000C   12....       LCALL   ?Subroutine34 & 0xFFFF
   \                     ??CrossCallReturnLabel_44:
   \   00000F   E4           CLR     A
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   F0           MOVX    @DPTR,A
   3034              return ZSuccess;
   \   000013   F9           MOV     R1,A
   \   000014   8002         SJMP    ??ZDO_DeregisterForZdoCB_1
   3035            }
   3036          
   3037            return ZInvalidParameter;
   \                     ??ZDO_DeregisterForZdoCB_0:
   \   000016   7902         MOV     R1,#0x2
   \                     ??ZDO_DeregisterForZdoCB_1:
   \   000018   02....       LJMP    ??Subroutine47_0 & 0xFFFF
   3038          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine17:
   \   000000   7A04         MOV     R2,#0x4
   \   000002                REQUIRE ??Subroutine59_0
   \   000002                ; // Fall through to label ??Subroutine59_0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zdoDiscCounter>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for continueJoining>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for devState>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZDApp_epDesc>`:
   \   000000   00           DB 0
   \   000001   ....         DW ZDAppTaskID
   \   000003   0000         DW 0H
   \   000005   00           DB 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_0:
   \   000000   00000000     DD 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_1:
   \   000000   01000000     DD 1

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SecInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SecInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_event_loop?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_event_loop

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessSecEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessSecEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDOInitDevice?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDOInitDevice

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ReadNetworkRestoreState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ReadNetworkRestoreState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDAppDetermineDeviceType?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDAppDetermineDeviceType

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkStartEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkStartEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_DeviceAuthEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_DeviceAuthEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SaveNetworkStateEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SaveNetworkStateEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RestoreNetworkState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RestoreNetworkState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InitUserDesc?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InitUserDesc

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDAppCheckForHoldKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDAppCheckForHoldKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessOSALMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessOSALMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessMsgCBs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessMsgCBs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RegisterCBs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RegisterCBs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessSecMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessSecMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessNetworkJoin?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessNetworkJoin

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SaveNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SaveNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RestoreNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RestoreNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetTimerStart?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetTimerStart

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetTimerCancel?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetTimerCancel

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlSet?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlSet

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlBypass?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlBypass

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlStartup?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlStartup

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveUpdate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveUpdate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkDiscoveryReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkDiscoveryReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_JoinReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_JoinReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_DeviceConfigured?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_DeviceConfigured

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SendEventMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SendEventMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SendMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SendMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_NetworkDiscoveryConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_NetworkDiscoveryConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NwkDescListProcessing?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NwkDescListProcessing

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_NetworkFormationConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_NetworkFormationConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_beaconNotifyIndCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_beaconNotifyIndCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_StartRouterConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_StartRouterConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_JoinConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_JoinConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_AddrChangeIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_AddrChangeIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_JoinIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_JoinIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ConcentratorIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ConcentratorIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_LeaveCnf?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_LeaveCnf

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_LeaveInd?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_LeaveInd

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SyncIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SyncIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ManytoOneFailureIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ManytoOneFailureIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_PollConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_PollConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??AddrMgrWriteNVRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    AddrMgrWriteNVRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_UpdateDeviceIndication?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_UpdateDeviceIndication

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InMsgCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InMsgCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ChangeMatchDescRespPermission?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ChangeMatchDescRespPermission

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NwkStateUpdateCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NwkStateUpdateCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NodeProfileSync?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NodeProfileSync

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_StartJoiningCycle?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_StartJoiningCycle

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_StopJoiningCycle?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_StopJoiningCycle

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_AnnounceNewAddress?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_AnnounceNewAddress

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NVUpdate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NVUpdate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_CoordStartPANIDConflictCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_CoordStartPANIDConflictCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SrcRtgIndCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SrcRtgIndCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InitZdoCBFunc?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InitZdoCBFunc

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_RegisterForZdoCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_RegisterForZdoCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_DeregisterForZdoCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_DeregisterForZdoCB
   3039          
   3040          /*********************************************************************
   3041          *********************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     AddrMgrWriteNVRequest              0      0     34
       -> osal_get_timeoutEx            0      0     20
       -> ZDApp_NVUpdate                0      0     20
     ZDAppCheckForHoldKey               0      0      0
     ZDAppDetermineDeviceType           2      0     14
       -> nwk_ExtPANIDValid             4      0      0
     ZDApp_AnnounceNewAddress           0      0     25
       -> APSME_HoldDataRequests        0      0     20
       -> NLME_GetExtAddr               0      0     20
       -> NLME_GetShortAddr             0      0     20
       -> ZDP_DeviceAnnce               0      0     22
       -> APSME_HoldDataRequests        0      0     20
     ZDApp_ChangeMatchDescRespPermission
                                        0      0      9
       -> afSetMatch                    0      0     18
     ZDApp_CoordStartPANIDConflictCB
                                        0      0      0
     ZDApp_DeviceAuthEvt                2      0      9
       -> ZDApp_ResetTimerCancel        4      0      0
       -> osal_set_event                4      0      0
       -> ZDApp_NVUpdate                4      0      0
       -> ZDApp_SaveNwkKey              4      0      0
       -> ZDApp_AnnounceNewAddress      4      0      0
       -> NLME_SetPollRate              4      0      0
       -> ZDApp_NVUpdate                4      0      0
     ZDApp_DeviceConfigured             0      0     16
       -> osal_nv_read                  0      0     32
     ZDApp_InMsgCB                      0      0     14
       -> ZDP_GenericRsp                0      0     28
     ZDApp_Init                         0      0      9
       -> NLME_GetExtAddr               0      0     18
       -> ZDO_Init                      0      0     18
       -> afRegister                    0      0     18
       -> ZDOInitDevice                 0      0     18
       -> ZDOInitDevice                 0      0     18
       -> HalLedBlink                   0      0     18
       -> ZDApp_InitZdoCBFunc           0      0     18
       -> ZDApp_RegisterCBs             0      0     18
     ZDApp_InitUserDesc                 0      0     31
       -> osal_memset                   0      0     54
       -> osal_nv_item_init             0      0     58
       -> osal_nv_read                  0      0     62
     ZDApp_InitZdoCBFunc                2      0      9
     ZDApp_JoinReq                      0      0     22
       -> ZDApp_NodeProfileSync         0      0     28
       -> NLME_JoinRequest              0      0     36
     ZDApp_LeaveCtrlBypass              2      0      0
     ZDApp_LeaveCtrlInit                0      0     28
       -> osal_nv_item_init             0      0     24
       -> osal_nv_read                  0      0     28
     ZDApp_LeaveCtrlReset               0      0     14
       -> osal_nv_write                 0      0     28
     ZDApp_LeaveCtrlSet                 0      0     23
       -> osal_nv_write                 0      0     28
     ZDApp_LeaveCtrlStartup             2      0     14
       -> ZDApp_LeaveCtrlReset          4      0      0
     ZDApp_LeaveReset                   0      0     19
       -> ZDApp_LeaveCtrlSet            0      0     18
       -> osal_start_timerEx            0      0     18
     ZDApp_LeaveUpdate                  0      0     37
       -> ZDSecMgrDeviceRemoveByExtAddr
                                        0      0     48
       -> ZDSecMgrAddrClear             0      0     48
       -> osal_memcpy                   0      0     54
       -> RTG_RemoveRtgEntry            0      0     48
       -> nwkNeighborRemove             0      0     48
       -> AddrMgrWriteNVRequest         0      0     48
     ZDApp_NVUpdate                     2      0     14
       -> osal_start_timerEx            4      0      0
     ZDApp_NetworkDiscoveryReq          0      0     12
       -> NLME_NetworkDiscoveryRequest
                                        0      0     24
     ZDApp_NetworkInit                  2      0     14
       -> osal_start_timerEx            4      0      0
       -> osal_set_event                4      0      0
     ZDApp_NetworkStartEvt              2      0      0
       -> osal_pwrmgr_device            4      0      0
       -> osal_set_event                4      0      0
       -> NLME_GetEnergyThreshold       4      0      0
       -> NLME_GetEnergyThreshold       4      0      0
       -> NLME_SetEnergyThreshold       4      0      0
       -> osal_set_event                4      0      0
       -> osal_set_event                4      0      0
     ZDApp_NodeProfileSync              0      0     23
       -> NLME_SetBroadcastFilter       0      0     18
     ZDApp_NwkDescListProcessing        0      0     25
       -> nwk_getNwkDescList            0      0     28
       -> nwk_getNwkDescList            0      0     28
       -> nwk_ExtPANIDValid             0      0     28
       -> sAddrExtCmp                   0      0     28
     ZDApp_NwkStateUpdateCB             0      0     10
       -> osal_get_timeoutEx            0      0     20
       -> ZDApp_NVUpdate                0      0     20
     ZDApp_ProcessMsgCBs                0      0     42
       -> ZDO_ParseAddrRsp              0      0     62
       -> ZDO_UpdateAddrManager         0      0     62
       -> osal_mem_free                 0      0     62
       -> ZDO_ParseBindUnbindReq        0      0     62
       -> ZDO_ProcessBindUnbindReq      0      0     62
     ZDApp_ProcessNetworkJoin           0      0     23
       -> osal_set_event                0      0     24
       -> ZDApp_RestoreNwkKey           0      0     24
       -> osal_start_timerEx            0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> NLME_GetShortAddr             0      0     24
       -> ZMacSetReq                    0      0     24
       -> nwkNeighborInitTable          0      0     24
       -> NLME_NwkDiscTerm              0      0     24
       -> osal_rand                     0      0     24
       -> ZDApp_NetworkInit             0      0     24
       -> ZDApp_RestoreNwkKey           0      0     24
       -> osal_set_event                0      0     24
       -> NLME_SetPollRate              0      0     24
       -> NLME_SetQueuedPollRate        0      0     24
       -> NLME_SetResponseRate          0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> nwkNeighborInitTable          0      0     24
       -> NLME_NwkDiscTerm              0      0     24
       -> osal_rand                     0      0     24
       -> ZDApp_NetworkInit             0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> osal_set_event                0      0     24
     ZDApp_ProcessOSALMsg               0      0     26
       -> ZDP_IncomingData              0      0     22
       -> ZDApp_ProcessMsgCBs           0      0     22
       -> ZDApp_NwkDescListProcessing
                                        0      0     22
       -> ZDApp_NodeProfileSync         0      0     22
       -> NLME_JoinRequest              0      0     30
       -> osal_rand                     0      0     22
       -> ZDApp_NetworkInit             0      0     22
       -> osal_rand                     0      0     22
       -> ZMacSetReq                    0      0     22
       -> ZDApp_RestoreNwkKey           0      0     22
       -> ZMacSetReq                    0      0     22
       -> ZMacSetReq                    0      0     22
       -> NLME_ReJoinRequest            0      0     22
       -> osal_rand                     0      0     22
       -> ZDApp_NetworkInit             0      0     22
       -> NLME_SetPollRate              0      0     22
       -> NLME_SetQueuedPollRate        0      0     22
       -> NLME_SetResponseRate          0      0     22
       -> NLME_SetPollRate              0      0     22
       -> osal_rand                     0      0     22
       -> ZDApp_NetworkInit             0      0     22
       -> ZDApp_ProcessNetworkJoin      0      0     22
       -> sAddrExtCpy                   0      0     22
       -> ZDApp_NetworkInit             0      0     22
       -> ZDApp_ProcessSecMsg           0      0     22
     ZDApp_ProcessSecEvent              0      0     20
       -> ZDApp_DeviceAuthEvt           0      0     18
       -> ZDApp_SaveNwkKey              0      0     18
       -> ZDSecMgrSaveApsLinkKey        0      0     18
       -> ZDSecMgrSaveTCLinkKey         0      0     18
     ZDApp_ProcessSecMsg                2      0     11
       -> ZDSecMgrTransportKeyInd       4      0      0
       -> ZDSecMgrSwitchKeyInd          4      0      0
     ZDApp_ReadNetworkRestoreState      0      0     23
       -> zgReadStartupOptions          0      0     18
     ZDApp_RegisterCBs                  2      0      9
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
     ZDApp_ResetNwkKey                  0      0     35
       -> osal_memset                   0      0     62
       -> osal_nv_write                 0      0     70
     ZDApp_ResetTimerCancel             2      0      0
       -> osal_stop_timerEx             4      0      0
     ZDApp_ResetTimerStart              2      0      0
       -> osal_start_timerEx            4      0      0
     ZDApp_RestoreNetworkState          0      0     23
       -> NLME_InitNV                   0      0     18
       -> NLME_RestoreFromNV            0      0     18
       -> NLME_GetShortAddr             0      0     18
       -> sAddrExtCpy                   0      0     18
     ZDApp_RestoreNwkKey                0      0     49
       -> osal_nv_read                  0      0     74
       -> osal_memset                   0      0     66
     ZDApp_SaveNetworkStateEvt          2      0     11
       -> NLME_UpdateNV                 4      0      0
       -> zgWriteStartupOptions         4      0      0
     ZDApp_SaveNwkKey                   0      0     46
       -> SSP_ReadNwkActiveKey          0      0     66
       -> osal_nv_write                 0      0     74
       -> osal_memset                   0      0     66
     ZDApp_SecInit                      0      0     39
       -> ZDSecMgrInit                  0      0     50
       -> ZDSecMgrReadKeyFromNv         0      0     50
       -> SSP_UpdateNwkKey              0      0     50
       -> SSP_SwitchNwkKey              0      0     50
       -> osal_memset                   0      0     50
     ZDApp_SendEventMsg                 0      0      9
       -> ZDApp_SendMsg                 0      0     18
     ZDApp_SendMsg                      1      0     36
       -> osal_msg_allocate             0      0     38
       -> osal_memcpy                   0      0     44
       -> osal_msg_send                 0      0     38
     ZDApp_StartJoiningCycle            2      0      0
       -> ZDApp_NetworkInit             4      0      0
     ZDApp_StopJoiningCycle             2      0      0
     ZDApp_event_loop                   0      0     11
       -> osal_set_event                0      0     22
       -> ZDO_StartDevice               0      0     22
       -> ZDApp_ProcessOSALMsg          0      0     22
       -> osal_msg_deallocate           0      0     22
       -> osal_msg_receive              0      0     22
       -> ZDO_UpdateNwkStatus           0      0     22
       -> osal_start_timerEx            0      0     22
       -> ZDApp_SaveNetworkStateEvt     0      0     22
       -> zgWriteStartupOptions         0      0     22
       -> Onboard_soft_reset            0      0     22
       -> ZDApp_ProcessSecEvent         0      0     22
     ZDOInitDevice                      0      0     23
       -> zgInitItems                   0      0     28
       -> ZDConfig_InitDescriptors      0      0     28
       -> HalKeyRead                    0      0     28
       -> NLME_InitNV                   0      0     28
       -> NLME_SetDefaultNV             0      0     28
       -> ZDSecMgrClearNVKeyValues      0      0     28
       -> ZDAppDetermineDeviceType      0      0     28
       -> osal_rand                     0      0     28
       -> ZDApp_SecInit                 0      0     28
       -> ZDApp_LeaveCtrlInit           0      0     28
       -> ZDApp_LeaveCtrlStartup        0      0     28
       -> zgWriteStartupOptions         0      0     28
       -> osal_set_event                0      0     28
       -> ZDApp_ReadNetworkRestoreState
                                        0      0     28
       -> ZDApp_RestoreNetworkState     0      0     28
       -> ZDApp_NetworkInit             0      0     28
       -> NLME_SetBroadcastFilter       0      0     28
     ZDO_AddrChangeIndicationCB         0      0     14
       -> ZDApp_NVUpdate                0      0     28
       -> osal_set_event                0      0     28
       -> osal_msg_allocate             0      0     28
       -> osal_msg_send                 0      0     28
       -> ZDApp_AnnounceNewAddress      0      0     28
     ZDO_ConcentratorIndicationCB       1      0     14
     ZDO_DeregisterForZdoCB             2      0      0
     ZDO_JoinConfirmCB                  1      0     14
       -> HalLedSet                     0      0     28
       -> HalLedSet                     0      0     28
       -> ZDApp_SendMsg                 0      0     28
     ZDO_JoinIndicationCB               0      0     10
       -> ZDApp_NVUpdate                0      0     18
       -> osal_start_timerEx            0      0     18
     ZDO_LeaveCnf                       0      0     10
       -> NLME_GetExtAddr               0      0     20
       -> sAddrExtCmp                   0      0     20
       -> ZDApp_LeaveReset              0      0     20
     ZDO_LeaveInd                       0      0     10
       -> ZDApp_LeaveReset              0      0     20
       -> NLME_GetCoordShortAddr        0      0     20
       -> ZDApp_LeaveUpdate             0      0     20
     ZDO_ManytoOneFailureIndicationCB
                                        2      0      0
       -> RTG_MTORouteReq               4      0      0
     ZDO_NetworkDiscoveryConfirmCB      3      0      3
       -> ZDApp_SendMsg                 4      0      6
     ZDO_NetworkFormationConfirmCB      0      0      9
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> osal_set_event                0      0     18
     ZDO_PollConfirmCB                  0      0      0
     ZDO_RegisterForZdoCB               2      0      0
     ZDO_SrcRtgIndCB                    1      0     14
     ZDO_StartRouterConfirmCB           0      0      9
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> osal_set_event                0      0     18
     ZDO_SyncIndicationCB               0      0      9
       -> nwkNeighborInitTable          0      0     18
       -> ZDApp_SendMsg                 0      0     18
     ZDO_UpdateDeviceIndication         0      0      0
     ZDO_beaconNotifyIndCB              1      0     14
       -> osal_mem_alloc                0      0     28
       -> osal_memset                   0      0     28
       -> sAddrExtCpy                   0      0     28
       -> osal_memset                   0      0     28


   Segment part sizes:

     Function/Label                              Bytes
     --------------                              -----
     zdoDiscCounter                                 1
     ZDAppNwkAddr                                   9
     zdappMgmtNwkDiscRspTransSeq                    1
     zdappMgmtNwkDiscReqInProgress                  1
     zdappMgmtNwkDiscRspAddr                        9
     zdappMgmtNwkDiscStartIndex                     1
     zdappMgmtSavedNwkState                         1
     nwkFrameCounterChanges                         2
     continueJoining                                1
     _tmpRejoinState                                1
     ZDO_UseExtendedPANID                           8
     zdoCBFunc                                     14
     ZDAppTaskID                                    1
     nwkStatus                                      1
     ZDApp_AutoFindMode_epDesc                      2
     ZDApp_LeaveCtrl                                1
     devState                                       1
     devStartMode                                   1
     retryCnt                                       1
     ZDApp_epDesc                                   6
     ZDApp_SavedPollRate                            2
     ZDApp_Init                                    82
     ??Subroutine51_0                               5
     ZDApp_SecInit                                111
     ??Subroutine62_0                               6
     ZDApp_event_loop                             184
     ??Subroutine45_0                              14
     ??Subroutine61_0                               6
     ZDApp_ProcessSecEvent                        106
     ??Subroutine53_0                               6
     ??Subroutine58_0                               4
     ?Subroutine39                                  6
     ZDOInitDevice                                200
     ?Subroutine16                                  2
     ??Subroutine42_0                              11
     ??Subroutine43_0                               3
     ??Subroutine44_0                               5
     ?Subroutine10                                  6
     ZDApp_ReadNetworkRestoreState                 21
     ZDAppDetermineDeviceType                      74
     ??Subroutine47_0                               7
     ZDApp_NetworkStartEvt                         79
     ZDApp_DeviceAuthEvt                           49
     ?Subroutine8                                   5
     ?Subroutine24                                  9
     ZDApp_SaveNetworkStateEvt                     19
     ZDApp_RestoreNetworkState                     76
     ?Subroutine9                                  13
     ?Subroutine14                                  6
     ZDApp_InitUserDesc                            89
     ?Subroutine30                                 32
     ?Subroutine36                                  8
     ??Subroutine49_0                               3
     ??Subroutine50_0                               5
     ZDAppCheckForHoldKey                           3
     ZDApp_ProcessOSALMsg                         468
     ?Subroutine35                                 22
     ?Subroutine31                                 15
     ?Subroutine26                                  4
     ??Subroutine52_0                               6
     ?Subroutine11                                 12
     ?Subroutine28                                  4
     ZDApp_ProcessMsgCBs                          125
     ?Subroutine6                                   5
     ?Subroutine25                                  6
     ??Subroutine55_0                               5
     ??Subroutine56_0                               3
     ??Subroutine57_0                               5
     ZDApp_RegisterCBs                             31
     ?Subroutine21                                  2
     ??Subroutine46_0                               9
     ZDApp_ProcessSecMsg                           56
     ZDApp_ProcessNetworkJoin                     343
     ?Subroutine7                                   5
     ?Subroutine27                                 10
     ?Subroutine12                                 11
     ?Subroutine1                                   2
     ZDApp_SaveNwkKey                             112
     ZDApp_ResetNwkKey                             48
     ZDApp_RestoreNwkKey                          141
     ZDApp_ResetTimerStart                         15
     ?Subroutine2                                   3
     ??Subroutine60_0                               3
     ZDApp_ResetTimerCancel                        19
     ZDApp_LeaveCtrlInit                           71
     ZDApp_LeaveCtrlSet                            22
     ?Subroutine3                                  35
     ZDApp_LeaveCtrlReset                          13
     ZDApp_LeaveCtrlBypass                         15
     ZDApp_LeaveCtrlStartup                        47
     ZDApp_LeaveReset                              18
     ZDApp_LeaveUpdate                            135
     ?Subroutine20                                  3
     ??Subroutine48_0                               6
     ZDApp_NetworkDiscoveryReq                     11
     ZDApp_JoinReq                                 87
     ?Subroutine4                                   5
     ZDApp_DeviceConfigured                        80
     ZDApp_SendEventMsg                            16
     ?Subroutine22                                  9
     ZDApp_SendMsg                                 99
     ZDO_NetworkDiscoveryConfirmCB                 76
     ZDApp_NwkDescListProcessing                  250
     ?Subroutine19                                  6
     ??Subroutine54_0                               6
     ?Subroutine41                                  3
     ?Subroutine0                                   3
     ZDO_NetworkFormationConfirmCB                 25
     ?Subroutine38                                 19
     ZDO_beaconNotifyIndCB                        544
     ?Subroutine37                                  9
     ?Subroutine29                                  4
     ?Subroutine40                                  9
     ?Subroutine18                                 10
     ?Subroutine13                                 12
     ?Subroutine15                                 12
     ZDO_StartRouterConfirmCB                      25
     ZDO_JoinConfirmCB                            101
     ?Subroutine5                                   2
     ZDO_AddrChangeIndicationCB                   109
     ZDO_JoinIndicationCB                          37
     ??Subroutine59_0                               2
     ZDO_ConcentratorIndicationCB                  58
     ZDO_LeaveCnf                                  63
     ?Subroutine32                                  9
     ZDO_LeaveInd                                 108
     ?Subroutine33                                  3
     ZDO_SyncIndicationCB                          29
     ZDO_ManytoOneFailureIndicationCB
                                                   10
     ZDO_PollConfirmCB                              3
     AddrMgrWriteNVRequest                         16
     ?Subroutine23                                 18
     ZDO_UpdateDeviceIndication                     5
     ZDApp_InMsgCB                                 94
     ZDApp_ChangeMatchDescRespPermission
                                                   11
     ZDApp_NetworkInit                             27
     ZDApp_NwkStateUpdateCB                        16
     ZDApp_NodeProfileSync                         44
     ZDApp_StartJoiningCycle                       39
     ZDApp_StopJoiningCycle                        31
     ZDApp_AnnounceNewAddress                      59
     ZDApp_NVUpdate                                15
     ZDApp_CoordStartPANIDConflictCB
                                                   11
     ZDO_SrcRtgIndCB                               57
     ZDApp_InitZdoCBFunc                           37
     ZDO_RegisterForZdoCB                          27
     ?Subroutine34                                 17
     ZDO_DeregisterForZdoCB                        27
     ?Subroutine17                                  2
     ?<Initializer for zdoDiscCounter>              1
     ?<Initializer for continueJoining>             1
     ?<Initializer for devState>                    1
     ?<Initializer for ZDApp_epDesc>                6
     __Constant_0                                   4
     __Constant_1                                   4
     __Constant_3e8                                 4
     ??ZDApp_Init?relay                             6
     ??ZDApp_SecInit?relay                          6
     ??ZDApp_event_loop?relay                       6
     ??ZDApp_ProcessSecEvent?relay                  6
     ??ZDOInitDevice?relay                          6
     ??ZDApp_ReadNetworkRestoreState?relay          6
     ??ZDAppDetermineDeviceType?relay               6
     ??ZDApp_NetworkStartEvt?relay                  6
     ??ZDApp_DeviceAuthEvt?relay                    6
     ??ZDApp_SaveNetworkStateEvt?relay              6
     ??ZDApp_RestoreNetworkState?relay              6
     ??ZDApp_InitUserDesc?relay                     6
     ??ZDAppCheckForHoldKey?relay                   6
     ??ZDApp_ProcessOSALMsg?relay                   6
     ??ZDApp_ProcessMsgCBs?relay                    6
     ??ZDApp_RegisterCBs?relay                      6
     ??ZDApp_ProcessSecMsg?relay                    6
     ??ZDApp_ProcessNetworkJoin?relay               6
     ??ZDApp_SaveNwkKey?relay                       6
     ??ZDApp_ResetNwkKey?relay                      6
     ??ZDApp_RestoreNwkKey?relay                    6
     ??ZDApp_ResetTimerStart?relay                  6
     ??ZDApp_ResetTimerCancel?relay                 6
     ??ZDApp_LeaveCtrlInit?relay                    6
     ??ZDApp_LeaveCtrlSet?relay                     6
     ??ZDApp_LeaveCtrlReset?relay                   6
     ??ZDApp_LeaveCtrlBypass?relay                  6
     ??ZDApp_LeaveCtrlStartup?relay                 6
     ??ZDApp_LeaveReset?relay                       6
     ??ZDApp_LeaveUpdate?relay                      6
     ??ZDApp_NetworkDiscoveryReq?relay              6
     ??ZDApp_JoinReq?relay                          6
     ??ZDApp_DeviceConfigured?relay                 6
     ??ZDApp_SendEventMsg?relay                     6
     ??ZDApp_SendMsg?relay                          6
     ??ZDO_NetworkDiscoveryConfirmCB?relay          6
     ??ZDApp_NwkDescListProcessing?relay            6
     ??ZDO_NetworkFormationConfirmCB?relay          6
     ??ZDO_beaconNotifyIndCB?relay                  6
     ??ZDO_StartRouterConfirmCB?relay               6
     ??ZDO_JoinConfirmCB?relay                      6
     ??ZDO_AddrChangeIndicationCB?relay             6
     ??ZDO_JoinIndicationCB?relay                   6
     ??ZDO_ConcentratorIndicationCB?relay           6
     ??ZDO_LeaveCnf?relay                           6
     ??ZDO_LeaveInd?relay                           6
     ??ZDO_SyncIndicationCB?relay                   6
     ??ZDO_ManytoOneFailureIndicationCB?relay       6
     ??ZDO_PollConfirmCB?relay                      6
     ??AddrMgrWriteNVRequest?relay                  6
     ??ZDO_UpdateDeviceIndication?relay             6
     ??ZDApp_InMsgCB?relay                          6
     ??ZDApp_ChangeMatchDescRespPermission?relay    6
     ??ZDApp_NetworkInit?relay                      6
     ??ZDApp_NwkStateUpdateCB?relay                 6
     ??ZDApp_NodeProfileSync?relay                  6
     ??ZDApp_StartJoiningCycle?relay                6
     ??ZDApp_StopJoiningCycle?relay                 6
     ??ZDApp_AnnounceNewAddress?relay               6
     ??ZDApp_NVUpdate?relay                         6
     ??ZDApp_CoordStartPANIDConflictCB?relay        6
     ??ZDO_SrcRtgIndCB?relay                        6
     ??ZDApp_InitZdoCBFunc?relay                    6
     ??ZDO_RegisterForZdoCB?relay                   6
     ??ZDO_DeregisterForZdoCB?relay                 6

 
 5 517 bytes in segment BANKED_CODE
   390 bytes in segment BANK_RELAYS
     9 bytes in segment XDATA_I
     9 bytes in segment XDATA_ID
    12 bytes in segment XDATA_ROM_C
    56 bytes in segment XDATA_Z
 
 5 916 bytes of CODE  memory
     0 bytes of CONST memory (+ 12 bytes shared)
    65 bytes of XDATA memory

Errors: none
Warnings: none
